<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Seb&#39;s blog</title>
<link>https://sbloggel.netlify.app/index.html</link>
<atom:link href="https://sbloggel.netlify.app/index.xml" rel="self" type="application/rss+xml"/>
<description>Seb&#39;s private blog about statistics and other topics</description>
<generator>quarto-1.3.433</generator>
<lastBuildDate>Sun, 27 Aug 2023 22:00:00 GMT</lastBuildDate>
<item>
  <title>Tensorflow Decision Forests</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-28-tensorflow-decision-forests-/2023-08-28-tensorflow-decision-forests-.html</link>
  <description><![CDATA[ 



<ul>
<li>Source</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensorflow_decision_forests <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tfdf</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensorflow <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tf</span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb2-8"></span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Found TensorFlow Decision Forests v"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> tfdf.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found TensorFlow Decision Forests v1.5.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the dataset</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !wget -q https://storage.googleapis.com/download.tensorflow.org/data/palmer_penguins/penguins.csv -O /tmp/penguins.csv</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load a dataset into a Pandas Dataframe.</span></span>
<span id="cb4-5">dataset_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/tmp/penguins.csv"</span>)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the first 3 examples.</span></span>
<span id="cb4-8">dataset_df.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  species     island  bill_length_mm  ...  body_mass_g     sex  year
0  Adelie  Torgersen            39.1  ...       3750.0    male  2007
1  Adelie  Torgersen            39.5  ...       3800.0  female  2007
2  Adelie  Torgersen            40.3  ...       3250.0  female  2007

[3 rows x 8 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encode the categorical labels as integers.</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Details:</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This stage is necessary if your classification label is represented as a</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># string since Keras expects integer classification labels.</span></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># When using `pd_dataframe_to_tf_dataset` (see below), this step can be skipped.</span></span>
<span id="cb6-7"></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name of the label column.</span></span>
<span id="cb6-9">label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span></span>
<span id="cb6-10"></span>
<span id="cb6-11">classes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset_df[label].unique().tolist()</span>
<span id="cb6-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Label classes: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>classes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Label classes: ['Adelie', 'Gentoo', 'Chinstrap']</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">dataset_df[label] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset_df[label].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(classes.index)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the dataset into a training and a testing dataset.</span></span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> split_dataset(dataset, test_ratio<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.30</span>):</span>
<span id="cb8-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Splits a panda dataframe in two."""</span></span>
<span id="cb8-7">  test_indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.rand(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataset)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> test_ratio</span>
<span id="cb8-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> dataset[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>test_indices], dataset[test_indices]</span>
<span id="cb8-9"></span>
<span id="cb8-10"></span>
<span id="cb8-11">train_ds_pd, test_ds_pd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> split_dataset(dataset_df)</span>
<span id="cb8-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> examples in training, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> examples for testing."</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(</span>
<span id="cb8-13">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(train_ds_pd), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(test_ds_pd)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>239 examples in training, 105 examples for testing.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">train_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.pd_dataframe_to_tf_dataset(train_ds_pd, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label)</span>
<span id="cb10-2">test_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.pd_dataframe_to_tf_dataset(test_ds_pd, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label)</span>
<span id="cb10-3"></span>
<span id="cb10-4"></span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># %set_cell_height 300</span></span>
<span id="cb10-6"></span>
<span id="cb10-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Specify the model.</span></span>
<span id="cb10-8">model_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.RandomForestModel(verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Use 10 thread(s) for training
Use /var/folders/jl/yt17k74x37l_mv93mfg5h7n00000gn/T/tmpwjc2yd91 as temporary training directory</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train the model.</span></span>
<span id="cb12-2">model_1.fit(train_ds)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading training dataset...
Training tensor examples:
Features: {'island': &lt;tf.Tensor 'data:0' shape=(None,) dtype=string&gt;, 'bill_length_mm': &lt;tf.Tensor 'data_1:0' shape=(None,) dtype=float64&gt;, 'bill_depth_mm': &lt;tf.Tensor 'data_2:0' shape=(None,) dtype=float64&gt;, 'flipper_length_mm': &lt;tf.Tensor 'data_3:0' shape=(None,) dtype=float64&gt;, 'body_mass_g': &lt;tf.Tensor 'data_4:0' shape=(None,) dtype=float64&gt;, 'sex': &lt;tf.Tensor 'data_5:0' shape=(None,) dtype=string&gt;, 'year': &lt;tf.Tensor 'data_6:0' shape=(None,) dtype=int64&gt;}
Label: Tensor("data_7:0", shape=(None,), dtype=int64)
Weights: None
Normalized tensor features:
 {'island': SemanticTensor(semantic=&lt;Semantic.CATEGORICAL: 2&gt;, tensor=&lt;tf.Tensor 'data:0' shape=(None,) dtype=string&gt;), 'bill_length_mm': SemanticTensor(semantic=&lt;Semantic.NUMERICAL: 1&gt;, tensor=&lt;tf.Tensor 'Cast:0' shape=(None,) dtype=float32&gt;), 'bill_depth_mm': SemanticTensor(semantic=&lt;Semantic.NUMERICAL: 1&gt;, tensor=&lt;tf.Tensor 'Cast_1:0' shape=(None,) dtype=float32&gt;), 'flipper_length_mm': SemanticTensor(semantic=&lt;Semantic.NUMERICAL: 1&gt;, tensor=&lt;tf.Tensor 'Cast_2:0' shape=(None,) dtype=float32&gt;), 'body_mass_g': SemanticTensor(semantic=&lt;Semantic.NUMERICAL: 1&gt;, tensor=&lt;tf.Tensor 'Cast_3:0' shape=(None,) dtype=float32&gt;), 'sex': SemanticTensor(semantic=&lt;Semantic.CATEGORICAL: 2&gt;, tensor=&lt;tf.Tensor 'data_5:0' shape=(None,) dtype=string&gt;), 'year': SemanticTensor(semantic=&lt;Semantic.NUMERICAL: 1&gt;, tensor=&lt;tf.Tensor 'Cast_4:0' shape=(None,) dtype=float32&gt;)}
Training dataset read in 0:00:01.480043. Found 239 examples.
Training model...
Standard output detected as not visible to the user e.g. running in a notebook. Creating a training log redirection. If training gets stuck, try calling tfdf.keras.set_training_logs_redirection(False).
Model trained in 0:00:00.026059
Compiling model...
Model compiled.
&lt;keras.src.callbacks.History object at 0x134f12890&gt;

[INFO 23-08-28 10:50:46.5211 CEST kernel.cc:773] Start Yggdrasil model training
[INFO 23-08-28 10:50:46.5216 CEST kernel.cc:774] Collect training examples
[INFO 23-08-28 10:50:46.5216 CEST kernel.cc:787] Dataspec guide:
column_guides {
  column_name_pattern: "^__LABEL$"
  type: CATEGORICAL
  categorial {
    min_vocab_frequency: 0
    max_vocab_count: -1
  }
}
default_column_guide {
  categorial {
    max_vocab_count: 2000
  }
  discretized_numerical {
    maximum_num_bins: 255
  }
}
ignore_columns_without_guides: false
detect_numerical_as_discretized_numerical: false

[INFO 23-08-28 10:50:46.5218 CEST kernel.cc:393] Number of batches: 1
[INFO 23-08-28 10:50:46.5218 CEST kernel.cc:394] Number of examples: 239
[INFO 23-08-28 10:50:46.5219 CEST kernel.cc:794] Training dataset:
Number of records: 239
Number of columns: 8

Number of columns by type:
    NUMERICAL: 5 (62.5%)
    CATEGORICAL: 3 (37.5%)

Columns:

NUMERICAL: 5 (62.5%)
    1: "bill_depth_mm" NUMERICAL num-nas:1 (0.41841%) mean:17.1164 min:13.3 max:21.5 sd:2.02827
    2: "bill_length_mm" NUMERICAL num-nas:1 (0.41841%) mean:44.095 min:32.1 max:55.1 sd:5.26063
    3: "body_mass_g" NUMERICAL num-nas:1 (0.41841%) mean:4248.11 min:2700 max:6300 sd:808.78
    4: "flipper_length_mm" NUMERICAL num-nas:1 (0.41841%) mean:201.697 min:178 max:230 sd:14.1846
    7: "year" NUMERICAL mean:2008 min:2007 max:2009 sd:0.805306

CATEGORICAL: 3 (37.5%)
    0: "__LABEL" CATEGORICAL integerized vocab-size:4 no-ood-item
    5: "island" CATEGORICAL has-dict vocab-size:4 zero-ood-items most-frequent:"Biscoe" 118 (49.3724%)
    6: "sex" CATEGORICAL num-nas:7 (2.92887%) has-dict vocab-size:3 zero-ood-items most-frequent:"male" 121 (52.1552%)

Terminology:
    nas: Number of non-available (i.e. missing) values.
    ood: Out of dictionary.
    manually-defined: Attribute which type is manually defined by the user i.e. the type was not automatically inferred.
    tokenized: The attribute value is obtained through tokenization.
    has-dict: The attribute is attached to a string dictionary e.g. a categorical attribute stored as a string.
    vocab-size: Number of unique values.

[INFO 23-08-28 10:50:46.5219 CEST kernel.cc:810] Configure learner
[INFO 23-08-28 10:50:46.5220 CEST kernel.cc:824] Training config:
learner: "RANDOM_FOREST"
features: "^bill_depth_mm$"
features: "^bill_length_mm$"
features: "^body_mass_g$"
features: "^flipper_length_mm$"
features: "^island$"
features: "^sex$"
features: "^year$"
label: "^__LABEL$"
task: CLASSIFICATION
random_seed: 123456
metadata {
  framework: "TF Keras"
}
pure_serving_model: false
[yggdrasil_decision_forests.model.random_forest.proto.random_forest_config] {
  num_trees: 300
  decision_tree {
    max_depth: 16
    min_examples: 5
    in_split_min_examples_check: true
    keep_non_leaf_label_distribution: true
    num_candidate_attributes: 0
    missing_value_policy: GLOBAL_IMPUTATION
    allow_na_conditions: false
    categorical_set_greedy_forward {
      sampling: 0.1
      max_num_items: -1
      min_item_frequency: 1
    }
    growing_strategy_local {
    }
    categorical {
      cart {
      }
    }
    axis_aligned_split {
    }
    internal {
      sorting_strategy: PRESORTED
    }
    uplift {
      min_examples_in_treatment: 5
      split_score: KULLBACK_LEIBLER
    }
  }
  winner_take_all_inference: true
  compute_oob_performances: true
  compute_oob_variable_importances: false
  num_oob_variable_importances_permutations: 1
  bootstrap_training_dataset: true
  bootstrap_size_ratio: 1
  adapt_bootstrap_size_ratio_for_maximum_training_duration: false
  sampling_with_replacement: true
}

[INFO 23-08-28 10:50:46.5222 CEST kernel.cc:827] Deployment config:
cache_path: "/var/folders/jl/yt17k74x37l_mv93mfg5h7n00000gn/T/tmpwjc2yd91/working_cache"
num_threads: 10
try_resume_training: true

[INFO 23-08-28 10:50:46.5223 CEST kernel.cc:889] Train model
[INFO 23-08-28 10:50:46.5223 CEST random_forest.cc:416] Training random forest on 239 example(s) and 7 feature(s).
[INFO 23-08-28 10:50:46.5229 CEST random_forest.cc:802] Training of tree  1/300 (tree index:2) done accuracy:0.918605 logloss:2.93379
[INFO 23-08-28 10:50:46.5231 CEST random_forest.cc:802] Training of tree  14/300 (tree index:14) done accuracy:0.93133 logloss:1.15914
[INFO 23-08-28 10:50:46.5233 CEST random_forest.cc:802] Training of tree  25/300 (tree index:24) done accuracy:0.962343 logloss:0.24584
[INFO 23-08-28 10:50:46.5235 CEST random_forest.cc:802] Training of tree  39/300 (tree index:38) done accuracy:0.962343 logloss:0.238283
[INFO 23-08-28 10:50:46.5238 CEST random_forest.cc:802] Training of tree  50/300 (tree index:49) done accuracy:0.962343 logloss:0.234376
[INFO 23-08-28 10:50:46.5240 CEST random_forest.cc:802] Training of tree  64/300 (tree index:60) done accuracy:0.966527 logloss:0.0941994
[INFO 23-08-28 10:50:46.5242 CEST random_forest.cc:802] Training of tree  75/300 (tree index:74) done accuracy:0.966527 logloss:0.0934996
[INFO 23-08-28 10:50:46.5244 CEST random_forest.cc:802] Training of tree  85/300 (tree index:84) done accuracy:0.970711 logloss:0.0903579
[INFO 23-08-28 10:50:46.5246 CEST random_forest.cc:802] Training of tree  95/300 (tree index:94) done accuracy:0.970711 logloss:0.0873026
[INFO 23-08-28 10:50:46.5247 CEST random_forest.cc:802] Training of tree  105/300 (tree index:104) done accuracy:0.970711 logloss:0.086929
[INFO 23-08-28 10:50:46.5249 CEST random_forest.cc:802] Training of tree  117/300 (tree index:116) done accuracy:0.970711 logloss:0.0848943
[INFO 23-08-28 10:50:46.5251 CEST random_forest.cc:802] Training of tree  129/300 (tree index:128) done accuracy:0.974895 logloss:0.0844767
[INFO 23-08-28 10:50:46.5252 CEST random_forest.cc:802] Training of tree  139/300 (tree index:138) done accuracy:0.974895 logloss:0.0813079
[INFO 23-08-28 10:50:46.5254 CEST random_forest.cc:802] Training of tree  150/300 (tree index:150) done accuracy:0.974895 logloss:0.0816927
[INFO 23-08-28 10:50:46.5256 CEST random_forest.cc:802] Training of tree  160/300 (tree index:159) done accuracy:0.974895 logloss:0.0821032
[INFO 23-08-28 10:50:46.5258 CEST random_forest.cc:802] Training of tree  170/300 (tree index:169) done accuracy:0.974895 logloss:0.0811745
[INFO 23-08-28 10:50:46.5259 CEST random_forest.cc:802] Training of tree  181/300 (tree index:181) done accuracy:0.974895 logloss:0.0817699
[INFO 23-08-28 10:50:46.5261 CEST random_forest.cc:802] Training of tree  194/300 (tree index:193) done accuracy:0.974895 logloss:0.0828385
[INFO 23-08-28 10:50:46.5263 CEST random_forest.cc:802] Training of tree  205/300 (tree index:203) done accuracy:0.974895 logloss:0.082928
[INFO 23-08-28 10:50:46.5264 CEST random_forest.cc:802] Training of tree  215/300 (tree index:215) done accuracy:0.970711 logloss:0.0828813
[INFO 23-08-28 10:50:46.5266 CEST random_forest.cc:802] Training of tree  227/300 (tree index:223) done accuracy:0.974895 logloss:0.0829924
[INFO 23-08-28 10:50:46.5268 CEST random_forest.cc:802] Training of tree  239/300 (tree index:238) done accuracy:0.979079 logloss:0.0826984
[INFO 23-08-28 10:50:46.5270 CEST random_forest.cc:802] Training of tree  249/300 (tree index:249) done accuracy:0.974895 logloss:0.082548
[INFO 23-08-28 10:50:46.5271 CEST random_forest.cc:802] Training of tree  259/300 (tree index:259) done accuracy:0.974895 logloss:0.0823658
[INFO 23-08-28 10:50:46.5273 CEST random_forest.cc:802] Training of tree  269/300 (tree index:269) done accuracy:0.979079 logloss:0.0828393
[INFO 23-08-28 10:50:46.5275 CEST random_forest.cc:802] Training of tree  279/300 (tree index:279) done accuracy:0.983264 logloss:0.0830823
[INFO 23-08-28 10:50:46.5276 CEST random_forest.cc:802] Training of tree  289/300 (tree index:288) done accuracy:0.970711 logloss:0.0832093
[INFO 23-08-28 10:50:46.5278 CEST random_forest.cc:802] Training of tree  299/300 (tree index:298) done accuracy:0.970711 logloss:0.083786
[INFO 23-08-28 10:50:46.5278 CEST random_forest.cc:802] Training of tree  300/300 (tree index:299) done accuracy:0.970711 logloss:0.0836702
[INFO 23-08-28 10:50:46.5279 CEST random_forest.cc:882] Final OOB metrics: accuracy:0.970711 logloss:0.0836702
[INFO 23-08-28 10:50:46.5282 CEST kernel.cc:926] Export model in log directory: /var/folders/jl/yt17k74x37l_mv93mfg5h7n00000gn/T/tmpwjc2yd91 with prefix a02b057747ad4a71
[INFO 23-08-28 10:50:46.5306 CEST kernel.cc:944] Save model in resources
[INFO 23-08-28 10:50:46.5314 CEST abstract_model.cc:849] Model self evaluation:
Number of predictions (without weights): 239
Number of predictions (with weights): 239
Task: CLASSIFICATION
Label: __LABEL

Accuracy: 0.970711  CI95[W][0.945693 0.986175]
LogLoss: : 0.0836702
ErrorRate: : 0.0292887

Default Accuracy: : 0.41841
Default LogLoss: : 1.05187
Default ErrorRate: : 0.58159

Confusion Table:
truth\prediction
   0   1   2   3
0  0   0   0   0
1  0  97   1   2
2  0   1  91   0
3  0   2   1  44
Total: 239

One vs other classes:

[INFO 23-08-28 10:50:46.5370 CEST kernel.cc:1243] Loading model from path /var/folders/jl/yt17k74x37l_mv93mfg5h7n00000gn/T/tmpwjc2yd91/model/ with prefix a02b057747ad4a71
[INFO 23-08-28 10:50:46.5431 CEST decision_forest.cc:660] Model loaded with 300 root(s), 4420 node(s), and 7 input feature(s).
[INFO 23-08-28 10:50:46.5431 CEST abstract_model.cc:1312] Engine "RandomForestGeneric" built
[INFO 23-08-28 10:50:46.5431 CEST kernel.cc:1075] Use fast generic engine
WARNING:tensorflow:AutoGraph could not transform &lt;function simple_ml_inference_op_with_handle at 0x1635fc0e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform &lt;function simple_ml_inference_op_with_handle at 0x1635fc0e0&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: could not get source code
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">model_1.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>])</span>
<span id="cb14-2">evaluation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_1.evaluate(test_ds, return_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1/1 [==============================] - ETA: 0s - loss: 0.0000e+00 - accuracy: 0.9810
1/1 [==============================] - 0s 120ms/step - loss: 0.0000e+00 - accuracy: 0.9810</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>()</span></code></pre></div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> name, value <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> evaluation.items():</span>
<span id="cb17-2">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>value<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>loss: 0.0000
accuracy: 0.9810</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">tfdf.model_plotter.plot_model_in_colab(model_1, tree_idx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, max_depth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">

<script src="https://d3js.org/d3.v6.min.js"></script>
<div id="tree_plot_89454907ef5f4918976bf7a74248ed24"></div>
<script>
/*
 * Copyright 2021 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 *  Plotting of decision trees generated by TF-DF.
 *
 *  A tree is a recursive structure of node objects.
 *  A node contains one or more of the following components:
 *
 *    - A value: Representing the output of the node. If the node is not a leaf,
 *      the value is only present for analysis i.e. it is not used for
 *      predictions.
 *
 *    - A condition : For non-leaf nodes, the condition (also known as split)
 *      defines a binary test to branch to the positive or negative child.
 *
 *    - An explanation: Generally a plot showing the relation between the label
 *      and the condition to give insights about the effect of the condition.
 *
 *    - Two children : For non-leaf nodes, the children nodes. The first
 *      children (i.e. "node.children[0]") is the negative children (drawn in
 *      red). The second children is the positive one (drawn in green).
 *
 */

/**
 * Plots a single decision tree into a DOM element.
 * @param {!options} options Dictionary of configurations.
 * @param {!tree} raw_tree Recursive tree structure.
 * @param {string} canvas_id Id of the output dom element.
 */
function display_tree(options, raw_tree, canvas_id) {
  console.log(options);

  // Determine the node placement.
  const tree_struct = d3.tree().nodeSize(
      [options.node_y_offset, options.node_x_offset])(d3.hierarchy(raw_tree));

  // Boundaries of the node placement.
  let x_min = Infinity;
  let x_max = -x_min;
  let y_min = Infinity;
  let y_max = -x_min;

  tree_struct.each(d => {
    if (d.x > x_max) x_max = d.x;
    if (d.x < x_min) x_min = d.x;
    if (d.y > y_max) y_max = d.y;
    if (d.y < y_min) y_min = d.y;
  });

  // Size of the plot.
  const width = y_max - y_min + options.node_x_size + options.margin * 2;
  const height = x_max - x_min + options.node_y_size + options.margin * 2 +
      options.node_y_offset - options.node_y_size;

  const plot = d3.select(canvas_id);

  // Tool tip
  options.tooltip = plot.append('div')
                        .attr('width', 100)
                        .attr('height', 100)
                        .style('padding', '4px')
                        .style('background', '#fff')
                        .style('box-shadow', '4px 4px 0px rgba(0,0,0,0.1)')
                        .style('border', '1px solid black')
                        .style('font-family', 'sans-serif')
                        .style('font-size', options.font_size)
                        .style('position', 'absolute')
                        .style('z-index', '10')
                        .attr('pointer-events', 'none')
                        .style('display', 'none');

  // Create canvas
  const svg = plot.append('svg').attr('width', width).attr('height', height);
  const graph =
      svg.style('overflow', 'visible')
          .append('g')
          .attr('font-family', 'sans-serif')
          .attr('font-size', options.font_size)
          .attr(
              'transform',
              () => `translate(${options.margin},${
                  - x_min + options.node_y_offset / 2 + options.margin})`);

  // Plot bounding box.
  if (options.show_plot_bounding_box) {
    svg.append('rect')
        .attr('width', width)
        .attr('height', height)
        .attr('fill', 'none')
        .attr('stroke-width', 1.0)
        .attr('stroke', 'black');
  }

  // Draw the edges.
  display_edges(options, graph, tree_struct);

  // Draw the nodes.
  display_nodes(options, graph, tree_struct);
}

/**
 * Draw the nodes of the tree.
 * @param {!options} options Dictionary of configurations.
 * @param {!graph} graph D3 search handle containing the graph.
 * @param {!tree_struct} tree_struct Structure of the tree (node placement,
 *     data, etc.).
 */
function display_nodes(options, graph, tree_struct) {
  const nodes = graph.append('g')
                    .selectAll('g')
                    .data(tree_struct.descendants())
                    .join('g')
                    .attr('transform', d => `translate(${d.y},${d.x})`);

  nodes.append('rect')
      .attr('x', 0.5)
      .attr('y', 0.5)
      .attr('width', options.node_x_size)
      .attr('height', options.node_y_size)
      .attr('stroke', 'lightgrey')
      .attr('stroke-width', 1)
      .attr('fill', 'white')
      .attr('y', -options.node_y_size / 2);

  // Brackets on the right of condition nodes without children.
  non_leaf_node_without_children =
      nodes.filter(node => node.data.condition != null && node.children == null)
          .append('g')
          .attr('transform', `translate(${options.node_x_size},0)`);

  non_leaf_node_without_children.append('path')
      .attr('d', 'M0,0 C 10,0 0,10 10,10')
      .attr('fill', 'none')
      .attr('stroke-width', 1.0)
      .attr('stroke', '#F00');

  non_leaf_node_without_children.append('path')
      .attr('d', 'M0,0 C 10,0 0,-10 10,-10')
      .attr('fill', 'none')
      .attr('stroke-width', 1.0)
      .attr('stroke', '#0F0');

  const node_content = nodes.append('g').attr(
      'transform',
      `translate(0,${options.node_padding - options.node_y_size / 2})`);

  node_content.append(node => create_node_element(options, node));
}

/**
 * Creates the D3 content for a single node.
 * @param {!options} options Dictionary of configurations.
 * @param {!node} node Node to draw.
 * @return {!d3} D3 content.
 */
function create_node_element(options, node) {
  // Output accumulator.
  let output = {
    // Content to draw.
    content: d3.create('svg:g'),
    // Vertical offset to the next element to draw.
    vertical_offset: 0
  };

  // Conditions.
  if (node.data.condition != null) {
    display_condition(options, node.data.condition, output);
  }

  // Values.
  if (node.data.value != null) {
    display_value(options, node.data.value, output);
  }

  // Explanations.
  if (node.data.explanation != null) {
    display_explanation(options, node.data.explanation, output);
  }

  return output.content.node();
}


/**
 * Adds a single line of text inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {string} text Text to display.
 * @param {!output} output Output display accumulator.
 */
function display_node_text(options, text, output) {
  output.content.append('text')
      .attr('x', options.node_padding)
      .attr('y', output.vertical_offset)
      .attr('alignment-baseline', 'hanging')
      .text(text);
  output.vertical_offset += 10;
}

/**
 * Adds a single line of text inside of a node with a tooltip.
 * @param {!options} options Dictionary of configurations.
 * @param {string} text Text to display.
 * @param {string} tooltip Text in the Tooltip.
 * @param {!output} output Output display accumulator.
 */
function display_node_text_with_tooltip(options, text, tooltip, output) {
  const item = output.content.append('text')
                   .attr('x', options.node_padding)
                   .attr('alignment-baseline', 'hanging')
                   .text(text);

  add_tooltip(options, item, () => tooltip);
  output.vertical_offset += 10;
}

/**
 * Adds a tooltip to a dom element.
 * @param {!options} options Dictionary of configurations.
 * @param {!dom} target Dom element to equip with a tooltip.
 * @param {!func} get_content Generates the html content of the tooltip.
 */
function add_tooltip(options, target, get_content) {
  function show(d) {
    options.tooltip.style('display', 'block');
    options.tooltip.html(get_content());
  }

  function hide(d) {
    options.tooltip.style('display', 'none');
  }

  function move(d) {
    options.tooltip.style('display', 'block');
    options.tooltip.style('left', (d.pageX + 5) + 'px');
    options.tooltip.style('top', d.pageY + 'px');
  }

  target.on('mouseover', show);
  target.on('mouseout', hide);
  target.on('mousemove', move);
}

/**
 * Adds a condition inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {!condition} condition Condition to display.
 * @param {!output} output Output display accumulator.
 */
function display_condition(options, condition, output) {
  threshold_format = d3.format('r');

  if (condition.type === 'IS_MISSING') {
    display_node_text(options, `${condition.attribute} is missing`, output);
    return;
  }

  if (condition.type === 'IS_TRUE') {
    display_node_text(options, `${condition.attribute} is true`, output);
    return;
  }

  if (condition.type === 'NUMERICAL_IS_HIGHER_THAN') {
    format = d3.format('r');
    display_node_text(
        options,
        `${condition.attribute} >= ${threshold_format(condition.threshold)}`,
        output);
    return;
  }

  if (condition.type === 'CATEGORICAL_IS_IN') {
    display_node_text_with_tooltip(
        options, `${condition.attribute} in [...]`,
        `${condition.attribute} in [${condition.mask}]`, output);
    return;
  }

  if (condition.type === 'CATEGORICAL_SET_CONTAINS') {
    display_node_text_with_tooltip(
        options, `${condition.attribute} intersect [...]`,
        `${condition.attribute} intersect [${condition.mask}]`, output);
    return;
  }

  if (condition.type === 'NUMERICAL_SPARSE_OBLIQUE') {
    display_node_text_with_tooltip(
        options, `Sparse oblique split...`,
        `[${condition.attributes}]*[${condition.weights}]>=${
            threshold_format(condition.threshold)}`,
        output);
    return;
  }

  display_node_text(
      options, `Non supported condition ${condition.type}`, output);
}

/**
 * Adds a value inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {!value} value Value to display.
 * @param {!output} output Output display accumulator.
 */
function display_value(options, value, output) {
  if (value.type === 'PROBABILITY') {
    const left_margin = 0;
    const right_margin = 50;
    const plot_width = options.node_x_size - options.node_padding * 2 -
        left_margin - right_margin;

    let cusum = Array.from(d3.cumsum(value.distribution));
    cusum.unshift(0);
    const distribution_plot = output.content.append('g').attr(
        'transform', `translate(0,${output.vertical_offset + 0.5})`);

    distribution_plot.selectAll('rect')
        .data(value.distribution)
        .join('rect')
        .attr('height', 10)
        .attr(
            'x',
            (d, i) =>
                (cusum[i] * plot_width + left_margin + options.node_padding))
        .attr('width', (d, i) => d * plot_width)
        .style('fill', (d, i) => d3.schemeSet1[i]);

    const num_examples =
        output.content.append('g')
            .attr('transform', `translate(0,${output.vertical_offset})`)
            .append('text')
            .attr('x', options.node_x_size - options.node_padding)
            .attr('alignment-baseline', 'hanging')
            .attr('text-anchor', 'end')
            .text(`(${value.num_examples})`);

    const distribution_details = d3.create('ul');
    distribution_details.selectAll('li')
        .data(value.distribution)
        .join('li')
        .append('span')
        .text(
            (d, i) =>
                'class ' + i + ': ' + d3.format('.3%')(value.distribution[i]));

    add_tooltip(options, distribution_plot, () => distribution_details.html());
    add_tooltip(options, num_examples, () => 'Number of examples');

    output.vertical_offset += 10;
    return;
  }

  if (value.type === 'REGRESSION') {
    display_node_text(
        options,
        'value: ' + d3.format('r')(value.value) + ` (` +
            d3.format('.6')(value.num_examples) + `)`,
        output);
    return;
  }

  if (value.type === 'UPLIFT') {
    display_node_text(
        options,
        'effect: ' + d3.format('r')(value.treatment_effect) + ` (` +
            d3.format('.6')(value.num_examples) + `)`,
        output);
    return;
  }

  display_node_text(options, `Non supported value ${value.type}`, output);
}

/**
 * Adds an explanation inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {!explanation} explanation Explanation to display.
 * @param {!output} output Output display accumulator.
 */
function display_explanation(options, explanation, output) {
  // Margin before the explanation.
  output.vertical_offset += 10;

  display_node_text(
      options, `Non supported explanation ${explanation.type}`, output);
}


/**
 * Draw the edges of the tree.
 * @param {!options} options Dictionary of configurations.
 * @param {!graph} graph D3 search handle containing the graph.
 * @param {!tree_struct} tree_struct Structure of the tree (node placement,
 *     data, etc.).
 */
function display_edges(options, graph, tree_struct) {
  // Draw an edge between a parent and a child node with a bezier.
  function draw_single_edge(d) {
    return 'M' + (d.source.y + options.node_x_size) + ',' + d.source.x + ' C' +
        (d.source.y + options.node_x_size + options.edge_rounding) + ',' +
        d.source.x + ' ' + (d.target.y - options.edge_rounding) + ',' +
        d.target.x + ' ' + d.target.y + ',' + d.target.x;
  }

  graph.append('g')
      .attr('fill', 'none')
      .attr('stroke-width', 1.2)
      .selectAll('path')
      .data(tree_struct.links())
      .join('path')
      .attr('d', draw_single_edge)
      .attr(
          'stroke', d => (d.target === d.source.children[0]) ? '#0F0' : '#F00');
}

display_tree({"margin": 10, "node_x_size": 160, "node_y_size": 28, "node_x_offset": 180, "node_y_offset": 33, "font_size": 10, "edge_rounding": 20, "node_padding": 2, "show_plot_bounding_box": false}, {"value": {"type": "PROBABILITY", "distribution": [0.3389121338912134, 0.4393305439330544, 0.2217573221757322], "num_examples": 239.0}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "island", "mask": ["Dream", "Torgersen"]}, "children": [{"value": {"type": "PROBABILITY", "distribution": [0.5309734513274337, 0.0, 0.4690265486725664], "num_examples": 113.0}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "bill_length_mm", "threshold": 44.20000076293945}, "children": [{"value": {"type": "PROBABILITY", "distribution": [0.04, 0.0, 0.96], "num_examples": 50.0}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "bill_length_mm", "threshold": 46.04999923706055}, "children": [{"value": {"type": "PROBABILITY", "distribution": [0.0, 0.0, 1.0], "num_examples": 40.0}}, {"value": {"type": "PROBABILITY", "distribution": [0.2, 0.0, 0.8], "num_examples": 10.0}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "body_mass_g", "threshold": 3737.5}}]}, {"value": {"type": "PROBABILITY", "distribution": [0.9206349206349206, 0.0, 0.07936507936507936], "num_examples": 63.0}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "bill_length_mm", "threshold": 40.849998474121094}, "children": [{"value": {"type": "PROBABILITY", "distribution": [0.7916666666666666, 0.0, 0.20833333333333334], "num_examples": 24.0}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "sex", "mask": ["female"]}}, {"value": {"type": "PROBABILITY", "distribution": [1.0, 0.0, 0.0], "num_examples": 39.0}}]}]}, {"value": {"type": "PROBABILITY", "distribution": [0.16666666666666666, 0.8333333333333334, 0.0], "num_examples": 126.0}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "bill_length_mm", "threshold": 42.75}, "children": [{"value": {"type": "PROBABILITY", "distribution": [0.009523809523809525, 0.9904761904761905, 0.0], "num_examples": 105.0}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "flipper_length_mm", "threshold": 208.5}, "children": [{"value": {"type": "PROBABILITY", "distribution": [0.0, 1.0, 0.0], "num_examples": 98.0}}, {"value": {"type": "PROBABILITY", "distribution": [0.14285714285714285, 0.8571428571428571, 0.0], "num_examples": 7.0}}]}, {"value": {"type": "PROBABILITY", "distribution": [0.9523809523809523, 0.047619047619047616, 0.0], "num_examples": 21.0}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "body_mass_g", "threshold": 3862.5}, "children": [{"value": {"type": "PROBABILITY", "distribution": [0.8, 0.2, 0.0], "num_examples": 5.0}}, {"value": {"type": "PROBABILITY", "distribution": [1.0, 0.0, 0.0], "num_examples": 16.0}}]}]}]}, "#tree_plot_89454907ef5f4918976bf7a74248ed24")
</script>

</div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-28-tensorflow-decision-forests-/2023-08-28-tensorflow-decision-forests-.html</guid>
  <pubDate>Sun, 27 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Two-ANOVA with interaction vs. individual t-tests</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests.html</link>
  <description><![CDATA[ 



<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/init_d305052b16d91e5147626f46c9968e2c">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multcomp'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
</div>
<section id="simulation-model" class="level2">
<h2 class="anchored" data-anchor-id="simulation-model">Simulation model</h2>
<ul>
<li>Normally distributed data</li>
<li>Two-way ANOVA design
<ul>
<li>Factor <code>F1</code> with levels <code>A</code> and <code>B</code></li>
<li>Factor <code>F2</code> with levels <code>A</code> and <code>B</code></li>
</ul></li>
<li>Means:
<ul>
<li><code>F1</code> = <code>A</code>, <code>F2</code> = <code>A</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200"></li>
<li><code>F1</code> = <code>A</code>, <code>F2</code> = <code>B</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%201"></li>
<li><code>F1</code> = <code>B</code>, <code>F2</code> = <code>A</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%201"></li>
<li><code>F1</code> = <code>B</code>, <code>F2</code> = <code>B</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%203"></li>
</ul></li>
<li>Standard deviation of error:
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%201"></li>
</ul></li>
<li>In treatment coding, this corresponds to the coefficient vector <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20=%20(0,%201,%201,%201)%5ET"></li>
</ul>
</section>
<section id="example-of-simulated-data" class="level2">
<h2 class="anchored" data-anchor-id="example-of-simulated-data">Example of simulated data</h2>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-2_02ccd9e5f9118cb5ee2cc14fe6ab9d00">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">generate_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb2-2">  dd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">F1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">F2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>))</span>
<span id="cb2-3">  X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dd)</span>
<span id="cb2-4">  dd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> (X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> beta)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dd)))</span>
<span id="cb2-5">}</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(F1, F2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="simulate-many-datasets-in-order-to-estimate-power-to-test-the-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="simulate-many-datasets-in-order-to-estimate-power-to-test-the-hypotheses">Simulate many datasets in order to estimate power to test the hypotheses</h2>
<ul>
<li>For ANOVA analysis the multcomp package is used in order to simulatneously test the hypotheses (correction for multiple testing with respect to the three hypotheses is included by design)</li>
<li>Calculate p-values testing the main effects (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_1%20=%200"> and <img src="https://latex.codecogs.com/png.latex?%5Cbeta_2%20=%200">) and the interaction (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_3%20=%200">) for each of the simulations</li>
<li>Estimate power empirically</li>
</ul>
<section id="power-of-anova-analysis" class="level3">
<h3 class="anchored" data-anchor-id="power-of-anova-analysis">Power of ANOVA analysis</h3>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-3_107f1c12bc10182c5455adc1ce3e960f">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">simulate_two_way_ANOVA <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>() {</span>
<span id="cb3-2">  fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>())</span>
<span id="cb3-3">  p_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glht</span>(fm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linfct =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fm))[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'= 0'</span>)))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pvalues</span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attributes</span>(p_values) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(p_values)</span>
<span id="cb3-6">}</span>
<span id="cb3-7"></span>
<span id="cb3-8">nr_of_sims <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span></span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Effect =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 2'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Interaction'</span>),</span>
<span id="cb3-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Power =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_sims, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_two_way_ANOVA</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> </span>
<span id="cb3-11">                         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> nr_of_sims) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Effect</th>
<th style="text-align: center;">Power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Main effect 1</td>
<td style="text-align: center;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: center;">Main effect 2</td>
<td style="text-align: center;">0.44</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Interaction</td>
<td style="text-align: center;">0.22</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="power-of-separate-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="power-of-separate-t-tests">Power of separate t-tests</h3>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-4_26de78c6510dca9c9d904f46439a33db">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sig.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 10
          delta = 1
             sd = 1
      sig.level = 0.025
          power = 0.4360626
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<ul>
<li>Power of multivariate test with three hypotheses is approximately equal to power of two separate t-tests with group size <img src="https://latex.codecogs.com/png.latex?n%20=%2010"></li>
<li>In ANOVA setting with additional group, the interaction can be tested (power is a little less)</li>
<li>Note that in the given scenario, 4 groups à 10 individuals are needed in the ANOVA case and 3 groups à 10 individuals are needed in the case of separate t-tests (provided that the control group is ‘recycled’)</li>
</ul>
<!-- ## Appendix -->
<!-- ### Use `power.anova.test` to replicate the results of `power.t.test` -->
<!-- ```{r} -->
<!-- power.t.test(delta = sqrt(2) * 2 , sd = 2, sig.level = 0.05, power = 0.8) -->
<!-- power.anova.test(groups = 2, between.var = 4, within.var = 4, sig.level = 0.05, power = 0.8) -->
<!-- power.t.test(delta = 2, sd = 1, sig.level = 0.05, power = 0.8) -->
<!-- power.anova.test(groups = 2, between.var = 8, within.var = 4, sig.level = 0.05, power = 0.8) -->
<!-- ``` -->


</section>
</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests.html</guid>
  <pubDate>Sun, 27 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Leave-one-out cross-validation in Python</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-11-leave-one-out-cross-validation-in-python/2023-08-11-leave-one-out-cross-validation-in-python.html</link>
  <description><![CDATA[ 



<section id="strategy" class="level2">
<h2 class="anchored" data-anchor-id="strategy">Strategy</h2>
<ul>
<li>Look at the <code>cars</code> dataset that is shipped in <code>base</code> R</li>
<li>Fit models
<ul>
<li>for each model, leave out one data point</li>
<li>predict the response value for that data point based on the model that is not based on that data point</li>
<li>calculate mean absolute error and mean squared error</li>
</ul></li>
</ul>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<section id="init" class="level3">
<h3 class="anchored" data-anchor-id="init">Init</h3>
<section id="chunk-in-r-to-setup-my-python-environment-can-be-omitted-for-users-with-python-ready-to-use" class="level4">
<h4 class="anchored" data-anchor-id="chunk-in-r-to-setup-my-python-environment-can-be-omitted-for-users-with-python-ready-to-use">Chunk in R to setup my Python environment (can be omitted for users with Python ready to use)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">required =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
</section>
<section id="chunk-to-load-python-libraries-and-set-up-the-data" class="level4">
<h4 class="anchored" data-anchor-id="chunk-to-load-python-libraries-and-set-up-the-data">Chunk to load Python libraries and set up the data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> statsmodels.formula.api <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> smf</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-4">cars <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(r[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cars'</span>])</span></code></pre></div>
</div>
</section>
</section>
<section id="show-that-fitting-in-r-and-python-yields-identical-results" class="level3">
<h3 class="anchored" data-anchor-id="show-that-fitting-in-r-and-python-yields-identical-results">Show that fitting in R and Python yields identical results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> smf.ols(formula <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed ~ dist'</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars).fit()</span>
<span id="cb3-2">fm.summary()</span></code></pre></div>
<div class="cell-output-display">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>speed</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.651</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>89.57</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Wed, 23 Aug 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>1.49e-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>12:04:41</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-127.39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>50</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>258.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>48</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>262.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>8.2839</td>
<td>0.874</td>
<td>9.474</td>
<td>0.000</td>
<td>6.526</td>
<td>10.042</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dist</td>
<td>0.1656</td>
<td>0.017</td>
<td>9.464</td>
<td>0.000</td>
<td>0.130</td>
<td>0.201</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>0.720</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.195</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.698</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>0.827</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>-0.207</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.661</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>2.526</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>98.0</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = speed ~ dist, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5293 -2.1550  0.3615  2.4377  6.4179 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.28391    0.87438   9.474 1.44e-12 ***
dist         0.16557    0.01749   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.156 on 48 degrees of freedom
Multiple R-squared:  0.6511,    Adjusted R-squared:  0.6438 
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
</div>
</section>
<section id="show-that-prediction-in-r-and-python-yields-identical-results" class="level3">
<h3 class="anchored" data-anchor-id="show-that-prediction-in-r-and-python-yields-identical-results">Show that prediction in R and Python yields identical results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">fm.predict(cars.iloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    8.615041
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm, cars[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
8.615041 </code></pre>
</div>
</div>
</section>
<section id="perform-leave-one-out-cross-validation-in-python" class="level3">
<h3 class="anchored" data-anchor-id="perform-leave-one-out-cross-validation-in-python">Perform leave-one-out-cross-validation in Python</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prepare column for predictions:</span></span>
<span id="cb10-2">cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prediction'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.nan</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fit models:</span></span>
<span id="cb10-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>):</span>
<span id="cb10-6">  train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars.drop(index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i)</span>
<span id="cb10-7">  test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars.iloc[i]</span>
<span id="cb10-8">  fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> smf.ols(formula<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed ~ dist'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>train).fit()</span>
<span id="cb10-9">  cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prediction'</span>].iloc[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fm.predict(test)</span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate prediction error:</span></span>
<span id="cb10-12">cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'error'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prediction'</span>]</span>
<span id="cb10-13"></span>
<span id="cb10-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mean absolute error:</span></span>
<span id="cb10-15">np.mean(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'error'</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.6335683917489323</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># root mean squared error:</span></span>
<span id="cb12-2">np.sqrt(np.mean(np.square(cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'error'</span>])))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.244276599631193</code></pre>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>Results are identical to those produced in R: <a href="https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r">Link</a></li>
<li>Also, the discrepancy with Friedemann’s results is now resolved</li>
</ul>


</section>

 ]]></description>
  <category>Python</category>
  <category>Linear model vs neural nets</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-11-leave-one-out-cross-validation-in-python/2023-08-11-leave-one-out-cross-validation-in-python.html</guid>
  <pubDate>Thu, 10 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Cars dataset and tidymodels</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-08-cars-dataset-and-tidymodels/2023-08-08-cars-dataset-and-tidymodels.html</link>
  <description><![CDATA[ 



<section id="init" class="level2">
<h2 class="anchored" data-anchor-id="init">Init</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidymodels'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ broom        1.0.4     ✔ recipes      1.0.6
✔ dials        1.2.0     ✔ rsample      1.1.1
✔ dplyr        1.1.2     ✔ tibble       3.2.1
✔ ggplot2      3.4.2     ✔ tidyr        1.3.0
✔ infer        1.0.4     ✔ tune         1.1.1
✔ modeldata    1.1.0     ✔ workflows    1.1.3
✔ parsnip      1.1.0     ✔ workflowsets 1.0.1
✔ purrr        1.0.1     ✔ yardstick    1.2.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ purrr::discard() masks scales::discard()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ recipes::step()  masks stats::step()
• Learn how to get started at https://www.tidymodels.org/start/</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span></code></pre></div>
</div>
</section>
<section id="do-vfold-cross-validation-on-the-cars-dataset-using-a-linear-model-a-random-forest-model-and-a-neural-net" class="level2">
<h2 class="anchored" data-anchor-id="do-vfold-cross-validation-on-the-cars-dataset-using-a-linear-model-a-random-forest-model-and-a-neural-net">Do vfold cross-validation on the cars dataset using a linear model, a random forest model and a neural net</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create data for resampling:</span></span>
<span id="cb6-2">cars_folds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vfold_cv</span>(cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repeats =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create model specifications:</span></span>
<span id="cb6-5">lm_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">linear_reg</span>()</span>
<span id="cb6-6">rf_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rand_forest</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'regression'</span>)</span>
<span id="cb6-7">nn_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mlp</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">epochs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hidden_units =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">penalty =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'regression'</span>)</span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create workflows:</span></span>
<span id="cb6-11">all_workflows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_set</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">preproc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"formula"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist),</span>
<span id="cb6-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">models =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lm =</span> lm_spec, </span>
<span id="cb6-15">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rf =</span> rf_spec,</span>
<span id="cb6-16">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nn =</span> nn_spec)</span>
<span id="cb6-17">  )</span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the workflows:</span></span>
<span id="cb6-20">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_workflows <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_map</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> cars_folds,</span>
<span id="cb6-22">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">control_resamples</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_pred =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb6-23"></span>
<span id="cb6-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display summary statistics for all model types:</span></span>
<span id="cb6-25">(metrics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(result))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  wflow_id   .config        preproc model .metric .estimator  mean     n std_err
  &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
1 formula_lm Preprocessor1… formula line… rmse    standard   3.18     10  0.288 
2 formula_lm Preprocessor1… formula line… rsq     standard   0.656    10  0.0885
3 formula_rf Preprocessor1… formula rand… rmse    standard   3.14     10  0.340 
4 formula_rf Preprocessor1… formula rand… rsq     standard   0.621    10  0.0901
5 formula_nn Preprocessor1… formula mlp   rmse    standard   2.99     10  0.253 
6 formula_nn Preprocessor1… formula mlp   rsq     standard   0.643    10  0.0834</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">metrics <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> .metric, </span>
<span id="cb8-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(mean, std_err), </span>
<span id="cb8-3">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> wflow_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">wflow_id</th>
<th style="text-align: center;">mean_rmse</th>
<th style="text-align: center;">mean_rsq</th>
<th style="text-align: center;">std_err_rmse</th>
<th style="text-align: center;">std_err_rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">formula_lm</td>
<td style="text-align: center;">3.180583</td>
<td style="text-align: center;">0.6561715</td>
<td style="text-align: center;">0.2883717</td>
<td style="text-align: center;">0.0885333</td>
</tr>
<tr class="even">
<td style="text-align: center;">formula_rf</td>
<td style="text-align: center;">3.142965</td>
<td style="text-align: center;">0.6212505</td>
<td style="text-align: center;">0.3399041</td>
<td style="text-align: center;">0.0901077</td>
</tr>
<tr class="odd">
<td style="text-align: center;">formula_nn</td>
<td style="text-align: center;">2.994578</td>
<td style="text-align: center;">0.6426283</td>
<td style="text-align: center;">0.2528375</td>
<td style="text-align: center;">0.0833891</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot predictions against actual values for all predictions:</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_predictions</span>(result) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> model) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(speed, .pred, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Real value of speed'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Prediction'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Model'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-08-cars-dataset-and-tidymodels/2023-08-08-cars-dataset-and-tidymodels_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="open-questions" class="level2">
<h2 class="anchored" data-anchor-id="open-questions">Open Questions</h2>
<ul>
<li>I don’t exactly understand how tidymodels performs cross-validation, how the metrics are calculated etc. Documentation of the tidymodels package has not been informative to me so far (probably I have to read more into it).</li>
<li>How to collect other metrics, e.g.&nbsp;mean absolute error?</li>
<li>How to conventiently join the predictors to the prediction tibble?</li>
<li>How do I extract honest coefficients from the linear model?</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>Linear model vs neural nets</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-08-cars-dataset-and-tidymodels/2023-08-08-cars-dataset-and-tidymodels.html</guid>
  <pubDate>Mon, 07 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Leave-one-out cross-validation in R</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r.html</link>
  <description><![CDATA[ 



<section id="strategy" class="level2">
<h2 class="anchored" data-anchor-id="strategy">Strategy</h2>
<ul>
<li>Fit “straight” models: linear model, neural net with 2 layers with 3 perceptrons each</li>
<li>Perform “Leave-one-out-cross-validation”</li>
<li>Calculate mean absolute prediction error and root mean squared error of the different methods
<ul>
<li>In cross-validation case for the left-out data point</li>
</ul></li>
</ul>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'neuralnet'</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_geom_defaults</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">leave_one_out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vectorize</span>(</span>
<span id="cb2-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(i, type) {</span>
<span id="cb2-3">    training <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cars[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>i, ]</span>
<span id="cb2-4">    test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cars[i, ]</span>
<span id="cb2-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm'</span>) {</span>
<span id="cb2-6">      fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> training)</span>
<span id="cb2-7">      pp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> test)</span>
<span id="cb2-8">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb2-9">      fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">neuralnet</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, </span>
<span id="cb2-10">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear.output =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> training, </span>
<span id="cb2-11">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hidden =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), </span>
<span id="cb2-12">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stepmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e+7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb2-13">      pp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> test)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-14">    }</span>
<span id="cb2-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(pp)</span>
<span id="cb2-16">  }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vectorize.args =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'i'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">fm_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars)</span>
<span id="cb3-2"></span>
<span id="cb3-3">fm_nn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">neuralnet</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, </span>
<span id="cb3-4">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear.output =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars, </span>
<span id="cb3-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hidden =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), </span>
<span id="cb3-6">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stepmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e+7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb3-7"></span>
<span id="cb3-8">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-9">  cars,</span>
<span id="cb3-10">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear model straight'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_lm),</span>
<span id="cb3-11">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural net straight'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_nn, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> cars)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb3-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear model with LOOC'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leave_one_out</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(cars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm'</span>),</span>
<span id="cb3-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural net with LOOC'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leave_one_out</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(cars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nn'</span>)</span>
<span id="cb3-14">)</span></code></pre></div>
</div>
<section id="predictions-for-straight-models-for-all-integers-from-0-to-125" class="level3">
<h3 class="anchored" data-anchor-id="predictions-for-straight-models-for-all-integers-from-0-to-125">Predictions for straight models for all integers from 0 to 125</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">pred_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">125</span>)</span>
<span id="cb4-2">pred_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pred_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear model'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_lm, pred_df),</span>
<span id="cb4-4">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural net'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_nn, pred_df)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-5"></span>
<span id="cb4-6">text_to_add <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Original data as black dots'</span>)</span>
<span id="cb4-7">pred_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>dist) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, speed), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Model type'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="predictions-for-all-dist-values-that-are-in-the-original-data-set-as-well" class="level3">
<h3 class="anchored" data-anchor-id="predictions-for-all-dist-values-that-are-in-the-original-data-set-as-well">Predictions for all dist values that are in the original data set as well</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>speed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>dist) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Model type'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, speed), cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">data_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(dist, speed)) </span>
<span id="cb6-3"></span>
<span id="cb6-4">data_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">error =</span> value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> speed,</span>
<span id="cb6-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">squared_error =</span> error<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'name'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Method) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Mean absolute error'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(error)),</span>
<span id="cb6-10">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Rout mean squared error'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(squared_error))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 34%">
<col style="width: 30%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Mean absolute error</th>
<th style="text-align: center;">Rout mean squared error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Linear model straight</td>
<td style="text-align: center;">2.52</td>
<td style="text-align: center;">3.09</td>
</tr>
<tr class="even">
<td style="text-align: center;">Linear model with LOOC</td>
<td style="text-align: center;">2.63</td>
<td style="text-align: center;">3.24</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Neural net straight</td>
<td style="text-align: center;">1.95</td>
<td style="text-align: center;">2.43</td>
</tr>
<tr class="even">
<td style="text-align: center;">Neural net with LOOC</td>
<td style="text-align: center;">2.89</td>
<td style="text-align: center;">3.46</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>The neural net seems to overfit!</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>Linear model vs neural nets</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r.html</guid>
  <pubDate>Mon, 07 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Regularization in R</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-05-regularization-in-r/2023-08-05-regularization-in-r.html</link>
  <description><![CDATA[ 



<ul>
<li>ridge regression</li>
<li>lasso regression</li>
<li>elastic net</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-05-regularization-in-r/2023-08-05-regularization-in-r.html</guid>
  <pubDate>Fri, 04 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Getting to know mlr3</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-mlr3/2023-08-04-getting-to-know-mlr3.html</link>
  <description><![CDATA[ 



<p><a href="https://cran.r-project.org/package=mlr3">Link to package</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mlr3'</span>)</span></code></pre></div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-mlr3/2023-08-04-getting-to-know-mlr3.html</guid>
  <pubDate>Thu, 03 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Getting to know tidymodels</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels.html</link>
  <description><![CDATA[ 



<ul>
<li>Tutorials by Julia Silge: <a href="https://www.youtube.com/@JuliaSilge/search">Link</a></li>
<li>Blog post criticising tidymodels: <a href="https://staffblogs.le.ac.uk/teachingr/2020/10/05/on-not-using-tidymodels/">Link</a>, written by <a href="https://github.com/thompson575">this person</a></li>
</ul>
<section id="which-packages-belong-to-the-metapackage-tidymodels" class="level2">
<h2 class="anchored" data-anchor-id="which-packages-belong-to-the-metapackage-tidymodels">Which packages belong to the metapackage tidymodels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">tidymodels<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidymodels_packages</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_self =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "broom"        "cli"          "conflicted"   "dials"        "dplyr"       
 [6] "ggplot2"      "hardhat"      "infer"        "modeldata"    "parsnip"     
[11] "purrr"        "recipes"      "rlang"        "rsample"      "rstudioapi"  
[16] "tibble"       "tidyr"        "tune"         "workflows"    "workflowsets"
[21] "yardstick"    "tidymodels"  </code></pre>
</div>
</div>
</section>
<section id="tutorial-1---palmerpenguins-dataset" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-1---palmerpenguins-dataset">Tutorial 1 - palmerpenguins dataset</h2>
<ul>
<li><a href="https://juliasilge.com/blog/palmer-penguins/">Link</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'palmerpenguins'</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3">penguins_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>year, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>island)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidymodels)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ broom        1.0.4     ✔ rsample      1.1.1
✔ dials        1.2.0     ✔ tune         1.1.1
✔ infer        1.0.4     ✔ workflows    1.1.3
✔ modeldata    1.1.0     ✔ workflowsets 1.0.1
✔ parsnip      1.1.0     ✔ yardstick    1.2.0
✔ recipes      1.0.6     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ dplyr::filter()   masks stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()
• Search for functions across packages at https://www.tidymodels.org/find/</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(penguins_df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 333
Columns: 6
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, 36.7, 39.3, 38.9, 39.2, 41.1, 38.6…
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, 19.3, 20.6, 17.8, 19.6, 17.6, 21.2…
$ flipper_length_mm &lt;int&gt; 181, 186, 195, 193, 190, 181, 195, 182, 191, 198, 18…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, 3450, 3650, 3625, 4675, 3200, 3800…
$ sex               &lt;fct&gt; male, female, female, female, male, female, male, fe…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">penguin_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_split</span>(penguins_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> sex)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(penguin_split)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ data  : tibble [333 × 6] (S3: tbl_df/tbl/data.frame)
  ..$ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
  ..$ bill_length_mm   : num [1:333] 39.1 39.5 40.3 36.7 39.3 38.9 39.2 41.1 38.6 34.6 ...
  ..$ bill_depth_mm    : num [1:333] 18.7 17.4 18 19.3 20.6 17.8 19.6 17.6 21.2 21.1 ...
  ..$ flipper_length_mm: int [1:333] 181 186 195 193 190 181 195 182 191 198 ...
  ..$ body_mass_g      : int [1:333] 3750 3800 3250 3450 3650 3625 4675 3200 3800 4400 ...
  ..$ sex              : Factor w/ 2 levels "female","male": 2 1 1 1 2 1 2 1 2 2 ...
 $ in_id : int [1:249] 2 3 4 11 12 18 24 26 28 33 ...
 $ out_id: logi NA
 $ id    : tibble [1 × 1] (S3: tbl_df/tbl/data.frame)
  ..$ id: chr "Resample1"
 - attr(*, "class")= chr [1:3] "initial_split" "mc_split" "rsplit"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">penguin_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(penguin_split)</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(penguin_train)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [249 × 6] (S3: tbl_df/tbl/data.frame)
 $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ bill_length_mm   : num [1:249] 39.5 40.3 36.7 36.6 38.7 35.9 37.9 39.5 39.5 42.2 ...
 $ bill_depth_mm    : num [1:249] 17.4 18 19.3 17.8 19 19.2 18.6 16.7 17.8 18.5 ...
 $ flipper_length_mm: int [1:249] 186 195 193 185 195 189 172 178 188 180 ...
 $ body_mass_g      : int [1:249] 3800 3250 3450 3700 3450 3800 3150 3250 3300 3550 ...
 $ sex              : Factor w/ 2 levels "female","male": 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">penguin_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(penguin_split)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb17-2">penguin_boot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bootstraps</span>(penguin_train)</span>
<span id="cb17-3">penguin_boot</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Bootstrap sampling 
# A tibble: 25 × 2
   splits           id         
   &lt;list&gt;           &lt;chr&gt;      
 1 &lt;split [249/93]&gt; Bootstrap01
 2 &lt;split [249/91]&gt; Bootstrap02
 3 &lt;split [249/90]&gt; Bootstrap03
 4 &lt;split [249/91]&gt; Bootstrap04
 5 &lt;split [249/85]&gt; Bootstrap05
 6 &lt;split [249/87]&gt; Bootstrap06
 7 &lt;split [249/94]&gt; Bootstrap07
 8 &lt;split [249/88]&gt; Bootstrap08
 9 &lt;split [249/95]&gt; Bootstrap09
10 &lt;split [249/89]&gt; Bootstrap10
# ℹ 15 more rows</code></pre>
</div>
</div>
<section id="question" class="level3">
<h3 class="anchored" data-anchor-id="question">Question:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how can I extract a single bootstrap sample?</span></span>
<span id="cb19-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_boot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(splits) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>()</span>
<span id="cb19-6"></span>
<span id="cb19-7">x[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 249 × 6
   species bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
   &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt; 
 1 Adelie            39.5          17.4               186        3800 female
 2 Adelie            40.3          18                 195        3250 female
 3 Adelie            36.7          19.3               193        3450 female
 4 Adelie            36.6          17.8               185        3700 female
 5 Adelie            38.7          19                 195        3450 female
 6 Adelie            35.9          19.2               189        3800 female
 7 Adelie            37.9          18.6               172        3150 female
 8 Adelie            39.5          16.7               178        3250 female
 9 Adelie            39.5          17.8               188        3300 female
10 Adelie            42.2          18.5               180        3550 female
# ℹ 239 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_boot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Bootstrap01'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(splits) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>()</span>
<span id="cb21-5"></span>
<span id="cb21-6">x[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 249 × 6
   species bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
   &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt; 
 1 Adelie            39.5          17.4               186        3800 female
 2 Adelie            40.3          18                 195        3250 female
 3 Adelie            36.7          19.3               193        3450 female
 4 Adelie            36.6          17.8               185        3700 female
 5 Adelie            38.7          19                 195        3450 female
 6 Adelie            35.9          19.2               189        3800 female
 7 Adelie            37.9          18.6               172        3150 female
 8 Adelie            39.5          16.7               178        3250 female
 9 Adelie            39.5          17.8               188        3300 female
10 Adelie            42.2          18.5               180        3550 female
# ℹ 239 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">glm_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logistic_reg</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">rf_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rand_forest</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"classification"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ranger"</span>)</span>
<span id="cb24-4"></span>
<span id="cb24-5">rf_spec</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest Model Specification (classification)

Computational engine: ranger </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">penguin_wf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_formula</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .)</span>
<span id="cb26-3"></span>
<span id="cb26-4">penguin_wf</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Formula
Model: None

── Preprocessor ────────────────────────────────────────────────────────────────
sex ~ .</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">glm_rs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_wf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_model</span>(glm_spec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fit_resamples</span>(</span>
<span id="cb28-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> penguin_boot,</span>
<span id="cb28-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">control_resamples</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_pred =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb28-6">  )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">glm_rs</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Bootstrap sampling 
# A tibble: 25 × 5
   splits           id          .metrics         .notes           .predictions
   &lt;list&gt;           &lt;chr&gt;       &lt;list&gt;           &lt;list&gt;           &lt;list&gt;      
 1 &lt;split [249/93]&gt; Bootstrap01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 2 &lt;split [249/91]&gt; Bootstrap02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 3 &lt;split [249/90]&gt; Bootstrap03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 4 &lt;split [249/91]&gt; Bootstrap04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 5 &lt;split [249/85]&gt; Bootstrap05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 6 &lt;split [249/87]&gt; Bootstrap06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 7 &lt;split [249/94]&gt; Bootstrap07 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 8 &lt;split [249/88]&gt; Bootstrap08 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 9 &lt;split [249/95]&gt; Bootstrap09 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
10 &lt;split [249/89]&gt; Bootstrap10 &lt;tibble [2 × 4]&gt; &lt;tibble [1 × 3]&gt; &lt;tibble&gt;    
# ℹ 15 more rows

There were issues with some computations:

  - Warning(s) x2: glm.fit: fitted probabilities numerically 0 or 1 occurred

Run `show_notes(.Last.tune.result)` for more information.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">rf_rs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_wf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_model</span>(rf_spec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fit_resamples</span>(</span>
<span id="cb35-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> penguin_boot,</span>
<span id="cb35-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">control_resamples</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_pred =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb35-6">  )</span>
<span id="cb35-7"></span>
<span id="cb35-8">rf_rs</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Bootstrap sampling 
# A tibble: 25 × 5
   splits           id          .metrics         .notes           .predictions
   &lt;list&gt;           &lt;chr&gt;       &lt;list&gt;           &lt;list&gt;           &lt;list&gt;      
 1 &lt;split [249/93]&gt; Bootstrap01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 2 &lt;split [249/91]&gt; Bootstrap02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 3 &lt;split [249/90]&gt; Bootstrap03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 4 &lt;split [249/91]&gt; Bootstrap04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 5 &lt;split [249/85]&gt; Bootstrap05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 6 &lt;split [249/87]&gt; Bootstrap06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 7 &lt;split [249/94]&gt; Bootstrap07 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 8 &lt;split [249/88]&gt; Bootstrap08 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 9 &lt;split [249/95]&gt; Bootstrap09 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
10 &lt;split [249/89]&gt; Bootstrap10 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
# ℹ 15 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(rf_rs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary     0.899    25 0.00704 Preprocessor1_Model1
2 roc_auc  binary     0.971    25 0.00307 Preprocessor1_Model1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(glm_rs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary     0.919    25 0.00527 Preprocessor1_Model1
2 roc_auc  binary     0.977    25 0.00220 Preprocessor1_Model1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">glm_rs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conf_mat_resampled</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  Prediction Truth   Freq
  &lt;fct&gt;      &lt;fct&gt;  &lt;dbl&gt;
1 female     female 41.8 
2 female     male    3.72
3 male       female  3.68
4 male       male   41.6 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">glm_rs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_predictions</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">roc_curve</span>(sex, .pred_female) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> specificity, sensitivity, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">penguin_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_wf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb44-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_model</span>(glm_spec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb44-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last_fit</span>(penguin_split)</span>
<span id="cb44-4"></span>
<span id="cb44-5">penguin_final</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Manual resampling 
# A tibble: 1 × 6
  splits           id               .metrics .notes   .predictions .workflow 
  &lt;list&gt;           &lt;chr&gt;            &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    
1 &lt;split [249/84]&gt; train/test split &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(penguin_final)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary         0.905 Preprocessor1_Model1
2 roc_auc  binary         0.966 Preprocessor1_Model1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_predictions</span>(penguin_final) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb48-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conf_mat</span>(sex, .pred_class)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction female male
    female     39    5
    male        3   37</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">penguin_final<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>.workflow[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb50-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exponentiate =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 5
  term              estimate std.error statistic     p.value
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 (Intercept)       2.35e-42  18.1        -5.30  0.000000115
2 speciesChinstrap  9.76e- 4   1.91       -3.62  0.000295   
3 speciesGentoo     1.96e- 4   3.25       -2.63  0.00866    
4 bill_length_mm    1.88e+ 0   0.159       4.00  0.0000639  
5 bill_depth_mm     7.50e+ 0   0.455       4.43  0.00000940 
6 flipper_length_mm 1.06e+ 0   0.0653      0.863 0.388      
7 body_mass_g       1.01e+ 0   0.00138     4.63  0.00000374 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">penguins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb52-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb52-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(bill_depth_mm, bill_length_mm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> body_mass_g)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels.html</guid>
  <pubDate>Thu, 03 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Kaplan Meier plots</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots.html</link>
  <description><![CDATA[ 



<p>Goal: draw facetted Kaplan-Meier-plots with p-value</p>
<section id="with-ggquickeda" class="level2">
<h2 class="anchored" data-anchor-id="with-ggquickeda">With ggquickeda</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survival'</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggquickeda'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggquickeda'

The following object is masked from 'package:base':

    +</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">text_to_add <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> text, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> y, </span>
<span id="cb5-3">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Male'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'p = 0.1'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,</span>
<span id="cb5-4">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Female'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'p = 0.03'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb5-5"></span>
<span id="cb5-6"></span>
<span id="cb5-7"></span>
<span id="cb5-8">colon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb5-10">    sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Male'</span>,</span>
<span id="cb5-11">    sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Female'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perfor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(perfor)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-13">  </span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> status, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> perfor)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_km</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_kmticks</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text, </span>
<span id="cb5-18">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, </span>
<span id="cb5-19">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-20">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> text_to_add, </span>
<span id="cb5-21">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Estimated survival'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic with geom_path was deprecated in ggplot2 3.4.0.
ℹ Please use the `linewidth` aesthetic instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="with-survminer" class="level2">
<h2 class="anchored" data-anchor-id="with-survminer">With survminer</h2>
<section id="do-faceting-with-survminer" class="level3">
<h3 class="anchored" data-anchor-id="do-faceting-with-survminer">Do faceting with survminer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survminer'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpubr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survminer'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    myeloma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon )</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot_facet</span>(fit, colon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">facet.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rx'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>), </span>
<span id="cb12-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ggtheme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_grey</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as.tibble()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` instead.
ℹ The signature and semantics have changed, see `?as_tibble`.
ℹ The deprecated feature was likely used in the survminer package.
  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `select_()` was deprecated in dplyr 0.7.0.
ℹ Please use `select()` instead.
ℹ The deprecated feature was likely used in the survminer package.
  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="extract-plot-object-so-it-can-be-modified-in-a-more-usual-ggplot2-style" class="level3">
<h3 class="anchored" data-anchor-id="extract-plot-object-so-it-can-be-modified-in-a-more-usual-ggplot2-style">Extract plot object so it can be modified in a more usual ggplot2 style</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> perfor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon )</span>
<span id="cb15-2">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>)</span>
<span id="cb15-3">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_grey</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time [days]'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> perfor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon )</span>
<span id="cb16-2">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">facet.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sex'</span>)</span></code></pre></div>
</div>
</section>
<section id="show-possible-problem-in-survminer" class="level3">
<h3 class="anchored" data-anchor-id="show-possible-problem-in-survminer">Show possible problem in survminer</h3>
<ul>
<li>After facetting, the p-values seem not be correct anymore</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon)</span>
<span id="cb17-2">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-3">gg</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(rx))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(rx, sex))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="try-to-help-someone" class="level3">
<h3 class="anchored" data-anchor-id="try-to-help-someone">Try to help someone</h3>
<ul>
<li><a href="https://github.com/kassambara/survminer/issues/617">Link</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survival'</span>)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survminer'</span>)</span>
<span id="cb20-4"></span>
<span id="cb20-5">text_to_add <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> text, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> y, </span>
<span id="cb20-7">          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Some text'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb20-8">          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Some other text'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb20-9"></span>
<span id="cb20-10">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon)</span>
<span id="cb20-11">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit)</span>
<span id="cb20-12">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gray</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text),</span>
<span id="cb20-14">             text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>))</span>
<span id="cb21-2">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gray</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text),</span>
<span id="cb21-4">             text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots.html</guid>
  <pubDate>Wed, 02 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Reducing image file size with ImageMagick</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/2023-08-03-reducing-image-file-size-with-imagemagick.html</link>
  <description><![CDATA[ 



<section id="links" class="level2">
<h2 class="anchored" data-anchor-id="links">Links</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/7261855/recommendation-for-compressing-jpg-files-with-imagemagick">stackoverflow post recommandations for compressing</a></li>
<li><a href="https://stackoverflow.com/questions/6917219/imagemagick-scale-jpeg-image-with-a-maximum-file-size">stackoverflow maximum file size</a></li>
<li><a href="https://www.smashingmagazine.com/2015/06/efficient-image-resizing-with-imagemagick/">Extensive analysis of imagemagick options</a></li>
</ul>
</section>
<section id="initial-analysis" class="level2">
<h2 class="anchored" data-anchor-id="initial-analysis">Initial analysis</h2>
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_original.jpg" class="img-fluid" style="width:32.0%" data-fig-align="center" alt="Koga Original"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_signal.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center" alt="Koga Signal version"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_edited.jpg" class="img-fluid" style="width:32.0%" data-fig-align="center" alt="Koga ImageMagick"></p>
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_original.jpg" class="img-fluid" style="width:99.0%" data-fig-align="center" alt="Koga Original"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_signal.jpeg" class="img-fluid" style="width:99.0%" data-fig-align="center" alt="Koga Signal version"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_edited.jpg" class="img-fluid" style="width:99.0%" data-fig-align="center" alt="Koga ImageMagick"></p>
</section>
<section id="currently-best-version" class="level2">
<h2 class="anchored" data-anchor-id="currently-best-version">Currently best version</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'convert koga_original.jpg -quality 50 -resize 2048 low_quality_3.jpg'</span>)</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/low_quality_3.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Currently best version</figcaption>
</figure>
</div>
</section>
<section id="even-a-lot-smaller" class="level2">
<h2 class="anchored" data-anchor-id="even-a-lot-smaller">Even a lot smaller</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'convert koga_original.jpg -quality 50 -resize 1024 low_quality_4.jpg'</span>)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'convert koga_original.jpg -quality 50 -resize 512 low_quality_5.jpg'</span>)</span></code></pre></div>
</div>
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/low_quality_4.jpg" class="img-fluid" alt="Even a lot smaller"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/low_quality_5.jpg" class="img-fluid" alt="Even a lot smaller"></p>
</section>
<section id="file-sizes" class="level2">
<h2 class="anchored" data-anchor-id="file-sizes">File sizes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fs'</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filenames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir_ls</span>(), </span>
<span id="cb3-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filesizes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_size</span>(filenames)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 85%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">filenames</th>
<th style="text-align: center;">filesizes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2023-08-03-reducing-image-file-size-with-imagemagick.qmd</td>
<td style="text-align: center;">2.09K</td>
</tr>
<tr class="even">
<td style="text-align: center;">2023-08-03-reducing-image-file-size-with-imagemagick.rmarkdown</td>
<td style="text-align: center;">2.1K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2023-08-03-reducing-image-file-size-with-imagemagick_files</td>
<td style="text-align: center;">96</td>
</tr>
<tr class="even">
<td style="text-align: center;">koga_edited.jpg</td>
<td style="text-align: center;">193.93K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">koga_original.jpg</td>
<td style="text-align: center;">2.5M</td>
</tr>
<tr class="even">
<td style="text-align: center;">koga_signal.jpeg</td>
<td style="text-align: center;">505.13K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">low_quality_1.jpg</td>
<td style="text-align: center;">206.18K</td>
</tr>
<tr class="even">
<td style="text-align: center;">low_quality_2.jpg</td>
<td style="text-align: center;">516.7K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">low_quality_3.jpg</td>
<td style="text-align: center;">387.38K</td>
</tr>
<tr class="even">
<td style="text-align: center;">low_quality_4.jpg</td>
<td style="text-align: center;">206.18K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">low_quality_5.jpg</td>
<td style="text-align: center;">146.79K</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

 ]]></description>
  <category>R</category>
  <category>Mishmash</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/2023-08-03-reducing-image-file-size-with-imagemagick.html</guid>
  <pubDate>Wed, 02 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Approximating Pi</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-23-approximating-pi/2023-07-23-approximating-pi.html</link>
  <description><![CDATA[ 



<p>This is a really pointless post about approximating <img src="https://latex.codecogs.com/png.latex?%5Cpi">, inspired by <a href="https://www.r-bloggers.com/2023/07/happy-pi-approximation-day/">this</a> post.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">current_min_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb1-2">current_best_numerator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span></span>
<span id="cb1-3">current_best_denominator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(denominator <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e7</span>) {</span>
<span id="cb1-6">  numerator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(denominator <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi)</span>
<span id="cb1-7">  pi_approx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> numerator <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denominator</span>
<span id="cb1-8">  pi_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pi_approx)</span>
<span id="cb1-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(pi_error <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> current_min_error) {</span>
<span id="cb1-10">    current_min_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pi_error</span>
<span id="cb1-11">    current_best_numerator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> numerator</span>
<span id="cb1-12">    current_best_denominator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> denominator</span>
<span id="cb1-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'numerator:'</span>, numerator, </span>
<span id="cb1-14">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', denominator:'</span>, denominator, </span>
<span id="cb1-15">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', pi_approx: '</span>, numerator <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denominator, </span>
<span id="cb1-16">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', absolute error'</span>, pi_error, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)))</span>
<span id="cb1-17">  }</span>
<span id="cb1-18">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numerator: 179 , denominator: 57 , pi_approx:  3.14035087719298 , absolute error 0.00124177639681067 
numerator: 201 , denominator: 64 , pi_approx:  3.140625 , absolute error 0.000967653589793116 
numerator: 223 , denominator: 71 , pi_approx:  3.14084507042254 , absolute error 0.000747583167258092 
numerator: 245 , denominator: 78 , pi_approx:  3.14102564102564 , absolute error 0.000567012564152147 
numerator: 267 , denominator: 85 , pi_approx:  3.14117647058824 , absolute error 0.000416183001557879 
numerator: 289 , denominator: 92 , pi_approx:  3.14130434782609 , absolute error 0.000288305763706198 
numerator: 311 , denominator: 99 , pi_approx:  3.14141414141414 , absolute error 0.000178512175651679 
numerator: 333 , denominator: 106 , pi_approx:  3.14150943396226 , absolute error 8.32196275291075e-05 
numerator: 355 , denominator: 113 , pi_approx:  3.14159292035398 , absolute error 2.66764189404967e-07 
numerator: 52163 , denominator: 16604 , pi_approx:  3.14159238737654 , absolute error 2.66213257216208e-07 
numerator: 52518 , denominator: 16717 , pi_approx:  3.14159239097924 , absolute error 2.62610550638698e-07 
numerator: 52873 , denominator: 16830 , pi_approx:  3.14159239453357 , absolute error 2.5905622225153e-07 
numerator: 53228 , denominator: 16943 , pi_approx:  3.14159239804049 , absolute error 2.55549304384317e-07 
numerator: 53583 , denominator: 17056 , pi_approx:  3.14159240150094 , absolute error 2.52088855123844e-07 
numerator: 53938 , denominator: 17169 , pi_approx:  3.14159240491584 , absolute error 2.48673956537715e-07 
numerator: 54293 , denominator: 17282 , pi_approx:  3.14159240828608 , absolute error 2.45303715118439e-07 
numerator: 54648 , denominator: 17395 , pi_approx:  3.14159241161253 , absolute error 2.41977260895254e-07 
numerator: 55003 , denominator: 17508 , pi_approx:  3.14159241489605 , absolute error 2.3869374565777e-07 
numerator: 55358 , denominator: 17621 , pi_approx:  3.14159241813745 , absolute error 2.35452343400055e-07 
numerator: 55713 , denominator: 17734 , pi_approx:  3.14159242133754 , absolute error 2.32252249432463e-07 
numerator: 56068 , denominator: 17847 , pi_approx:  3.14159242449711 , absolute error 2.29092678605269e-07 
numerator: 56423 , denominator: 17960 , pi_approx:  3.14159242761693 , absolute error 2.25972866640944e-07 
numerator: 56778 , denominator: 18073 , pi_approx:  3.14159243069773 , absolute error 2.22892067025526e-07 
numerator: 57133 , denominator: 18186 , pi_approx:  3.14159243374024 , absolute error 2.19849553229068e-07 
numerator: 57488 , denominator: 18299 , pi_approx:  3.14159243674518 , absolute error 2.16844615597012e-07 
numerator: 57843 , denominator: 18412 , pi_approx:  3.14159243971323 , absolute error 2.13876562682458e-07 
numerator: 58198 , denominator: 18525 , pi_approx:  3.14159244264507 , absolute error 2.10944719025719e-07 
numerator: 58553 , denominator: 18638 , pi_approx:  3.14159244554137 , absolute error 2.08048426042495e-07 
numerator: 58908 , denominator: 18751 , pi_approx:  3.14159244840275 , absolute error 2.05187041135702e-07 
numerator: 59263 , denominator: 18864 , pi_approx:  3.14159245122986 , absolute error 2.02359937251373e-07 
numerator: 59618 , denominator: 18977 , pi_approx:  3.14159245402329 , absolute error 1.995665015464e-07 
numerator: 59973 , denominator: 19090 , pi_approx:  3.14159245678366 , absolute error 1.96806136720795e-07 
numerator: 60328 , denominator: 19203 , pi_approx:  3.14159245951153 , absolute error 1.94078258353159e-07 
numerator: 60683 , denominator: 19316 , pi_approx:  3.1415924622075 , absolute error 1.91382296677034e-07 
numerator: 61038 , denominator: 19429 , pi_approx:  3.1415924648721 , absolute error 1.88717694804552e-07 
numerator: 61393 , denominator: 19542 , pi_approx:  3.14159246750588 , absolute error 1.86083908282342e-07 
numerator: 61748 , denominator: 19655 , pi_approx:  3.14159247010939 , absolute error 1.83480405979708e-07 
numerator: 62103 , denominator: 19768 , pi_approx:  3.14159247268312 , absolute error 1.80906668756364e-07 
numerator: 62458 , denominator: 19881 , pi_approx:  3.1415924752276 , absolute error 1.78362189018344e-07 
numerator: 62813 , denominator: 19994 , pi_approx:  3.14159247774332 , absolute error 1.7584647027391e-07 
numerator: 63168 , denominator: 20107 , pi_approx:  3.14159248023077 , absolute error 1.73359027577646e-07 
numerator: 63523 , denominator: 20220 , pi_approx:  3.14159248269041 , absolute error 1.70899387530454e-07 
numerator: 63878 , denominator: 20333 , pi_approx:  3.14159248512271 , absolute error 1.6846708605911e-07 
numerator: 64233 , denominator: 20446 , pi_approx:  3.14159248752812 , absolute error 1.66061670192619e-07 
numerator: 64588 , denominator: 20559 , pi_approx:  3.1415924899071 , absolute error 1.63682696285861e-07 
numerator: 64943 , denominator: 20672 , pi_approx:  3.14159249226006 , absolute error 1.61329731351856e-07 
numerator: 65298 , denominator: 20785 , pi_approx:  3.14159249458744 , absolute error 1.5900235039723e-07 
numerator: 65653 , denominator: 20898 , pi_approx:  3.14159249688965 , absolute error 1.56700138642663e-07 
numerator: 66008 , denominator: 21011 , pi_approx:  3.1415924991671 , absolute error 1.54422690190614e-07 
numerator: 66363 , denominator: 21124 , pi_approx:  3.14159250142019 , absolute error 1.52169607581243e-07 
numerator: 66718 , denominator: 21237 , pi_approx:  3.14159250364929 , absolute error 1.499405017924e-07 
numerator: 67073 , denominator: 21350 , pi_approx:  3.1415925058548 , absolute error 1.47734992239634e-07 
numerator: 67428 , denominator: 21463 , pi_approx:  3.14159250803709 , absolute error 1.45552705888008e-07 
numerator: 67783 , denominator: 21576 , pi_approx:  3.14159251019651 , absolute error 1.43393278584369e-07 
numerator: 68138 , denominator: 21689 , pi_approx:  3.14159251233344 , absolute error 1.41256352392816e-07 
numerator: 68493 , denominator: 21802 , pi_approx:  3.14159251444822 , absolute error 1.39141577371049e-07 
numerator: 68848 , denominator: 21915 , pi_approx:  3.14159251654118 , absolute error 1.37048611126289e-07 
numerator: 69203 , denominator: 22028 , pi_approx:  3.14159251861267 , absolute error 1.34977118371182e-07 
numerator: 69558 , denominator: 22141 , pi_approx:  3.14159252066302 , absolute error 1.32926769591535e-07 
numerator: 69913 , denominator: 22254 , pi_approx:  3.14159252269255 , absolute error 1.30897243266759e-07 
numerator: 70268 , denominator: 22367 , pi_approx:  3.14159252470157 , absolute error 1.28888223649426e-07 
numerator: 70623 , denominator: 22480 , pi_approx:  3.14159252669039 , absolute error 1.26899401653446e-07 
numerator: 70978 , denominator: 22593 , pi_approx:  3.14159252865932 , absolute error 1.2493047396589e-07 
numerator: 71333 , denominator: 22706 , pi_approx:  3.14159253060865 , absolute error 1.22981143491074e-07 
numerator: 71688 , denominator: 22819 , pi_approx:  3.14159253253867 , absolute error 1.21051119350568e-07 
numerator: 72043 , denominator: 22932 , pi_approx:  3.14159253444968 , absolute error 1.19140115995009e-07 
numerator: 72398 , denominator: 23045 , pi_approx:  3.14159253634194 , absolute error 1.17247853648195e-07 
numerator: 72753 , denominator: 23158 , pi_approx:  3.14159253821574 , absolute error 1.15374057862994e-07 
numerator: 73108 , denominator: 23271 , pi_approx:  3.14159254007133 , absolute error 1.13518459521345e-07 
numerator: 73463 , denominator: 23384 , pi_approx:  3.141592541909 , absolute error 1.11680795722435e-07 
numerator: 73818 , denominator: 23497 , pi_approx:  3.14159254372899 , absolute error 1.09860806229989e-07 
numerator: 74173 , denominator: 23610 , pi_approx:  3.14159254553155 , absolute error 1.08058238801334e-07 
numerator: 74528 , denominator: 23723 , pi_approx:  3.14159254731695 , absolute error 1.06272843414246e-07 
numerator: 74883 , denominator: 23836 , pi_approx:  3.14159254908542 , absolute error 1.04504376263748e-07 
numerator: 75238 , denominator: 23949 , pi_approx:  3.1415925508372 , absolute error 1.02752597541667e-07 
numerator: 75593 , denominator: 24062 , pi_approx:  3.14159255257252 , absolute error 1.0101727232481e-07 
numerator: 75948 , denominator: 24175 , pi_approx:  3.14159255429162 , absolute error 9.92981696867901e-08 
numerator: 76303 , denominator: 24288 , pi_approx:  3.14159255599473 , absolute error 9.75950631421085e-08 
numerator: 76658 , denominator: 24401 , pi_approx:  3.14159255768206 , absolute error 9.59077310902501e-08 
numerator: 77013 , denominator: 24514 , pi_approx:  3.14159255935384 , absolute error 9.42359545952343e-08 
numerator: 77368 , denominator: 24627 , pi_approx:  3.14159256101027 , absolute error 9.25795200501511e-08 
numerator: 77723 , denominator: 24740 , pi_approx:  3.14159256265158 , absolute error 9.0938216512626e-08 
numerator: 78078 , denominator: 24853 , pi_approx:  3.14159256427795 , absolute error 8.9311838813444e-08 
numerator: 78433 , denominator: 24966 , pi_approx:  3.14159256588961 , absolute error 8.77001831156576e-08 
numerator: 78788 , denominator: 25079 , pi_approx:  3.14159256748674 , absolute error 8.61030513554795e-08 
numerator: 79143 , denominator: 25192 , pi_approx:  3.14159256906955 , absolute error 8.45202472454787e-08 
numerator: 79498 , denominator: 25305 , pi_approx:  3.14159257063821 , absolute error 8.29515793832059e-08 
numerator: 79853 , denominator: 25418 , pi_approx:  3.14159257219293 , absolute error 8.13968590307468e-08 
numerator: 80208 , denominator: 25531 , pi_approx:  3.14159257373389 , absolute error 7.9855901002901e-08 
numerator: 80563 , denominator: 25644 , pi_approx:  3.14159257526127 , absolute error 7.83285232230924e-08 
numerator: 80918 , denominator: 25757 , pi_approx:  3.14159257677525 , absolute error 7.68145476115478e-08 
numerator: 81273 , denominator: 25870 , pi_approx:  3.141592578276 , absolute error 7.5313797864851e-08 
numerator: 81628 , denominator: 25983 , pi_approx:  3.14159257976369 , absolute error 7.38261016763886e-08 
numerator: 81983 , denominator: 26096 , pi_approx:  3.1415925812385 , absolute error 7.23512889599931e-08 
numerator: 82338 , denominator: 26209 , pi_approx:  3.1415925827006 , absolute error 7.08891940703893e-08 
numerator: 82693 , denominator: 26322 , pi_approx:  3.14159258415014 , absolute error 6.94396526945695e-08 
numerator: 83048 , denominator: 26435 , pi_approx:  3.14159258558729 , absolute error 6.80025036281506e-08 
numerator: 83403 , denominator: 26548 , pi_approx:  3.1415925870122 , absolute error 6.65775887753739e-08 
numerator: 83758 , denominator: 26661 , pi_approx:  3.14159258842504 , absolute error 6.51647527050159e-08 
numerator: 84113 , denominator: 26774 , pi_approx:  3.14159258982595 , absolute error 6.37638426503884e-08 
numerator: 84468 , denominator: 26887 , pi_approx:  3.14159259121509 , absolute error 6.237470762116e-08 
numerator: 84823 , denominator: 27000 , pi_approx:  3.14159259259259 , absolute error 6.09972006238024e-08 
numerator: 85178 , denominator: 27113 , pi_approx:  3.14159259395862 , absolute error 5.96311755529655e-08 
numerator: 85533 , denominator: 27226 , pi_approx:  3.1415925953133 , absolute error 5.82764898560129e-08 
numerator: 85888 , denominator: 27339 , pi_approx:  3.14159259665679 , absolute error 5.69330023125758e-08 
numerator: 86243 , denominator: 27452 , pi_approx:  3.14159259798922 , absolute error 5.56005756990885e-08 
numerator: 86598 , denominator: 27565 , pi_approx:  3.14159259931072 , absolute error 5.42790727919851e-08 
numerator: 86953 , denominator: 27678 , pi_approx:  3.14159260062143 , absolute error 5.29683608085918e-08 
numerator: 87308 , denominator: 27791 , pi_approx:  3.14159260192149 , absolute error 5.16683078544133e-08 
numerator: 87663 , denominator: 27904 , pi_approx:  3.14159260321101 , absolute error 5.03787838113112e-08 
numerator: 88018 , denominator: 28017 , pi_approx:  3.14159260449013 , absolute error 4.90996621138606e-08 
numerator: 88373 , denominator: 28130 , pi_approx:  3.14159260575898 , absolute error 4.78308170848152e-08 
numerator: 88728 , denominator: 28243 , pi_approx:  3.14159260701767 , absolute error 4.65721248232853e-08 
numerator: 89083 , denominator: 28356 , pi_approx:  3.14159260826633 , absolute error 4.53234649810952e-08 
numerator: 89438 , denominator: 28469 , pi_approx:  3.14159260950508 , absolute error 4.40847172100689e-08 
numerator: 89793 , denominator: 28582 , pi_approx:  3.14159261073403 , absolute error 4.28557647147443e-08 
numerator: 90148 , denominator: 28695 , pi_approx:  3.1415926119533 , absolute error 4.16364911437483e-08 
numerator: 90503 , denominator: 28808 , pi_approx:  3.14159261316301 , absolute error 4.04267828102434e-08 
numerator: 90858 , denominator: 28921 , pi_approx:  3.14159261436327 , absolute error 3.92265278037485e-08 
numerator: 91213 , denominator: 29034 , pi_approx:  3.14159261555418 , absolute error 3.80356151019612e-08 
numerator: 91568 , denominator: 29147 , pi_approx:  3.14159261673586 , absolute error 3.68539367912035e-08 
numerator: 91923 , denominator: 29260 , pi_approx:  3.14159261790841 , absolute error 3.56813858459759e-08 
numerator: 92278 , denominator: 29373 , pi_approx:  3.14159261907194 , absolute error 3.45178561289572e-08 
numerator: 92633 , denominator: 29486 , pi_approx:  3.14159262022655 , absolute error 3.33632450555399e-08 
numerator: 92988 , denominator: 29599 , pi_approx:  3.14159262137234 , absolute error 3.22174495970273e-08 
numerator: 93343 , denominator: 29712 , pi_approx:  3.14159262250942 , absolute error 3.10803693892581e-08 
numerator: 93698 , denominator: 29825 , pi_approx:  3.14159262363789 , absolute error 2.99519054003383e-08 
numerator: 94053 , denominator: 29938 , pi_approx:  3.14159262475783 , absolute error 2.88319603747311e-08 
numerator: 94408 , denominator: 30051 , pi_approx:  3.14159262586936 , absolute error 2.77204375009887e-08 
numerator: 94763 , denominator: 30164 , pi_approx:  3.14159262697255 , absolute error 2.66172430762879e-08 
numerator: 95118 , denominator: 30277 , pi_approx:  3.14159262806751 , absolute error 2.55222829537161e-08 
numerator: 95473 , denominator: 30390 , pi_approx:  3.14159262915433 , absolute error 2.44354660949853e-08 
numerator: 95828 , denominator: 30503 , pi_approx:  3.14159263023309 , absolute error 2.33567014618075e-08 
numerator: 96183 , denominator: 30616 , pi_approx:  3.14159263130389 , absolute error 2.22858997922515e-08 
numerator: 96538 , denominator: 30729 , pi_approx:  3.14159263236682 , absolute error 2.1222973600743e-08 
numerator: 96893 , denominator: 30842 , pi_approx:  3.14159263342196 , absolute error 2.01678358457968e-08 
numerator: 97248 , denominator: 30955 , pi_approx:  3.14159263446939 , absolute error 1.91204021504632e-08 
numerator: 97603 , denominator: 31068 , pi_approx:  3.14159263550921 , absolute error 1.80805876937029e-08 
numerator: 97958 , denominator: 31181 , pi_approx:  3.14159263654148 , absolute error 1.70483094308338e-08 
numerator: 98313 , denominator: 31294 , pi_approx:  3.14159263756631 , absolute error 1.60234865376196e-08 
numerator: 98668 , denominator: 31407 , pi_approx:  3.14159263858376 , absolute error 1.50060377457351e-08 
numerator: 99023 , denominator: 31520 , pi_approx:  3.14159263959391 , absolute error 1.39958844513899e-08 
numerator: 99378 , denominator: 31633 , pi_approx:  3.14159264059685 , absolute error 1.2992948050794e-08 
numerator: 99733 , denominator: 31746 , pi_approx:  3.14159264159264 , absolute error 1.19971517165141e-08 
numerator: 100088 , denominator: 31859 , pi_approx:  3.14159264258137 , absolute error 1.1008419065206e-08 
numerator: 100443 , denominator: 31972 , pi_approx:  3.14159264356312 , absolute error 1.00266754898826e-08 
numerator: 100798 , denominator: 32085 , pi_approx:  3.14159264453795 , absolute error 9.0518468276457e-09 
numerator: 101153 , denominator: 32198 , pi_approx:  3.14159264550593 , absolute error 8.08386113604342e-09 
numerator: 101508 , denominator: 32311 , pi_approx:  3.14159264646715 , absolute error 7.12264558444531e-09 
numerator: 101863 , denominator: 32424 , pi_approx:  3.14159264742166 , absolute error 6.1681300067562e-09 
numerator: 102218 , denominator: 32537 , pi_approx:  3.14159264836955 , absolute error 5.22024468097015e-09 
numerator: 102573 , denominator: 32650 , pi_approx:  3.14159264931087 , absolute error 4.27892032917043e-09 
numerator: 102928 , denominator: 32763 , pi_approx:  3.1415926502457 , absolute error 3.34408900570793e-09 
numerator: 103283 , denominator: 32876 , pi_approx:  3.14159265117411 , absolute error 2.41568454129037e-09 
numerator: 103638 , denominator: 32989 , pi_approx:  3.14159265209615 , absolute error 1.49363987844708e-09 
numerator: 103993 , denominator: 33102 , pi_approx:  3.1415926530119 , absolute error 5.77890624242627e-10 
numerator: 104348 , denominator: 33215 , pi_approx:  3.14159265392142 , absolute error 3.31628058347633e-10 
numerator: 208341 , denominator: 66317 , pi_approx:  3.14159265346744 , absolute error 1.22356347276309e-10 
numerator: 312689 , denominator: 99532 , pi_approx:  3.14159265361894 , absolute error 2.91433543964104e-11 
numerator: 833719 , denominator: 265381 , pi_approx:  3.14159265358108 , absolute error 8.71525074330748e-12 
numerator: 1146408 , denominator: 364913 , pi_approx:  3.1415926535914 , absolute error 1.61071156412618e-12 
numerator: 3126535 , denominator: 995207 , pi_approx:  3.14159265358865 , absolute error 1.14264153694421e-12 
numerator: 4272943 , denominator: 1360120 , pi_approx:  3.14159265358939 , absolute error 4.04121180963557e-13 
numerator: 5419351 , denominator: 1725033 , pi_approx:  3.14159265358982 , absolute error 2.22044604925031e-14 </code></pre>
</div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-23-approximating-pi/2023-07-23-approximating-pi.html</guid>
  <pubDate>Sat, 22 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Bicycle comparison</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/2023-07-23-bicycle-comparison.html</link>
  <description><![CDATA[ 



<section id="the-three-bikes" class="level2">
<h2 class="anchored" data-anchor-id="the-three-bikes">The three bikes</h2>
<p><img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/koga_old.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center"> <img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/koga_new.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center"> <img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/hammerbacher.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center"></p>
</section>
<section id="points-to-be-represented" class="level2">
<h2 class="anchored" data-anchor-id="points-to-be-represented">Points to be represented</h2>
<ul>
<li>front axis</li>
<li>back axis</li>
<li>front beginning of tire</li>
<li>back beginning of tire</li>
<li>handlebar low</li>
<li>handlebar high</li>
<li>saddle front</li>
<li>saddle back</li>
<li>pedals</li>
</ul>
<p>Coordinate system: Point 1 is front axis, point 2 is back of saddle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">loc_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'front_axis'</span>,</span>
<span id="cb1-2">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'back_axis'</span>,</span>
<span id="cb1-3">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'front_beginning_of_tire'</span>,</span>
<span id="cb1-4">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'back_beginning_of_tire'</span>,</span>
<span id="cb1-5">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'handlebar_low'</span>,</span>
<span id="cb1-6">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'handlebar_high'</span>,</span>
<span id="cb1-7">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'saddle_front'</span>,</span>
<span id="cb1-8">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'saddle_back'</span>,</span>
<span id="cb1-9">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pedals'</span>)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'digitize'</span>)</span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">load</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'not_yet_formatted.Rdata'</span>)</span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save(list = c('koga_new', 'koga_old', 'hammerbacher'), file = 'not_yet_formatted.Rdata')</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># help(package = 'digitize')</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># koga_old &lt;- digitize('koga_old.jpeg')</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># koga_new &lt;- digitize('koga_new.jpeg')</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hammerbacher &lt;- digitize('hammerbacher.jpeg')</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21">tidy_digit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(dat) {</span>
<span id="cb1-22">  var_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substitute</span>(dat))</span>
<span id="cb1-23">  dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var_name =</span> var_name,</span>
<span id="cb1-26">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">loc =</span> loc_names)</span>
<span id="cb1-27">}</span>
<span id="cb1-28"></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_new)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
         x        y var_name loc                    
     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;                  
1 -0.00334 -0.00309 koga_new front_axis             
2  1.07     0.0401  koga_new back_axis              
3 -0.321   -0.0679  koga_new front_beginning_of_tire
4  1.08    -0.383   koga_new back_beginning_of_tire 
5  0.207    1.02    koga_new handlebar_low          
6  0.0870   1.12    koga_new handlebar_high         
7  0.722    0.978   koga_new saddle_front           
8  0.997    0.994   koga_new saddle_back            
9  0.622   -0.0432  koga_new pedals                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_old)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
          x        y var_name loc                    
      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;                  
1  3.33e-16 -0.00317 koga_old front_axis             
2  1.14e+ 0  0.0190  koga_old back_axis              
3 -3.33e- 1  0.0254  koga_old front_beginning_of_tire
4  1.15e+ 0 -0.410   koga_old back_beginning_of_tire 
5  2.46e- 1  1.03    koga_old handlebar_low          
6  1.01e- 1  1.19    koga_old handlebar_high         
7  7.25e- 1  0.952   koga_old saddle_front           
8  9.96e- 1  0.997   koga_old saddle_back            
9  6.63e- 1 -0.0698  koga_old pedals                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(hammerbacher)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
         x        y var_name     loc                    
     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;                  
1  0.00376  0.00599 hammerbacher front_axis             
2  1.20     0.0659  hammerbacher back_axis              
3 -0.331   -0.150   hammerbacher front_beginning_of_tire
4  0.932   -0.275   hammerbacher back_beginning_of_tire 
5  0.256    1.32    hammerbacher handlebar_low          
6  0.256    1.32    hammerbacher handlebar_high         
7  0.737    0.946   hammerbacher saddle_front           
8  0.996    0.994   hammerbacher saddle_back            
9  0.695   -0.0419  hammerbacher pedals                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">dd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_old), </span>
<span id="cb7-2">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_new),</span>
<span id="cb7-3">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(hammerbacher))</span>
<span id="cb7-4"></span>
<span id="cb7-5">dd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> var_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/2023-07-23-bicycle-comparison_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(dd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bikes.csv'</span>)</span></code></pre></div>
</div>
</section>
<section id="todo" class="level2">
<h2 class="anchored" data-anchor-id="todo">Todo:</h2>
<ul>
<li>measure distance between axes</li>
<li>measure distance between</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/2023-07-23-bicycle-comparison.html</guid>
  <pubDate>Sat, 22 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>First pytorch tutorial</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-21-first-pytorch-tutorial/2023-07-21-first-pytorch-tutorial.html</link>
  <description><![CDATA[ 



<ul>
<li><a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">Link to tutorial</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'machine_learning'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nn</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datasets</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: 'dlopen(/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/image.so, 0x0006): Symbol not found: __ZN3c106detail19maybe_wrap_dim_slowIxEET_S2_S2_b
  Referenced from: &lt;8CBD0B78-6C7C-3C8B-8C76-ACA7B6112818&gt; /Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/image.so
  Expected in:     &lt;07CB8E54-8386-3606-A01E-B92223F93B74&gt; /Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torch/lib/libc10.dylib'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.transforms <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ToTensor</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download training data from open datasets.</span></span>
<span id="cb6-4">training_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datasets.FashionMNIST(</span>
<span id="cb6-5">    root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>,</span>
<span id="cb6-6">    train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-7">    download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-8">    transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor(),</span>
<span id="cb6-9">)</span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download test data from open datasets.</span></span>
<span id="cb6-12">test_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datasets.FashionMNIST(</span>
<span id="cb6-13">    root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>,</span>
<span id="cb6-14">    train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb6-15">    download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-16">    transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor(),</span>
<span id="cb6-17">)</span>
<span id="cb6-18"></span>
<span id="cb6-19"></span>
<span id="cb6-20">training_data.data.shape</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([60000, 28, 28])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">test_data.data.shape</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([10000, 28, 28])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create data loaders.</span></span>
<span id="cb10-4">train_dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(training_data, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size)</span>
<span id="cb10-5">test_dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(test_data, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size)</span>
<span id="cb10-6"></span>
<span id="cb10-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> X, y <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> test_dataloader:</span>
<span id="cb10-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Shape of X [N, C, H, W]: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>X<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Shape of y: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dtype<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of X [N, C, H, W]: torch.Size([64, 1, 28, 28])
Shape of y: torch.Size([64]) torch.int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get cpu, gpu or mps device for training.</span></span>
<span id="cb12-2">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb12-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span></span>
<span id="cb12-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available()</span>
<span id="cb12-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span></span>
<span id="cb12-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.backends.mps.is_available()</span>
<span id="cb12-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpu"</span></span>
<span id="cb12-8">)</span>
<span id="cb12-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Using </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>device<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> device"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Using mps device</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define model</span></span>
<span id="cb14-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb14-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb14-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb14-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.flatten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Flatten()</span>
<span id="cb14-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.linear_relu_stack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Sequential(</span>
<span id="cb14-7">            nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>),</span>
<span id="cb14-8">            nn.ReLU(),</span>
<span id="cb14-9">            nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>),</span>
<span id="cb14-10">            nn.ReLU(),</span>
<span id="cb14-11">            nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb14-12">        )</span>
<span id="cb14-13"></span>
<span id="cb14-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="cb14-15">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.flatten(x)</span>
<span id="cb14-16">        logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.linear_relu_stack(x)</span>
<span id="cb14-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> logits</span>
<span id="cb14-18"></span>
<span id="cb14-19">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NeuralNetwork().to(device)</span>
<span id="cb14-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NeuralNetwork(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_relu_stack): Sequential(
    (0): Linear(in_features=784, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=512, bias=True)
    (3): ReLU()
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">loss_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.CrossEntropyLoss()</span>
<span id="cb16-2">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.SGD(model.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> train(dataloader, model, loss_fn, optimizer):</span>
<span id="cb17-2">    size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader.dataset)</span>
<span id="cb17-3">    model.train()</span>
<span id="cb17-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> batch, (X, y) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(dataloader):</span>
<span id="cb17-5">        X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.to(device), y.to(device)</span>
<span id="cb17-6"></span>
<span id="cb17-7">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute prediction error</span></span>
<span id="cb17-8">        pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(X)</span>
<span id="cb17-9">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_fn(pred, y)</span>
<span id="cb17-10"></span>
<span id="cb17-11">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backpropagation</span></span>
<span id="cb17-12">        loss.backward()</span>
<span id="cb17-13">        optimizer.step()</span>
<span id="cb17-14">        optimizer.zero_grad()</span>
<span id="cb17-15"></span>
<span id="cb17-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb17-17">            loss, current <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss.item(), (batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(X)</span>
<span id="cb17-18">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;7f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">  [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>current<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;5d}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>size<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;5d}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">]"</span>)</span>
<span id="cb17-19">            </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> test(dataloader, model, loss_fn):</span>
<span id="cb18-2">    size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader.dataset)</span>
<span id="cb18-3">    num_batches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader)</span>
<span id="cb18-4">    model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb18-5">    test_loss, correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb18-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb18-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> X, y <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> dataloader:</span>
<span id="cb18-8">            X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.to(device), y.to(device)</span>
<span id="cb18-9">            pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(X)</span>
<span id="cb18-10">            test_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> loss_fn(pred, y).item()</span>
<span id="cb18-11">            correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> (pred.argmax(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>().item()</span>
<span id="cb18-12">    test_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> num_batches</span>
<span id="cb18-13">    correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> size</span>
<span id="cb18-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Test Error: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> Accuracy: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>correct)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;0.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%, Avg loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>test_loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;8f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">epochs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb19-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(epochs):</span>
<span id="cb19-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-------------------------------"</span>)</span>
<span id="cb19-4">    train(train_dataloader, model, loss_fn, optimizer)</span>
<span id="cb19-5">    test(test_dataloader, model, loss_fn)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1
-------------------------------
loss: 2.293884  [   64/60000]
loss: 2.280516  [ 6464/60000]
loss: 2.254215  [12864/60000]
loss: 2.257743  [19264/60000]
loss: 2.241249  [25664/60000]
loss: 2.206033  [32064/60000]
loss: 2.222995  [38464/60000]
loss: 2.183638  [44864/60000]
loss: 2.180845  [51264/60000]
loss: 2.147983  [57664/60000]
Test Error: 
 Accuracy: 40.3%, Avg loss: 2.137891 

Epoch 2
-------------------------------
loss: 2.147081  [   64/60000]
loss: 2.142349  [ 6464/60000]
loss: 2.073414  [12864/60000]
loss: 2.100391  [19264/60000]
loss: 2.053971  [25664/60000]
loss: 1.983526  [32064/60000]
loss: 2.020415  [38464/60000]
loss: 1.931436  [44864/60000]
loss: 1.939984  [51264/60000]
loss: 1.877790  [57664/60000]
Test Error: 
 Accuracy: 56.7%, Avg loss: 1.862921 

Epoch 3
-------------------------------
loss: 1.894928  [   64/60000]
loss: 1.875024  [ 6464/60000]
loss: 1.740222  [12864/60000]
loss: 1.794675  [19264/60000]
loss: 1.693364  [25664/60000]
loss: 1.631936  [32064/60000]
loss: 1.665979  [38464/60000]
loss: 1.550617  [44864/60000]
loss: 1.587191  [51264/60000]
loss: 1.492842  [57664/60000]
Test Error: 
 Accuracy: 60.1%, Avg loss: 1.494139 

Epoch 4
-------------------------------
loss: 1.558476  [   64/60000]
loss: 1.533684  [ 6464/60000]
loss: 1.366379  [12864/60000]
loss: 1.457518  [19264/60000]
loss: 1.342172  [25664/60000]
loss: 1.323192  [32064/60000]
loss: 1.354460  [38464/60000]
loss: 1.258602  [44864/60000]
loss: 1.304382  [51264/60000]
loss: 1.218093  [57664/60000]
Test Error: 
 Accuracy: 63.1%, Avg loss: 1.229637 

Epoch 5
-------------------------------
loss: 1.300160  [   64/60000]
loss: 1.291894  [ 6464/60000]
loss: 1.113367  [12864/60000]
loss: 1.240308  [19264/60000]
loss: 1.116215  [25664/60000]
loss: 1.128032  [32064/60000]
loss: 1.166063  [38464/60000]
loss: 1.082035  [44864/60000]
loss: 1.127863  [51264/60000]
loss: 1.062129  [57664/60000]
Test Error: 
 Accuracy: 64.9%, Avg loss: 1.068099 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Done!"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Done!</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">torch.save(model.state_dict(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.pth"</span>)</span>
<span id="cb23-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saved PyTorch Model State to model.pth"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved PyTorch Model State to model.pth</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NeuralNetwork().to(device)</span>
<span id="cb25-2">model.load_state_dict(torch.load(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.pth"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;All keys matched successfully&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">classes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb27-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-shirt/top"</span>,</span>
<span id="cb27-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trouser"</span>,</span>
<span id="cb27-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pullover"</span>,</span>
<span id="cb27-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dress"</span>,</span>
<span id="cb27-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coat"</span>,</span>
<span id="cb27-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sandal"</span>,</span>
<span id="cb27-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shirt"</span>,</span>
<span id="cb27-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sneaker"</span>,</span>
<span id="cb27-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bag"</span>,</span>
<span id="cb27-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ankle boot"</span>,</span>
<span id="cb27-12">]</span>
<span id="cb27-13"></span>
<span id="cb27-14">model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NeuralNetwork(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_relu_stack): Sequential(
    (0): Linear(in_features=784, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=512, bias=True)
    (3): ReLU()
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> test_data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], test_data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb29-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb29-3">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x.to(device)</span>
<span id="cb29-4">    pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x)</span>
<span id="cb29-5">    predicted, actual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classes[pred[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].argmax(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)], classes[y]</span>
<span id="cb29-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Predicted: "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>predicted<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">", Actual: "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>actual<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Predicted: "Ankle boot", Actual: "Ankle boot"</code></pre>
</div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-21-first-pytorch-tutorial/2023-07-21-first-pytorch-tutorial.html</guid>
  <pubDate>Thu, 20 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Starting with fastai</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-20-starting-with-fastai/2023-07-20-starting-with-fastai.html</link>
  <description><![CDATA[ 



<ul>
<li><a href="https://course.fast.ai/Resources/book.html">Link to the book</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># conda_create('machine_learning')</span></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'machine_learning'</span>)</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># conda_install('machine_learning', 'fastai')</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># conda_install('machine_learning', 'torchvision')</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># conda_install('machine_learning', 'pytorch')</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#id first_training</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#caption Results from the first training</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CLICK ME</span></span>
<span id="cb4-4"></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb4-7">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb4-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(x)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[0.7172, 0.8668, 0.7743],
        [0.0462, 0.2161, 0.4469],
        [0.2911, 0.3335, 0.2292],
        [0.1917, 0.9395, 0.4347],
        [0.9052, 0.2584, 0.6975]])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastai.vision.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: 'dlopen(/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/image.so, 0x0006): Symbol not found: __ZN3c106detail19maybe_wrap_dim_slowIxEET_S2_S2_b
  Referenced from: &lt;8CBD0B78-6C7C-3C8B-8C76-ACA7B6112818&gt; /Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/image.so
  Expected in:     &lt;07CB8E54-8386-3606-A01E-B92223F93B74&gt; /Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torch/lib/libc10.dylib'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> untar_data(URLs.PETS)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'images'</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> is_cat(x): <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].isupper()</span>
<span id="cb8-4">dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ImageDataLoaders.from_name_func(</span>
<span id="cb8-5">    path, get_image_files(path), valid_pct<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>,</span>
<span id="cb8-6">    label_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>is_cat, item_tfms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Resize(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">224</span>))</span>
<span id="cb8-7"></span>
<span id="cb8-8">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, resnet34, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>error_rate)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">learn.fine_tune(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>█
epoch     train_loss  valid_loss  error_rate  time    
█

Epoch 1/1 : |----------------------------------------| 0.00% [0/92 00:00&lt;?]

Epoch 1/1 : |----------------------------------------| 1.09% [1/92 00:05&lt;07:54]

Epoch 1/1 : |----------------------------------------| 2.17% [2/92 00:05&lt;04:20 1.4611]

Epoch 1/1 : |█---------------------------------------| 3.26% [3/92 00:06&lt;03:08 1.4571]

Epoch 1/1 : |█---------------------------------------| 4.35% [4/92 00:06&lt;02:32 1.5097]

Epoch 1/1 : |██--------------------------------------| 5.43% [5/92 00:07&lt;02:11 1.4588]

Epoch 1/1 : |██--------------------------------------| 6.52% [6/92 00:08&lt;01:56 1.4491]

Epoch 1/1 : |███-------------------------------------| 7.61% [7/92 00:08&lt;01:46 1.3571]

Epoch 1/1 : |███-------------------------------------| 8.70% [8/92 00:09&lt;01:37 1.3298]

Epoch 1/1 : |███-------------------------------------| 9.78% [9/92 00:09&lt;01:31 1.2889]

Epoch 1/1 : |████------------------------------------| 10.87% [10/92 00:10&lt;01:25 1.2722]

Epoch 1/1 : |████------------------------------------| 11.96% [11/92 00:11&lt;01:21 1.2364]

Epoch 1/1 : |█████-----------------------------------| 13.04% [12/92 00:11&lt;01:17 1.1908]

Epoch 1/1 : |█████-----------------------------------| 14.13% [13/92 00:12&lt;01:14 1.1453]

Epoch 1/1 : |██████----------------------------------| 15.22% [14/92 00:12&lt;01:11 1.1057]

Epoch 1/1 : |██████----------------------------------| 16.30% [15/92 00:13&lt;01:08 1.0928]

Epoch 1/1 : |██████----------------------------------| 17.39% [16/92 00:13&lt;01:06 1.0707]

Epoch 1/1 : |███████---------------------------------| 18.48% [17/92 00:14&lt;01:04 1.0227]

Epoch 1/1 : |███████---------------------------------| 19.57% [18/92 00:15&lt;01:02 1.0178]

Epoch 1/1 : |████████--------------------------------| 20.65% [19/92 00:15&lt;01:00 0.9841]

Epoch 1/1 : |████████--------------------------------| 21.74% [20/92 00:16&lt;00:58 0.9457]

Epoch 1/1 : |█████████-------------------------------| 22.83% [21/92 00:16&lt;00:57 0.9079]

Epoch 1/1 : |█████████-------------------------------| 23.91% [22/92 00:17&lt;00:55 0.8819]

Epoch 1/1 : |██████████------------------------------| 25.00% [23/92 00:18&lt;00:54 0.8478]

Epoch 1/1 : |██████████------------------------------| 26.09% [24/92 00:18&lt;00:52 0.8204]

Epoch 1/1 : |██████████------------------------------| 27.17% [25/92 00:19&lt;00:51 0.7875]

Epoch 1/1 : |███████████-----------------------------| 28.26% [26/92 00:19&lt;00:50 0.7594]

Epoch 1/1 : |███████████-----------------------------| 29.35% [27/92 00:20&lt;00:48 0.7458]

Epoch 1/1 : |████████████----------------------------| 30.43% [28/92 00:20&lt;00:47 0.7307]

Epoch 1/1 : |████████████----------------------------| 31.52% [29/92 00:21&lt;00:46 0.7085]

Epoch 1/1 : |█████████████---------------------------| 32.61% [30/92 00:22&lt;00:45 0.6856]

Epoch 1/1 : |█████████████---------------------------| 33.70% [31/92 00:22&lt;00:44 0.6655]

Epoch 1/1 : |█████████████---------------------------| 34.78% [32/92 00:23&lt;00:43 0.6427]

Epoch 1/1 : |██████████████--------------------------| 35.87% [33/92 00:23&lt;00:42 0.6247]

Epoch 1/1 : |██████████████--------------------------| 36.96% [34/92 00:24&lt;00:41 0.6038]

Epoch 1/1 : |███████████████-------------------------| 38.04% [35/92 00:24&lt;00:40 0.5811]

Epoch 1/1 : |███████████████-------------------------| 39.13% [36/92 00:25&lt;00:39 0.5666]

Epoch 1/1 : |████████████████------------------------| 40.22% [37/92 00:25&lt;00:38 0.5499]

Epoch 1/1 : |████████████████------------------------| 41.30% [38/92 00:26&lt;00:37 0.5333]

Epoch 1/1 : |████████████████------------------------| 42.39% [39/92 00:27&lt;00:36 0.5166]

Epoch 1/1 : |█████████████████-----------------------| 43.48% [40/92 00:27&lt;00:35 0.4998]

Epoch 1/1 : |█████████████████-----------------------| 44.57% [41/92 00:28&lt;00:35 0.4840]

Epoch 1/1 : |██████████████████----------------------| 45.65% [42/92 00:28&lt;00:34 0.4746]

Epoch 1/1 : |██████████████████----------------------| 46.74% [43/92 00:29&lt;00:33 0.4632]

Epoch 1/1 : |███████████████████---------------------| 47.83% [44/92 00:29&lt;00:32 0.4558]

Epoch 1/1 : |███████████████████---------------------| 48.91% [45/92 00:30&lt;00:31 0.4430]

Epoch 1/1 : |████████████████████--------------------| 50.00% [46/92 00:30&lt;00:30 0.4459]

Epoch 1/1 : |████████████████████--------------------| 51.09% [47/92 00:31&lt;00:30 0.4323]

Epoch 1/1 : |████████████████████--------------------| 52.17% [48/92 00:32&lt;00:29 0.4198]

Epoch 1/1 : |█████████████████████-------------------| 53.26% [49/92 00:32&lt;00:28 0.4096]

Epoch 1/1 : |█████████████████████-------------------| 54.35% [50/92 00:33&lt;00:27 0.3991]

Epoch 1/1 : |██████████████████████------------------| 55.43% [51/92 00:33&lt;00:27 0.3871]

Epoch 1/1 : |██████████████████████------------------| 56.52% [52/92 00:34&lt;00:26 0.3804]

Epoch 1/1 : |███████████████████████-----------------| 57.61% [53/92 00:34&lt;00:25 0.3694]

Epoch 1/1 : |███████████████████████-----------------| 58.70% [54/92 00:35&lt;00:24 0.3596]

Epoch 1/1 : |███████████████████████-----------------| 59.78% [55/92 00:35&lt;00:24 0.3558]

Epoch 1/1 : |████████████████████████----------------| 60.87% [56/92 00:36&lt;00:23 0.3468]

Epoch 1/1 : |████████████████████████----------------| 61.96% [57/92 00:37&lt;00:22 0.3376]

Epoch 1/1 : |█████████████████████████---------------| 63.04% [58/92 00:37&lt;00:22 0.3308]

Epoch 1/1 : |█████████████████████████---------------| 64.13% [59/92 00:38&lt;00:21 0.3219]

Epoch 1/1 : |██████████████████████████--------------| 65.22% [60/92 00:38&lt;00:20 0.3154]

Epoch 1/1 : |██████████████████████████--------------| 66.30% [61/92 00:39&lt;00:20 0.3070]

Epoch 1/1 : |██████████████████████████--------------| 67.39% [62/92 00:39&lt;00:19 0.2997]

Epoch 1/1 : |███████████████████████████-------------| 68.48% [63/92 00:40&lt;00:18 0.2921]

Epoch 1/1 : |███████████████████████████-------------| 69.57% [64/92 00:41&lt;00:17 0.2911]

Epoch 1/1 : |████████████████████████████------------| 70.65% [65/92 00:41&lt;00:17 0.2831]

Epoch 1/1 : |████████████████████████████------------| 71.74% [66/92 00:42&lt;00:16 0.2813]

Epoch 1/1 : |█████████████████████████████-----------| 72.83% [67/92 00:42&lt;00:15 0.2766]

Epoch 1/1 : |█████████████████████████████-----------| 73.91% [68/92 00:43&lt;00:15 0.2695]

Epoch 1/1 : |██████████████████████████████----------| 75.00% [69/92 00:43&lt;00:14 0.2640]

Epoch 1/1 : |██████████████████████████████----------| 76.09% [70/92 00:44&lt;00:13 0.2586]

Epoch 1/1 : |██████████████████████████████----------| 77.17% [71/92 00:44&lt;00:13 0.2522]

Epoch 1/1 : |███████████████████████████████---------| 78.26% [72/92 00:45&lt;00:12 0.2456]

Epoch 1/1 : |███████████████████████████████---------| 79.35% [73/92 00:46&lt;00:12 0.2398]

Epoch 1/1 : |████████████████████████████████--------| 80.43% [74/92 00:46&lt;00:11 0.2364]

Epoch 1/1 : |████████████████████████████████--------| 81.52% [75/92 00:47&lt;00:10 0.2304]

Epoch 1/1 : |█████████████████████████████████-------| 82.61% [76/92 00:47&lt;00:10 0.2249]

Epoch 1/1 : |█████████████████████████████████-------| 83.70% [77/92 00:48&lt;00:09 0.2200]

Epoch 1/1 : |█████████████████████████████████-------| 84.78% [78/92 00:48&lt;00:08 0.2168]

Epoch 1/1 : |██████████████████████████████████------| 85.87% [79/92 00:49&lt;00:08 0.2143]

Epoch 1/1 : |██████████████████████████████████------| 86.96% [80/92 00:50&lt;00:07 0.2101]

Epoch 1/1 : |███████████████████████████████████-----| 88.04% [81/92 00:50&lt;00:06 0.2057]

Epoch 1/1 : |███████████████████████████████████-----| 89.13% [82/92 00:51&lt;00:06 0.2008]

Epoch 1/1 : |████████████████████████████████████----| 90.22% [83/92 00:51&lt;00:05 0.1978]

Epoch 1/1 : |████████████████████████████████████----| 91.30% [84/92 00:52&lt;00:04 0.1937]

Epoch 1/1 : |████████████████████████████████████----| 92.39% [85/92 00:52&lt;00:04 0.1925]

Epoch 1/1 : |█████████████████████████████████████---| 93.48% [86/92 00:53&lt;00:03 0.1879]

Epoch 1/1 : |█████████████████████████████████████---| 94.57% [87/92 00:54&lt;00:03 0.1834]

Epoch 1/1 : |██████████████████████████████████████--| 95.65% [88/92 00:54&lt;00:02 0.1834]

Epoch 1/1 : |██████████████████████████████████████--| 96.74% [89/92 00:55&lt;00:01 0.1855]

Epoch 1/1 : |███████████████████████████████████████-| 97.83% [90/92 00:55&lt;00:01 0.1848]

Epoch 1/1 : |███████████████████████████████████████-| 98.91% [91/92 00:56&lt;00:00 0.1809]

Epoch 1/1 : |████████████████████████████████████████| 100.00% [92/92 00:56&lt;00:00 0.1839]

Epoch 1/1 :                                                                              

Epoch 1/1 :                                                                              
█

Epoch 1/1 : |----------------------------------------| 0.00% [0/24 00:00&lt;?]

Epoch 1/1 : |█---------------------------------------| 4.17% [1/24 00:00&lt;00:10]

Epoch 1/1 : |███-------------------------------------| 8.33% [2/24 00:00&lt;00:08 0.1796]

Epoch 1/1 : |█████-----------------------------------| 12.50% [3/24 00:01&lt;00:08 0.1796]

Epoch 1/1 : |██████----------------------------------| 16.67% [4/24 00:01&lt;00:07 0.1796]

Epoch 1/1 : |████████--------------------------------| 20.83% [5/24 00:01&lt;00:07 0.1796]

Epoch 1/1 : |██████████------------------------------| 25.00% [6/24 00:02&lt;00:06 0.1796]

Epoch 1/1 : |███████████-----------------------------| 29.17% [7/24 00:02&lt;00:06 0.1796]

Epoch 1/1 : |█████████████---------------------------| 33.33% [8/24 00:02&lt;00:05 0.1796]

Epoch 1/1 : |███████████████-------------------------| 37.50% [9/24 00:03&lt;00:05 0.1796]

Epoch 1/1 : |████████████████------------------------| 41.67% [10/24 00:03&lt;00:05 0.1796]

Epoch 1/1 : |██████████████████----------------------| 45.83% [11/24 00:03&lt;00:04 0.1796]

Epoch 1/1 : |████████████████████--------------------| 50.00% [12/24 00:04&lt;00:04 0.1796]

Epoch 1/1 : |█████████████████████-------------------| 54.17% [13/24 00:04&lt;00:03 0.1796]

Epoch 1/1 : |███████████████████████-----------------| 58.33% [14/24 00:05&lt;00:03 0.1796]

Epoch 1/1 : |█████████████████████████---------------| 62.50% [15/24 00:05&lt;00:03 0.1796]

Epoch 1/1 : |██████████████████████████--------------| 66.67% [16/24 00:05&lt;00:02 0.1796]

Epoch 1/1 : |████████████████████████████------------| 70.83% [17/24 00:06&lt;00:02 0.1796]

Epoch 1/1 : |██████████████████████████████----------| 75.00% [18/24 00:06&lt;00:02 0.1796]

Epoch 1/1 : |███████████████████████████████---------| 79.17% [19/24 00:06&lt;00:01 0.1796]

Epoch 1/1 : |█████████████████████████████████-------| 83.33% [20/24 00:07&lt;00:01 0.1796]

Epoch 1/1 : |███████████████████████████████████-----| 87.50% [21/24 00:07&lt;00:01 0.1796]

Epoch 1/1 : |████████████████████████████████████----| 91.67% [22/24 00:08&lt;00:00 0.1796]

Epoch 1/1 : |██████████████████████████████████████--| 95.83% [23/24 00:08&lt;00:00 0.1796]

Epoch 1/1 : |████████████████████████████████████████| 100.00% [24/24 00:08&lt;00:00 0.1796]

Epoch 1/1 :                                                                              

Epoch 1/1 :                                                                              
0         0.179568    0.032552    0.012855    01:05     
█
epoch     train_loss  valid_loss  error_rate  time    
█

Epoch 1/1 : |----------------------------------------| 0.00% [0/92 00:00&lt;?]

Epoch 1/1 : |----------------------------------------| 1.09% [1/92 00:01&lt;02:29]

Epoch 1/1 : |----------------------------------------| 2.17% [2/92 00:02&lt;01:51 0.1797]

Epoch 1/1 : |█---------------------------------------| 3.26% [3/92 00:03&lt;01:38 0.1064]

Epoch 1/1 : |█---------------------------------------| 4.35% [4/92 00:04&lt;01:30 0.0731]

Epoch 1/1 : |██--------------------------------------| 5.43% [5/92 00:04&lt;01:26 0.0828]

Epoch 1/1 : |██--------------------------------------| 6.52% [6/92 00:05&lt;01:22 0.0750]

Epoch 1/1 : |███-------------------------------------| 7.61% [7/92 00:06&lt;01:20 0.0639]

Epoch 1/1 : |███-------------------------------------| 8.70% [8/92 00:07&lt;01:17 0.0550]

Epoch 1/1 : |███-------------------------------------| 9.78% [9/92 00:08&lt;01:16 0.0483]

Epoch 1/1 : |████------------------------------------| 10.87% [10/92 00:09&lt;01:14 0.0460]

Epoch 1/1 : |████------------------------------------| 11.96% [11/92 00:09&lt;01:13 0.0580]

Epoch 1/1 : |█████-----------------------------------| 13.04% [12/92 00:10&lt;01:11 0.0529]

Epoch 1/1 : |█████-----------------------------------| 14.13% [13/92 00:11&lt;01:10 0.0525]

Epoch 1/1 : |██████----------------------------------| 15.22% [14/92 00:12&lt;01:09 0.0680]

Epoch 1/1 : |██████----------------------------------| 16.30% [15/92 00:13&lt;01:07 0.0632]

Epoch 1/1 : |██████----------------------------------| 17.39% [16/92 00:14&lt;01:06 0.0612]

Epoch 1/1 : |███████---------------------------------| 18.48% [17/92 00:14&lt;01:05 0.0966]

Epoch 1/1 : |███████---------------------------------| 19.57% [18/92 00:15&lt;01:04 0.0946]

Epoch 1/1 : |████████--------------------------------| 20.65% [19/92 00:16&lt;01:03 0.0967]

Epoch 1/1 : |████████--------------------------------| 21.74% [20/92 00:17&lt;01:02 0.1005]

Epoch 1/1 : |█████████-------------------------------| 22.83% [21/92 00:18&lt;01:01 0.0976]

Epoch 1/1 : |█████████-------------------------------| 23.91% [22/92 00:19&lt;01:00 0.0920]

Epoch 1/1 : |██████████------------------------------| 25.00% [23/92 00:19&lt;00:59 0.0877]

Epoch 1/1 : |██████████------------------------------| 26.09% [24/92 00:20&lt;00:58 0.0830]

Epoch 1/1 : |██████████------------------------------| 27.17% [25/92 00:21&lt;00:57 0.0832]

Epoch 1/1 : |███████████-----------------------------| 28.26% [26/92 00:22&lt;00:56 0.0834]

Epoch 1/1 : |███████████-----------------------------| 29.35% [27/92 00:23&lt;00:56 0.0868]

Epoch 1/1 : |████████████----------------------------| 30.43% [28/92 00:24&lt;00:55 0.0931]

Epoch 1/1 : |████████████----------------------------| 31.52% [29/92 00:24&lt;00:54 0.0893]

Epoch 1/1 : |█████████████---------------------------| 32.61% [30/92 00:25&lt;00:53 0.0865]

Epoch 1/1 : |█████████████---------------------------| 33.70% [31/92 00:26&lt;00:52 0.0861]

Epoch 1/1 : |█████████████---------------------------| 34.78% [32/92 00:27&lt;00:51 0.0888]

Epoch 1/1 : |██████████████--------------------------| 35.87% [33/92 00:28&lt;00:50 0.0852]

Epoch 1/1 : |██████████████--------------------------| 36.96% [34/92 00:29&lt;00:49 0.0883]

Epoch 1/1 : |███████████████-------------------------| 38.04% [35/92 00:29&lt;00:48 0.0849]

Epoch 1/1 : |███████████████-------------------------| 39.13% [36/92 00:30&lt;00:47 0.0865]

Epoch 1/1 : |████████████████------------------------| 40.22% [37/92 00:31&lt;00:47 0.0887]

Epoch 1/1 : |████████████████------------------------| 41.30% [38/92 00:32&lt;00:46 0.0949]

Epoch 1/1 : |████████████████------------------------| 42.39% [39/92 00:33&lt;00:45 0.0992]

Epoch 1/1 : |█████████████████-----------------------| 43.48% [40/92 00:34&lt;00:44 0.0956]

Epoch 1/1 : |█████████████████-----------------------| 44.57% [41/92 00:34&lt;00:43 0.0950]

Epoch 1/1 : |██████████████████----------------------| 45.65% [42/92 00:35&lt;00:42 0.0925]

Epoch 1/1 : |██████████████████----------------------| 46.74% [43/92 00:36&lt;00:41 0.0915]

Epoch 1/1 : |███████████████████---------------------| 47.83% [44/92 00:37&lt;00:40 0.0920]

Epoch 1/1 : |███████████████████---------------------| 48.91% [45/92 00:38&lt;00:39 0.0902]

Epoch 1/1 : |████████████████████--------------------| 50.00% [46/92 00:39&lt;00:39 0.0919]

Epoch 1/1 : |████████████████████--------------------| 51.09% [47/92 00:39&lt;00:38 0.1026]

Epoch 1/1 : |████████████████████--------------------| 52.17% [48/92 00:40&lt;00:37 0.1011]

Epoch 1/1 : |█████████████████████-------------------| 53.26% [49/92 00:41&lt;00:36 0.0981]

Epoch 1/1 : |█████████████████████-------------------| 54.35% [50/92 00:42&lt;00:35 0.1058]

Epoch 1/1 : |██████████████████████------------------| 55.43% [51/92 00:43&lt;00:34 0.1025]

Epoch 1/1 : |██████████████████████------------------| 56.52% [52/92 00:44&lt;00:33 0.1030]

Epoch 1/1 : |███████████████████████-----------------| 57.61% [53/92 00:44&lt;00:33 0.1020]

Epoch 1/1 : |███████████████████████-----------------| 58.70% [54/92 00:45&lt;00:32 0.1046]

Epoch 1/1 : |███████████████████████-----------------| 59.78% [55/92 00:46&lt;00:31 0.1033]

Epoch 1/1 : |████████████████████████----------------| 60.87% [56/92 00:47&lt;00:30 0.1014]

Epoch 1/1 : |████████████████████████----------------| 61.96% [57/92 00:48&lt;00:29 0.0984]

Epoch 1/1 : |█████████████████████████---------------| 63.04% [58/92 00:49&lt;00:28 0.0960]

Epoch 1/1 : |█████████████████████████---------------| 64.13% [59/92 00:49&lt;00:27 0.0944]

Epoch 1/1 : |██████████████████████████--------------| 65.22% [60/92 00:50&lt;00:27 0.0969]

Epoch 1/1 : |██████████████████████████--------------| 66.30% [61/92 00:51&lt;00:26 0.0946]

Epoch 1/1 : |██████████████████████████--------------| 67.39% [62/92 00:52&lt;00:25 0.0945]

Epoch 1/1 : |███████████████████████████-------------| 68.48% [63/92 00:53&lt;00:24 0.0930]

Epoch 1/1 : |███████████████████████████-------------| 69.57% [64/92 00:54&lt;00:23 0.0931]

Epoch 1/1 : |████████████████████████████------------| 70.65% [65/92 00:54&lt;00:22 0.0908]

Epoch 1/1 : |████████████████████████████------------| 71.74% [66/92 00:55&lt;00:21 0.0884]

Epoch 1/1 : |█████████████████████████████-----------| 72.83% [67/92 00:56&lt;00:21 0.0871]

Epoch 1/1 : |█████████████████████████████-----------| 73.91% [68/92 00:57&lt;00:20 0.0861]

Epoch 1/1 : |██████████████████████████████----------| 75.00% [69/92 00:58&lt;00:19 0.0839]

Epoch 1/1 : |██████████████████████████████----------| 76.09% [70/92 00:59&lt;00:18 0.0831]

Epoch 1/1 : |██████████████████████████████----------| 77.17% [71/92 01:00&lt;00:17 0.0838]

Epoch 1/1 : |███████████████████████████████---------| 78.26% [72/92 01:00&lt;00:16 0.0848]

Epoch 1/1 : |███████████████████████████████---------| 79.35% [73/92 01:01&lt;00:16 0.0865]

Epoch 1/1 : |████████████████████████████████--------| 80.43% [74/92 01:02&lt;00:15 0.0885]

Epoch 1/1 : |████████████████████████████████--------| 81.52% [75/92 01:03&lt;00:14 0.0864]

Epoch 1/1 : |█████████████████████████████████-------| 82.61% [76/92 01:04&lt;00:13 0.0872]

Epoch 1/1 : |█████████████████████████████████-------| 83.70% [77/92 01:05&lt;00:12 0.0859]

Epoch 1/1 : |█████████████████████████████████-------| 84.78% [78/92 01:06&lt;00:11 0.0837]

Epoch 1/1 : |██████████████████████████████████------| 85.87% [79/92 01:07&lt;00:11 0.0838]

Epoch 1/1 : |██████████████████████████████████------| 86.96% [80/92 01:07&lt;00:10 0.0828]

Epoch 1/1 : |███████████████████████████████████-----| 88.04% [81/92 01:08&lt;00:09 0.0814]

Epoch 1/1 : |███████████████████████████████████-----| 89.13% [82/92 01:09&lt;00:08 0.0795]

Epoch 1/1 : |████████████████████████████████████----| 90.22% [83/92 01:10&lt;00:07 0.0776]

Epoch 1/1 : |████████████████████████████████████----| 91.30% [84/92 01:11&lt;00:06 0.0795]

Epoch 1/1 : |████████████████████████████████████----| 92.39% [85/92 01:12&lt;00:05 0.0781]

Epoch 1/1 : |█████████████████████████████████████---| 93.48% [86/92 01:13&lt;00:05 0.0765]

Epoch 1/1 : |█████████████████████████████████████---| 94.57% [87/92 01:13&lt;00:04 0.0749]

Epoch 1/1 : |██████████████████████████████████████--| 95.65% [88/92 01:14&lt;00:03 0.0731]

Epoch 1/1 : |██████████████████████████████████████--| 96.74% [89/92 01:15&lt;00:02 0.0732]

Epoch 1/1 : |███████████████████████████████████████-| 97.83% [90/92 01:16&lt;00:01 0.0729]

Epoch 1/1 : |███████████████████████████████████████-| 98.91% [91/92 01:17&lt;00:00 0.0712]

Epoch 1/1 : |████████████████████████████████████████| 100.00% [92/92 01:18&lt;00:00 0.0702]

Epoch 1/1 :                                                                              

Epoch 1/1 :                                                                              
█

Epoch 1/1 : |----------------------------------------| 0.00% [0/24 00:00&lt;?]

Epoch 1/1 : |█---------------------------------------| 4.17% [1/24 00:00&lt;00:08]

Epoch 1/1 : |███-------------------------------------| 8.33% [2/24 00:00&lt;00:08 0.0691]

Epoch 1/1 : |█████-----------------------------------| 12.50% [3/24 00:01&lt;00:07 0.0691]

Epoch 1/1 : |██████----------------------------------| 16.67% [4/24 00:01&lt;00:07 0.0691]

Epoch 1/1 : |████████--------------------------------| 20.83% [5/24 00:01&lt;00:07 0.0691]

Epoch 1/1 : |██████████------------------------------| 25.00% [6/24 00:02&lt;00:06 0.0691]

Epoch 1/1 : |███████████-----------------------------| 29.17% [7/24 00:02&lt;00:06 0.0691]

Epoch 1/1 : |█████████████---------------------------| 33.33% [8/24 00:02&lt;00:05 0.0691]

Epoch 1/1 : |███████████████-------------------------| 37.50% [9/24 00:03&lt;00:05 0.0691]

Epoch 1/1 : |████████████████------------------------| 41.67% [10/24 00:03&lt;00:05 0.0691]

Epoch 1/1 : |██████████████████----------------------| 45.83% [11/24 00:03&lt;00:04 0.0691]

Epoch 1/1 : |████████████████████--------------------| 50.00% [12/24 00:04&lt;00:04 0.0691]

Epoch 1/1 : |█████████████████████-------------------| 54.17% [13/24 00:04&lt;00:04 0.0691]

Epoch 1/1 : |███████████████████████-----------------| 58.33% [14/24 00:05&lt;00:03 0.0691]

Epoch 1/1 : |█████████████████████████---------------| 62.50% [15/24 00:05&lt;00:03 0.0691]

Epoch 1/1 : |██████████████████████████--------------| 66.67% [16/24 00:05&lt;00:02 0.0691]

Epoch 1/1 : |████████████████████████████------------| 70.83% [17/24 00:06&lt;00:02 0.0691]

Epoch 1/1 : |██████████████████████████████----------| 75.00% [18/24 00:06&lt;00:02 0.0691]

Epoch 1/1 : |███████████████████████████████---------| 79.17% [19/24 00:07&lt;00:01 0.0691]

Epoch 1/1 : |█████████████████████████████████-------| 83.33% [20/24 00:07&lt;00:01 0.0691]

Epoch 1/1 : |███████████████████████████████████-----| 87.50% [21/24 00:07&lt;00:01 0.0691]

Epoch 1/1 : |████████████████████████████████████----| 91.67% [22/24 00:08&lt;00:00 0.0691]

Epoch 1/1 : |██████████████████████████████████████--| 95.83% [23/24 00:08&lt;00:00 0.0691]

Epoch 1/1 : |████████████████████████████████████████| 100.00% [24/24 00:08&lt;00:00 0.0691]

Epoch 1/1 :                                                                              

Epoch 1/1 :                                                                              
0         0.069070    0.013186    0.004736    01:26     </code></pre>
</div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-20-starting-with-fastai/2023-07-20-starting-with-fastai.html</guid>
  <pubDate>Wed, 19 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>The iris dataset</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset.html</link>
  <description><![CDATA[ 



<section id="init" class="level2">
<h2 class="anchored" data-anchor-id="init">Init</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lme4'</span>)</span></code></pre></div>
</div>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data preparation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">iris_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(iris)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Species, id), </span>
<span id="cb2-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Variable'</span>, </span>
<span id="cb2-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Value'</span>)</span></code></pre></div>
</div>
</section>
<section id="plots" class="level2">
<h2 class="anchored" data-anchor-id="plots">Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">iris_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Variable, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Species)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_plots-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last_plot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>() </span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_plots-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">iris_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Variable, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Species)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_plots-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last_plot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>() </span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_plots-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="models" class="level2">
<h2 class="anchored" data-anchor-id="models">Models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">fitted_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Variable, </span>
<span id="cb7-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris_long)</span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fitted_model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Value
                  Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Species            2  309.61  154.80 1019.34 &lt; 2.2e-16 ***
Variable           3 1656.26  552.09 3635.35 &lt; 2.2e-16 ***
Species:Variable   6  282.47   47.08  309.99 &lt; 2.2e-16 ***
Residuals        588   89.30    0.15                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(fitted_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> iris_long<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Species)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">fitted_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(Value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Variable, </span>
<span id="cb10-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris_long)</span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(fitted_model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: log(Value)
                  Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Species            2  90.843  45.421 1772.90 &lt; 2.2e-16 ***
Variable           3 297.393  99.131 3869.31 &lt; 2.2e-16 ***
Species:Variable   6  95.977  15.996  624.37 &lt; 2.2e-16 ***
Residuals        588  15.064   0.026                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(fitted_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> iris_long<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Species)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset_files/figure-html/iris_models-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">fitted_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(Value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Variable <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id),</span>
<span id="cb13-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris_long)</span>
<span id="cb13-4">fitted_model</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: log(Value) ~ Species * Variable + (1 | id)
   Data: iris_long
REML criterion at convergence: -496.6563
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 0.08565 
 Residual             0.13522 
Number of obs: 600, groups:  id, 150
Fixed Effects:
                           (Intercept)                       Speciesversicolor  
                                0.3728                                  1.0702  
                      Speciesvirginica                     VariablePetal.Width  
                                1.3367                                 -1.8574  
                  VariableSepal.Length                     VariableSepal.Width  
                                1.2354                                  0.8531  
 Speciesversicolor:VariablePetal.Width    Speciesvirginica:VariablePetal.Width  
                                0.6854                                  0.8447  
Speciesversicolor:VariableSepal.Length   Speciesvirginica:VariableSepal.Length  
                               -0.9011                                 -1.0642  
 Speciesversicolor:VariableSepal.Width    Speciesvirginica:VariableSepal.Width  
                               -1.2837                                 -1.4783  </code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>In general, I like the log scale modeling - however there is a problem with the model on log scale
<ul>
<li>Effects can be given as fold-changes - this seems to make sense to me</li>
<li>Species “setosa” is not fitted adequately on log scale - probably measurement error is not adequately modeled on log scale - higher variance of error on log scale</li>
</ul></li>
<li>Dependence on individual level is not considered in the plain linear model
<ul>
<li>Linear mixed model should be considered!!!</li>
</ul></li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-12-the-iris-dataset/2023-07-12-the-iris-dataset.html</guid>
  <pubDate>Tue, 11 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Easier publishing</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-12-easier-publishing/2023-07-12-easier-publishing.html</link>
  <description><![CDATA[ 



<ul>
<li>File “/usr/local/bin/pq”:</li>
</ul>
<pre><code>#!   /bin/bash -e
quarto render
git add .
git commit -m "some changes"
git push</code></pre>
<ul>
<li>chmod +x /usr/local/bin/pq</li>
</ul>



 ]]></description>
  <category>Quarto</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-12-easier-publishing/2023-07-12-easier-publishing.html</guid>
  <pubDate>Tue, 11 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Model diagnostics for logistic regression</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression.html</link>
  <description><![CDATA[ 



<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'faraway'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-2">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n), </span>
<span id="cb2-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n),</span>
<span id="cb2-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n),)</span>
<span id="cb2-5"></span>
<span id="cb2-6">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb2-7">beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(X))</span>
<span id="cb2-8"></span>
<span id="cb2-9"></span>
<span id="cb2-10"></span>
<span id="cb2-11">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu =</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> beta,</span>
<span id="cb2-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plogis</span>(mu),</span>
<span id="cb2-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">result =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbinom</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, p))</span>
<span id="cb2-15"></span>
<span id="cb2-16">fitted_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(result <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>())</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(fitted_model)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prplot</span>(fitted_model, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prplot</span>(fitted_model, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prplot</span>(fitted_model, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression_files/figure-html/unnamed-chunk-2-7.png" class="img-fluid" width="672"></p>
</div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-12-model-diagnostics-for-logistic-regression/2023-07-12-model-diagnostics-for-logistic-regression.html</guid>
  <pubDate>Tue, 11 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Pie chart</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-12-pie-chart/2023-07-12-pie-chart.html</link>
  <description><![CDATA[ 



<p>To build a simple pie chart:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-4"></span>
<span id="cb1-5">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>),</span>
<span id="cb1-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> value),</span>
<span id="cb1-12">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_stack</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid  =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-12-pie-chart/2023-07-12-pie-chart_files/figure-html/init-1.png" class="img-fluid" width="672"></p>
</div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-12-pie-chart/2023-07-12-pie-chart.html</guid>
  <pubDate>Tue, 11 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Ideas for new posts</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-10-ideas-for-new-posts/2023-07-10-ideas-for-new-posts.html</link>
  <description><![CDATA[ 



<section id="ai-and-radiologist---evolution-of-a-team" class="level2">
<h2 class="anchored" data-anchor-id="ai-and-radiologist---evolution-of-a-team">AI and radiologist - evolution of a team</h2>
</section>
<section id="longtermism" class="level2">
<h2 class="anchored" data-anchor-id="longtermism">Longtermism</h2>
<ul>
<li>Despite my scepticisms about the notion of longtermism I want to think about it a little</li>
<li>Idea: create a model in which proximity and number of people are balanced</li>
<li>“Love thy neighbor as thyself.”</li>
</ul>
</section>
<section id="track-changes-in-quarto" class="level2">
<h2 class="anchored" data-anchor-id="track-changes-in-quarto">Track changes in quarto</h2>
<ul>
<li>Scenario: A has written something, B suggests changes and provides comments</li>
<li>File is given from A to B</li>
<li>B just edits as he / she wishes
<ul>
<li>Comments can be made</li>
<li>possibility to render with changes tracked on a per-word basis</li>
</ul></li>
<li>B returns the file to A</li>
<li>A can look at the rendered changes with the comments
<ul>
<li>comments and changes are numbered</li>
</ul></li>
<li>A is provided with a file, in which for each change / comment it can be indicated:
<ul>
<li>accept</li>
<li>decline</li>
<li>edit manually (a hint is included in the quarto file) -&gt; or the whole line could be given in a new version</li>
</ul></li>
<li>How can feedback be given from A to B which changes are accepted etc. for a discussion?</li>
</ul>


</section>

 ]]></description>
  <category>Mishmash</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-10-ideas-for-new-posts/2023-07-10-ideas-for-new-posts.html</guid>
  <pubDate>Sun, 09 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Managing python versions in RStudio</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-06-python-versions-environments/2023-07-06-python-versions-environments.html</link>
  <description><![CDATA[ 



<section id="ressources" class="level2">
<h2 class="anchored" data-anchor-id="ressources">Ressources</h2>
<ul>
<li>Good resources are found in the {reticulate} vignettes: <a href="https://cran.r-project.org/web/packages/reticulate/index.html">Link</a>, in particular <a href="https://cran.r-project.org/web/packages/reticulate/vignettes/versions.html">this</a></li>
<li>Link to question on stackoverflow - <a href="https://stackoverflow.com/questions/76745347/how-to-make-quarto-use-the-same-python-environment-that-was-specified-in-rstudio">Link</a></li>
</ul>
</section>
<section id="managing-python-installation" class="level2">
<h2 class="anchored" data-anchor-id="managing-python-installation">Managing python installation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_discover_config</span>()</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_config</span>()</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_list</span>()</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_version</span>()</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_create</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>)</span>
<span id="cb1-8"></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pandas'</span>)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniconda_update</span>()</span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>)</span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plotly'</span>)</span>
<span id="cb1-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'base'</span>)</span></code></pre></div>
</div>
</section>
<section id="install-virtual-environments-to-jupyter" class="level2">
<h2 class="anchored" data-anchor-id="install-virtual-environments-to-jupyter">Install virtual environments to jupyter</h2>
<ul>
<li><a href="https://janakiev.com/blog/jupyter-virtual-envs/">Link</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare python to enable installation of virtual environments in Jupyter:</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--user</span> ipykernel</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show conda environments and activate:</span></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> info <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envs</span>  </span>
<span id="cb2-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate sbloggel</span>
<span id="cb2-7"></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install virtual environment into jupyter:</span></span>
<span id="cb2-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ipykernel install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--user</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sbloggel</span>
<span id="cb2-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate /Users/seb/Library/r-miniconda-arm64/envs/sbloggel  </span></code></pre></div>
</div>
<p>Start Jupyter from terminal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">jupyter</span> notebook</span></code></pre></div>
</div>
</section>
<section id="installing-tensorflow_decision_forests" class="level2">
<h2 class="anchored" data-anchor-id="installing-tensorflow_decision_forests">Installing tensorflow_decision_forests</h2>
<ul>
<li>I couldn’t install it via conda, so I created a new environment and installed it via pip (this seems also to be the recommended way on the tensorflow website):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_create</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">python_version =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3.11'</span>)</span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>)</span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow_decision_forests'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pandas'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'matplotlib'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'seaborn'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'IPython'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_version</span>()</span></code></pre></div>
</div>
</section>
<section id="installing-environment---rebuild-sbloggel" class="level2">
<h2 class="anchored" data-anchor-id="installing-environment---rebuild-sbloggel">Installing environment - rebuild sbloggel</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_create</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">python_version =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3.11'</span>)</span>
<span id="cb5-3">packages_to_install <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pandas'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'matplotlib'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'seaborn'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plotly'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'statsmodels'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'scipy'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'scikit-learn'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pytorch'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'torchvision'</span>)</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conda_install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>, packages_to_install)</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>)</span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_version</span>()</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb6-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> fastai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> fa</span>
<span id="cb6-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb6-5">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb6-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span></span>
<span id="cb6-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available()</span>
<span id="cb6-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span></span>
<span id="cb6-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.backends.mps.is_available()</span>
<span id="cb6-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpu"</span></span>
<span id="cb6-11">)</span>
<span id="cb6-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Using </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>device<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> device"</span>)</span></code></pre></div>
</div>


</section>

 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-06-python-versions-environments/2023-07-06-python-versions-environments.html</guid>
  <pubDate>Tue, 04 Jul 2023 22:00:00 GMT</pubDate>
</item>
</channel>
</rss>
