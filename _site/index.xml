<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Seb&#39;s blog</title>
<link>https://sbloggel.netlify.app/index.html</link>
<atom:link href="https://sbloggel.netlify.app/index.xml" rel="self" type="application/rss+xml"/>
<description>Seb&#39;s private blog about statistics and other topics</description>
<generator>quarto-1.3.433</generator>
<lastBuildDate>Sun, 24 Sep 2023 22:00:00 GMT</lastBuildDate>
<item>
  <title>Subfigures in quarto</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto.html</link>
  <description><![CDATA[ 



<section id="option-1" class="level2">
<h2 class="anchored" data-anchor-id="option-1">Option 1</h2>
<p>Quelle: <a href="https://quarto.org/docs/authoring/figures.html">Link</a></p>
<div id="fig-elephants" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div id="fig-test-left" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-test-left-1.png" class="img-fluid figure-img" data-ref-parent="fig-elephants" width="288"></p>
<figcaption class="figure-caption">(a) This is a test</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div id="fig-test-right" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-test-right-1.png" class="img-fluid figure-img" data-ref-parent="fig-elephants" width="288"></p>
<figcaption class="figure-caption">(b) This is another test</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="cell-output-display">
<div id="fig-test-bottom" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-test-bottom-1.png" class="img-fluid figure-img" data-ref-parent="fig-elephants" width="576"></p>
<figcaption class="figure-caption">(c) And yet a third test</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Famous Elephants</figcaption><p></p>
</figure>
</div>
<p>Figure&nbsp;1</p>
<p>Figure&nbsp;1 (a)</p>
<p>Figure&nbsp;1 (b)</p>
<p>Figure&nbsp;1 (c)</p>
</section>
<section id="option-2" class="level2">
<h2 class="anchored" data-anchor-id="option-2">Option 2</h2>
<ul>
<li>Source: <a href="https://quarto.org/docs/authoring/figures.html#computations">Link</a></li>
</ul>
<div id="fig-charts" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-charts-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-charts-1.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(a) First</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-charts-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-charts-2.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(b) Second</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-charts-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-charts-3.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(c) Third</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Charts</figcaption><p></p>
</figure>
</div>
<p>Figure&nbsp;2</p>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto.html</guid>
  <pubDate>Sun, 24 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Testing Observable</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-25-testing-observable/2023-09-25-testing-observable.html</link>
  <description><![CDATA[ 



<section id="plot-1" class="level2">
<h2 class="anchored" data-anchor-id="plot-1">Plot 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(iris)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.…
$ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
$ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.…
$ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
$ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(iris)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">iris_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> iris<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Species, </span>
<span id="cb7-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sepal_length =</span> iris<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Sepal.Length,</span>
<span id="cb7-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sepal_width =</span> iris<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Sepal.Width)</span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(iris_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'iris.csv'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-startfrom="20" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 19;"><span id="cb8-20">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FileAttachment</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iris.csv"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">csv</span>({ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">typed</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">true</span> })</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-startfrom="25" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 24;"><span id="cb9-25">viewof sepal_length_min <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(</span>
<span id="cb9-26">  [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb9-27">  {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal length min:"</span>}</span>
<span id="cb9-28">)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-startfrom="32" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 31;"><span id="cb10-32">filtered <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(iris) {</span>
<span id="cb10-33">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sepal_length_min <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> iris<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sepal_length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb10-34">})</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-startfrom="38" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 37;"><span id="cb11-38">Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rectY</span>(filtered<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb11-39">  Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binX</span>(</span>
<span id="cb11-40">    {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb11-41">    {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sepal_length"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">fill</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>}</span>
<span id="cb11-42">  ))</span>
<span id="cb11-43">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>({</span>
<span id="cb11-44">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">facet</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb11-45">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> filtered<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-46">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-47">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sepal_length"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-48">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">marginRight</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb11-49">    }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-50">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">marks</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> [</span>
<span id="cb11-51">      Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">frame</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-52">    ]</span>
<span id="cb11-53">  }</span>
<span id="cb11-54">)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
</section>
<section id="plot-2" class="level2">
<h2 class="anchored" data-anchor-id="plot-2">Plot 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-startfrom="59" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 58;"><span id="cb12-59">Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>({</span>
<span id="cb12-60">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">marks</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> [</span>
<span id="cb12-61">    Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(penguins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_length_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_depth_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// try changing "stroke" to "fill"</span></span>
<span id="cb12-62">    Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">linearRegressionY</span>(penguins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_length_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_depth_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>})</span>
<span id="cb12-63">  ]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb12-64">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">ariaLabel</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Penguin culmen dimensions"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb12-65">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">ariaDescription</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scatterplot of culmen length by culmen depth for three penguin species. Linear trendlines are added to each, revealing similar positive linear trends between culmen length and depth for chinstrap, gentoo and Adelie penguins."</span></span>
<span id="cb12-66">})</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>


</section>

 ]]></description>
  <category>Observable</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-25-testing-observable/2023-09-25-testing-observable.html</guid>
  <pubDate>Sun, 24 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>SVM code example</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-12-svm-code-example/2023-09-12-svm-code-example.html</link>
  <description><![CDATA[ 



<p>Inspired from <a href="https://www.spsanderson.com/steveondata/posts/2023-09-11/index.html">this</a> blog post.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'e1071'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">ir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_setosa =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(Species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'setosa'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Yes'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'No'</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Species, Sepal.Length, Petal.Length))</span>
<span id="cb2-4"></span>
<span id="cb2-5">ir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(ir)</span>
<span id="cb2-6"></span>
<span id="cb2-7">fm_svm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">svm</span>(is_setosa <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ir)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(fm_svm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ir)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-12-svm-code-example/2023-09-12-svm-code-example_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>



 ]]></description>
  <category>R</category>
  <category>Self-study</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-12-svm-code-example/2023-09-12-svm-code-example.html</guid>
  <pubDate>Mon, 11 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Algorithmic study design – possible approaches</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-07-algorithmic-study-design-possible-concepts/2023-09-07-algorithmic-study-design-possible-concepts.html</link>
  <description><![CDATA[ 



<section id="possible-concepts" class="level2">
<h2 class="anchored" data-anchor-id="possible-concepts">Possible concepts:</h2>
<ul>
<li>Model of research environment (e. g. university hospital) and simulate a lot of studies in this environment</li>
<li>Continue Elena’s work</li>
<li>Use clinicaltrials.gov data set as training dataset for neural net</li>
<li>Simulate a lot of studies in <a href="../../posts/2023-08-21-algorithmic-study-design----white-paper/2023-08-21-algorithmic-study-design----white-paper.html">this</a> manner</li>
</ul>
</section>
<section id="further-ideas" class="level2">
<h2 class="anchored" data-anchor-id="further-ideas">Further ideas:</h2>
<ul>
<li>We could start with a descriptive analysis of the clinicaltrials.gov database</li>
<li>There are some older papers
<ul>
<li><a href="https://scholar.google.com/scholar?hl=de&amp;as_sdt=0%2C5&amp;q=clinicaltrials+database&amp;btnG=">Overview at google scholar</a></li>
<li><a href="https://jamanetwork.com/journals/jama/article-abstract/1150093">Characteristics of Clinical Trials Registered in ClinicalTrials.gov, 2007-2010</a></li>
<li><a href="https://www.bmj.com/content/361/bmj.k1452.abstract">How to avoid common problems when using ClinicalTrials.gov in research: 10 issues to consider - BMJ 2018</a></li>
</ul></li>
</ul>


</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-07-algorithmic-study-design-possible-concepts/2023-09-07-algorithmic-study-design-possible-concepts.html</guid>
  <pubDate>Wed, 06 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Tensorflow Decision Forests</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-28-tensorflow-decision-forests-/2023-08-28-tensorflow-decision-forests-.html</link>
  <description><![CDATA[ 



<ul>
<li>Source</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensorflow_decision_forests <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tfdf</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensorflow <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tf</span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb2-8"></span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Found TensorFlow Decision Forests v"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> tfdf.__version__)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the dataset</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !wget -q https://storage.googleapis.com/download.tensorflow.org/data/palmer_penguins/penguins.csv -O /tmp/penguins.csv</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load a dataset into a Pandas Dataframe.</span></span>
<span id="cb2-16">dataset_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/tmp/penguins.csv"</span>)</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the first 3 examples.</span></span>
<span id="cb2-19">dataset_df.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-20"></span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encode the categorical labels as integers.</span></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Details:</span></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This stage is necessary if your classification label is represented as a</span></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># string since Keras expects integer classification labels.</span></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># When using `pd_dataframe_to_tf_dataset` (see below), this step can be skipped.</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name of the label column.</span></span>
<span id="cb2-30">label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32">classes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset_df[label].unique().tolist()</span>
<span id="cb2-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Label classes: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>classes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-34"></span>
<span id="cb2-35">dataset_df[label] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset_df[label].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(classes.index)</span>
<span id="cb2-36"></span>
<span id="cb2-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the dataset into a training and a testing dataset.</span></span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> split_dataset(dataset, test_ratio<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.30</span>):</span>
<span id="cb2-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Splits a panda dataframe in two."""</span></span>
<span id="cb2-41">  test_indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.rand(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataset)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> test_ratio</span>
<span id="cb2-42">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> dataset[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>test_indices], dataset[test_indices]</span>
<span id="cb2-43"></span>
<span id="cb2-44"></span>
<span id="cb2-45">train_ds_pd, test_ds_pd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> split_dataset(dataset_df)</span>
<span id="cb2-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> examples in training, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> examples for testing."</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(</span>
<span id="cb2-47">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(train_ds_pd), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(test_ds_pd)))</span>
<span id="cb2-48"></span>
<span id="cb2-49"></span>
<span id="cb2-50">train_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.pd_dataframe_to_tf_dataset(train_ds_pd, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label)</span>
<span id="cb2-51">test_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.pd_dataframe_to_tf_dataset(test_ds_pd, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label)</span>
<span id="cb2-52"></span>
<span id="cb2-53"></span>
<span id="cb2-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># %set_cell_height 300</span></span>
<span id="cb2-55"></span>
<span id="cb2-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Specify the model.</span></span>
<span id="cb2-57">model_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.RandomForestModel(verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train the model.</span></span>
<span id="cb2-60">model_1.fit(train_ds)</span>
<span id="cb2-61"></span>
<span id="cb2-62"></span>
<span id="cb2-63">model_1.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>])</span>
<span id="cb2-64">evaluation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_1.evaluate(test_ds, return_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-65"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>()</span>
<span id="cb2-66"></span>
<span id="cb2-67"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> name, value <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> evaluation.items():</span>
<span id="cb2-68">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>value<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-69"></span>
<span id="cb2-70"></span>
<span id="cb2-71">tfdf.model_plotter.plot_model_in_colab(model_1, tree_idx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, max_depth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-28-tensorflow-decision-forests-/2023-08-28-tensorflow-decision-forests-.html</guid>
  <pubDate>Sun, 27 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Two-Way-ANOVA with and without interaction vs. individual t-tests</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Often, the effect of different interventions is to be studied. This can be done by comparing individual sets of interventions (e. g. drug A vs.&nbsp;placebo and drug B vs.&nbsp;placebo) or in a factorial design (e. g. ANOVA). For individual comparisons statistical tests such as the t-test can be appropriate. Importantly, correction for multiple testing should to be carried out. The effect of combination of several drugs can be studied easily in the factorial design, while it is more complicated via t-tests.</p>
<p>Here, it is studied if ANOVA analysis with subsequent joint testing of the relevant hypotheses offers advantages in terms of required sample size / statistical power in comparison to analysis via separate t-tests for some configurations.</p>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-1_19c4a0b3c1507c45dbbe01ffcf3c3a4f">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multcomp'</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span></code></pre></div>
</div>
</section>
<section id="simulation-model" class="level2">
<h2 class="anchored" data-anchor-id="simulation-model">Simulation model</h2>
<ul>
<li>Normally distributed data</li>
<li>Two-way factorial design
<ul>
<li>Factor <code>F1</code> with levels <code>A</code> and <code>B</code></li>
<li>Factor <code>F2</code> with levels <code>A</code> and <code>B</code></li>
</ul></li>
<li>Means:
<ul>
<li><code>F1</code> = <code>A</code>, <code>F2</code> = <code>A</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200"></li>
<li><code>F1</code> = <code>A</code>, <code>F2</code> = <code>B</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%201"></li>
<li><code>F1</code> = <code>B</code>, <code>F2</code> = <code>A</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%201"></li>
<li><code>F1</code> = <code>B</code>, <code>F2</code> = <code>B</code> → <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%203"></li>
</ul></li>
<li>Standard deviation of error:
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%201"></li>
</ul></li>
<li>In treatment coding, this corresponds to the coefficient vector <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20=%20(0,%201,%201,%201)%5ET"></li>
<li>10 individuals per group</li>
</ul>
</section>
<section id="example-of-simulated-data" class="level2">
<h2 class="anchored" data-anchor-id="example-of-simulated-data">Example of simulated data</h2>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-2_593d4bdc27dabda465437e9315223d39">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">generate_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb2-2">  dd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">F1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">F2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>))</span>
<span id="cb2-3">  X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dd)</span>
<span id="cb2-4">  dd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> (X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> beta)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dd)))</span>
<span id="cb2-5">}</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(F1, F2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'(Points are jittered along x-axis)'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()) </span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="simulate-many-datasets-in-order-to-estimate-power-to-test-the-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="simulate-many-datasets-in-order-to-estimate-power-to-test-the-hypotheses">Simulate many datasets in order to estimate power to test the hypotheses</h2>
<ul>
<li>For ANOVA analysis the multcomp package is used in order to simultaneously test the hypotheses (correction for multiple testing with respect to the two (without interactgion) or three hypotheses (with interaction) is included by design)</li>
<li>Calculate p-values testing the main effects (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_1%20=%200"> and <img src="https://latex.codecogs.com/png.latex?%5Cbeta_2%20=%200">) and the interaction (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_3%20=%200">) for each of the simulations</li>
<li>Estimate power empirically</li>
</ul>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-3_aebdb080e40921e6e3edce7d25c7a0db">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">simulate_two_way_ANOVA <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_interaction =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) {</span>
<span id="cb3-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(include_interaction) {</span>
<span id="cb3-3">    fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>())</span>
<span id="cb3-4">    ii <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-5">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb3-6">    fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subset =</span> (F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> F2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>))</span>
<span id="cb3-7">    ii <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb3-8">  }</span>
<span id="cb3-9">  hypotheses_tests <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glht</span>(fm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linfct =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fm))[ii], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'= 0'</span>))</span>
<span id="cb3-10">  p_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(hypotheses_tests)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pvalues</span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attributes</span>(p_values) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(p_values)</span>
<span id="cb3-13">}</span></code></pre></div>
</div>
<section id="power-of-anova-analysis-without-interaction" class="level3">
<h3 class="anchored" data-anchor-id="power-of-anova-analysis-without-interaction">Power of ANOVA analysis without interaction</h3>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-4_ca941b34e3aa066c86681533e0a9331b">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">nr_of_sims <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e4</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Effect =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 2'</span>),</span>
<span id="cb4-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Power =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_sims, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_two_way_ANOVA</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> </span>
<span id="cb4-4">                         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> nr_of_sims) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Effect</th>
<th style="text-align: center;">Power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Main effect 1</td>
<td style="text-align: center;">0.469</td>
</tr>
<tr class="even">
<td style="text-align: center;">Main effect 2</td>
<td style="text-align: center;">0.469</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="power-of-anova-analysis-with-interaction" class="level3">
<h3 class="anchored" data-anchor-id="power-of-anova-analysis-with-interaction">Power of ANOVA analysis with interaction</h3>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-5_ce711e28450238c3e96aec2545d3ca99">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">nr_of_sims <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e4</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Effect =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 2'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Interaction'</span>),</span>
<span id="cb5-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Power =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_sims, </span>
<span id="cb5-4">                                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_two_way_ANOVA</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_interaction =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> </span>
<span id="cb5-5">                         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> nr_of_sims) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Effect</th>
<th style="text-align: center;">Power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Main effect 1</td>
<td style="text-align: center;">0.441</td>
</tr>
<tr class="even">
<td style="text-align: center;">Main effect 2</td>
<td style="text-align: center;">0.441</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Interaction</td>
<td style="text-align: center;">0.218</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="power-of-separate-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="power-of-separate-t-tests">Power of separate t-tests</h3>
<div class="cell" data-hash="2023-08-28-anova-with-interactions-vs.-individual-t-tests_cache/html/unnamed-chunk-6_d5ec28b9b7078eaecc9f85af74906637">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bonferroni correction for two tests:</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sig.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 10
          delta = 1
             sd = 1
      sig.level = 0.025
          power = 0.4360626
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bonferroni correction for three tests:</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sig.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 10
          delta = 1
             sd = 1
      sig.level = 0.01666667
          power = 0.3690371
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>Power in Two-Way-ANOVA without interaction is slightly greater than power of two separate t-tests corrected with Bonferroni procedure (30 individuals needed in both cases, provided that the control group is ‘recycled’ in the t-test case)</li>
<li>Power in Two-Way-ANOVA with interaction is approximately equal to power of two separate t-tests corrected with Bonferroni procedure (10 additional individuals needed in order to test interaction)</li>
<li>Analysis of interaction effect is possible, however laborious, via separate t-tests</li>
<li>Power could be improved without increased total sample size by appropriately increasing the size of the control group (not shown here) - see Friedemann’s document (is in local folder however not uploaded)</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>ANOVA vs t-Tests</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests.html</guid>
  <pubDate>Sun, 27 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Simulating a clinical study with a mechanistic model in the background</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background.html</link>
  <description><![CDATA[ 



<section id="description-of-virtual-study" class="level2">
<h2 class="anchored" data-anchor-id="description-of-virtual-study">Description of virtual study</h2>
<ul>
<li>Increased doses for leukemia in comparison to “standard” doses with some substance X is to be studied</li>
<li>Randomized, controlled, double-blind clinical trial</li>
<li>Groups:
<ul>
<li>standard regimen: X 1 mg - 0 - 2 mg - 0 for 10 days</li>
<li>adjusted regimen: X 2 mg - 0 - 3 mg - 0 for 10 days</li>
</ul></li>
<li>Leukemic burden is assumed to be lognormally distributed initially</li>
<li>Postleukemic burden is assumed to be: Leukemic burden pretherapy divided by area under the plasma level curve</li>
<li>Some plausible pharmacokinetic model is assumed, with rate constants depending on age and weight</li>
<li>Primary endpoint: Molecular remission (defined as postleukemic burden &lt; 0.0012)</li>
</ul>
</section>
<section id="definition-of-study-population" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-study-population">Definition of study population</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-2">nr_of_patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span></span>
<span id="cb1-3">patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nr_of_patients,</span>
<span id="cb1-4">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'standard_dosing'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjusted_dosing'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> nr_of_patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(nr_of_patients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb1-6">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(nr_of_patients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb1-7">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_scaled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(age)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-8">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight_scaled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(weight)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-9">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'male'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'female'</span>), </span>
<span id="cb1-10">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> nr_of_patients, </span>
<span id="cb1-11">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-12">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">leukemic_burden_pretherapy =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_patients))</span>
<span id="cb1-13"></span>
<span id="cb1-14">patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_n</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 7%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">id</th>
<th style="text-align: center;">group</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">age_scaled</th>
<th style="text-align: center;">weight_scaled</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">leukemic_burden_pretherapy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">182</td>
<td style="text-align: center;">adjusted_dosing</td>
<td style="text-align: center;">72.63185</td>
<td style="text-align: center;">81.90230</td>
<td style="text-align: center;">1.3483988</td>
<td style="text-align: center;">0.1487158</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">2.670092</td>
</tr>
<tr class="even">
<td style="text-align: center;">13</td>
<td style="text-align: center;">standard_dosing</td>
<td style="text-align: center;">64.00771</td>
<td style="text-align: center;">92.32476</td>
<td style="text-align: center;">0.4340111</td>
<td style="text-align: center;">1.1952301</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">2.416850</td>
</tr>
<tr class="odd">
<td style="text-align: center;">68</td>
<td style="text-align: center;">standard_dosing</td>
<td style="text-align: center;">60.53004</td>
<td style="text-align: center;">62.43473</td>
<td style="text-align: center;">0.0652855</td>
<td style="text-align: center;">-1.8060152</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">1.798109</td>
</tr>
<tr class="even">
<td style="text-align: center;">127</td>
<td style="text-align: center;">adjusted_dosing</td>
<td style="text-align: center;">62.35387</td>
<td style="text-align: center;">79.39178</td>
<td style="text-align: center;">0.2586592</td>
<td style="text-align: center;">-0.1033647</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">1.186002</td>
</tr>
<tr class="odd">
<td style="text-align: center;">25</td>
<td style="text-align: center;">standard_dosing</td>
<td style="text-align: center;">53.74961</td>
<td style="text-align: center;">76.36343</td>
<td style="text-align: center;">-0.6536207</td>
<td style="text-align: center;">-0.4074403</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">3.048497</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="definition-of-pharmacokinetic-model" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-pharmacokinetic-model">Definition of pharmacokinetic model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">calc_plasma_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(applications, patient, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb2-2">  plasma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">timepoint =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max, </span>
<span id="cb2-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb2-4">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id, </span>
<span id="cb2-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>group) </span>
<span id="cb2-6">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(applications)) {</span>
<span id="cb2-7">    ii <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> applications<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time[i]</span>
<span id="cb2-8">    plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[ii<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[ii<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> applications<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dose[i]</span>
<span id="cb2-9">  }</span>
<span id="cb2-10">  degraded <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max) {</span>
<span id="cb2-12">    degraded <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> degraded <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-13">      plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb2-14">      (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>age_scaled <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weight_scaled) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb2-15">    plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> degraded</span>
<span id="cb2-16">  }</span>
<span id="cb2-17">  plasma</span>
<span id="cb2-18">}</span></code></pre></div>
</div>
</section>
<section id="definition-of-dosing-schemes" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-dosing-schemes">Definition of dosing schemes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">standard_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb3-2">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span>
<span id="cb3-3">adjusted_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb3-4">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span></code></pre></div>
</div>
</section>
<section id="calculation-of-plasma-levels" class="level2">
<h2 class="anchored" data-anchor-id="calculation-of-plasma-levels">Calculation of plasma levels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">plasma_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>()</span>
<span id="cb4-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nr_of_patients){</span>
<span id="cb4-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(patients<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>group[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'standard_dosing'</span>) {</span>
<span id="cb4-4">    current_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> standard_dosing</span>
<span id="cb4-5">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb4-6">    current_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_dosing</span>
<span id="cb4-7">  }</span>
<span id="cb4-8">  plasma_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plasma_levels <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calc_plasma_levels</span>(</span>
<span id="cb4-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">applications =</span> current_dosing, </span>
<span id="cb4-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">patient =</span> patients[i, ],</span>
<span id="cb4-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>))</span>
<span id="cb4-13">}</span></code></pre></div>
</div>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">plasma_levels <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(nr_of_patients, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(timepoint, level, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Plasma levels of randomly chosen individuals'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Patient id'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(plasma_levels, id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(level)))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">leukemic_burden_posttherapy =</span> leukemic_burden_pretherapy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> auc,</span>
<span id="cb8-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">molecular_remission =</span> leukemic_burden_posttherapy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2e-3</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(patients<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>leukemic_burden_posttherapy)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
8.897e-05 5.727e-04 1.214e-03 1.981e-03 2.403e-03 2.008e-02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contigency table of group vs. molecular_remission (yes / no)</span></span>
<span id="cb10-2">(study_outcome <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xtabs</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> molecular_remission, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> patients))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 molecular_remission
group             FALSE TRUE
  adjusted_dosing    61   39
  standard_dosing    38   62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate study p-value</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chisq.test</span>(study_outcome)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  study_outcome
X-squared = 9.681, df = 1, p-value = 0.001862</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>Here, a hypothetical clinical study has been simulated</li>
<li>a lot of fine-tuning and a lot of knowledge about the underlying mechanisms is needed</li>
<li>hard to generalize that for the next application - probably, a similar amount of fine-tuning will be needed</li>
</ul>


</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background.html</guid>
  <pubDate>Mon, 21 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Generation of in silico studies</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-21-generation-of-in-silico-studies/2023-08-21-generation-of-in-silico-studies.html</link>
  <description><![CDATA[ 



<section id="description-of-simulation-model" class="level2">
<h2 class="anchored" data-anchor-id="description-of-simulation-model">Description of simulation model</h2>
<ul>
<li><code>disease</code>: Random names for quantity of interest (in reality something like ‘Hba1c’, ‘Survival after therapy with Imatinibe’ etc.)
<ul>
<li>3 letters, duplicates allowed</li>
</ul></li>
<li><code>assumed_delta</code>: Assumed difference in means that has been used for designing the study, lognormal distribution is assumed</li>
<li><code>actual_delta</code>: <em>Ground truth</em> difference in means, assumed 0 in 50% of the cases, in the rest of the cases <code>assumed_delta</code> multiplied by random number uniformly distributed between 0.2 and 1.3</li>
<li><code>sd</code>: Standard deviation of <code>disease</code> - some hopefully reasonable random number</li>
<li><code>n_planned</code>: Designed group size according to <code>assumed_delta</code> and <code>sd</code> based on <code>stats::power.t.test()</code></li>
<li><code>n_per_year_assumed</code>: Assumed mean number of patients that can be included in study</li>
<li><code>n_per_year_actual</code>: Actual number of patients that can be included per year</li>
<li><code>expected_study duration</code> and <code>actual_study_duration</code>: Designed group size divided by expected / actual number of patients per year</li>
<li><code>actual_power</code>: Power calculated based on <code>actual_delta</code> and <code>sd</code></li>
<li><code>null_rejected</code>: Boolean variable based on Bernoulli trial with <img src="https://latex.codecogs.com/png.latex?p"> taken from <code>actual_power</code></li>
<li><code>utiliy_null_rejected</code>: Utility of study - uniformly distributed random number between 0 and 1</li>
<li><code>utiliy_null_not_rejected</code>: <code>utiliy_null_rejected</code> / 2</li>
<li><code>cost_per_patient</code>: Monetary cost to include a patient in the study - random number on arbitrary scale</li>
</ul>
</section>
<section id="simulation-results" class="level2">
<h2 class="anchored" data-anchor-id="simulation-results">Simulation results</h2>
<div class="cell" data-hash="2023-08-21-generation-of-in-silico-studies_cache/html/simulation_679af1554d92ec67bb518ca622c0a09c">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set parameters:</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>)</span>
<span id="cb1-3">nr_of_studies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># utiliy functions:</span></span>
<span id="cb1-6">get_random_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(letters, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> length), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>))</span>
<span id="cb1-8">}</span>
<span id="cb1-9"></span>
<span id="cb1-10">get_n_planned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vectorize</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(delta, sd, power) {</span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> delta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">power =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>()</span>
<span id="cb1-13">})</span>
<span id="cb1-14"></span>
<span id="cb1-15">get_actual_power <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vectorize</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(delta, sd, n) {</span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> delta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>power</span>
<span id="cb1-17">})</span>
<span id="cb1-18"></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simulate studies:</span></span>
<span id="cb1-21">studies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">disease =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_random_names</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_studies, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-22">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endpoint =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_random_names</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_studies, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb1-23">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">assumed_delta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies),</span>
<span id="cb1-24">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_delta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb1-25">                                        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb1-26">                                        assumed_delta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>)),</span>
<span id="cb1-27">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> assumed_delta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies)),</span>
<span id="cb1-28">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_planned =</span> </span>
<span id="cb1-29">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_n_planned</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> assumed_delta, </span>
<span id="cb1-30">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, </span>
<span id="cb1-31">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">power =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>),</span>
<span id="cb1-32">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_per_year_assumed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies),</span>
<span id="cb1-33">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_per_year_actual =</span> </span>
<span id="cb1-34">                    n_per_year_assumed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_planned, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>),</span>
<span id="cb1-35">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expected_study_duration =</span> n_planned <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_per_year_assumed,</span>
<span id="cb1-36">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_study_duration =</span> n_planned <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_per_year_actual,</span>
<span id="cb1-37">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_power =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_actual_power</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> actual_delta, </span>
<span id="cb1-38">                                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, </span>
<span id="cb1-39">                                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_planned),</span>
<span id="cb1-40">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">null_rejected =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> actual_power,</span>
<span id="cb1-41">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">utility_null_rejected =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies),</span>
<span id="cb1-42">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">utility_null_not_rejected =</span> utility_null_rejected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-43">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cost_per_patient =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies))</span></code></pre></div>
</div>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<section id="randomly-chosen-studies" class="level3">
<h3 class="anchored" data-anchor-id="randomly-chosen-studies">20 randomly chosen studies:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_n</span>(studies, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">disease</th>
<th style="text-align: center;">endpoint</th>
<th style="text-align: center;">assumed_delta</th>
<th style="text-align: center;">actual_delta</th>
<th style="text-align: center;">sd</th>
<th style="text-align: center;">n_planned</th>
<th style="text-align: center;">n_per_year_assumed</th>
<th style="text-align: center;">n_per_year_actual</th>
<th style="text-align: center;">expected_study_duration</th>
<th style="text-align: center;">actual_study_duration</th>
<th style="text-align: center;">actual_power</th>
<th style="text-align: center;">null_rejected</th>
<th style="text-align: center;">utility_null_rejected</th>
<th style="text-align: center;">utility_null_not_rejected</th>
<th style="text-align: center;">cost_per_patient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">et</td>
<td style="text-align: center;">z</td>
<td style="text-align: center;">1.63</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">5.15</td>
<td style="text-align: center;">159</td>
<td style="text-align: center;">11.59</td>
<td style="text-align: center;">9.02</td>
<td style="text-align: center;">13.72</td>
<td style="text-align: center;">17.63</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.51</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">2.07</td>
</tr>
<tr class="even">
<td style="text-align: center;">rc</td>
<td style="text-align: center;">i</td>
<td style="text-align: center;">0.42</td>
<td style="text-align: center;">0.53</td>
<td style="text-align: center;">0.60</td>
<td style="text-align: center;">33</td>
<td style="text-align: center;">11.74</td>
<td style="text-align: center;">8.54</td>
<td style="text-align: center;">2.81</td>
<td style="text-align: center;">3.86</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.36</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">3.63</td>
</tr>
<tr class="odd">
<td style="text-align: center;">zf</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">1.22</td>
<td style="text-align: center;">1.80</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">10.67</td>
<td style="text-align: center;">7.60</td>
<td style="text-align: center;">3.75</td>
<td style="text-align: center;">5.27</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">0.34</td>
</tr>
<tr class="even">
<td style="text-align: center;">ok</td>
<td style="text-align: center;">y</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.16</td>
<td style="text-align: center;">0.32</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">12.30</td>
<td style="text-align: center;">10.05</td>
<td style="text-align: center;">2.11</td>
<td style="text-align: center;">2.59</td>
<td style="text-align: center;">0.42</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">3.49</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ny</td>
<td style="text-align: center;">r</td>
<td style="text-align: center;">1.50</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">4.34</td>
<td style="text-align: center;">133</td>
<td style="text-align: center;">11.60</td>
<td style="text-align: center;">13.08</td>
<td style="text-align: center;">11.47</td>
<td style="text-align: center;">10.17</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: center;">cp</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">1.62</td>
<td style="text-align: center;">1.72</td>
<td style="text-align: center;">5.90</td>
<td style="text-align: center;">211</td>
<td style="text-align: center;">11.06</td>
<td style="text-align: center;">8.24</td>
<td style="text-align: center;">19.08</td>
<td style="text-align: center;">25.59</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.49</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">1.25</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rw</td>
<td style="text-align: center;">b</td>
<td style="text-align: center;">13.74</td>
<td style="text-align: center;">9.18</td>
<td style="text-align: center;">31.73</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">22.36</td>
<td style="text-align: center;">25.38</td>
<td style="text-align: center;">3.80</td>
<td style="text-align: center;">3.35</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: center;">wt</td>
<td style="text-align: center;">q</td>
<td style="text-align: center;">1.96</td>
<td style="text-align: center;">1.64</td>
<td style="text-align: center;">2.68</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">10.79</td>
<td style="text-align: center;">10.16</td>
<td style="text-align: center;">2.87</td>
<td style="text-align: center;">3.05</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">1.02</td>
</tr>
<tr class="odd">
<td style="text-align: center;">is</td>
<td style="text-align: center;">t</td>
<td style="text-align: center;">1.22</td>
<td style="text-align: center;">1.30</td>
<td style="text-align: center;">2.54</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">11.28</td>
<td style="text-align: center;">12.09</td>
<td style="text-align: center;">6.21</td>
<td style="text-align: center;">5.79</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.52</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: center;">dt</td>
<td style="text-align: center;">z</td>
<td style="text-align: center;">0.55</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.92</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">10.62</td>
<td style="text-align: center;">11.70</td>
<td style="text-align: center;">4.33</td>
<td style="text-align: center;">3.93</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">0.83</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gj</td>
<td style="text-align: center;">h</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">1.50</td>
<td style="text-align: center;">29</td>
<td style="text-align: center;">10.19</td>
<td style="text-align: center;">10.29</td>
<td style="text-align: center;">2.85</td>
<td style="text-align: center;">2.82</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">1.04</td>
</tr>
<tr class="even">
<td style="text-align: center;">ux</td>
<td style="text-align: center;">h</td>
<td style="text-align: center;">0.56</td>
<td style="text-align: center;">0.46</td>
<td style="text-align: center;">0.91</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">11.44</td>
<td style="text-align: center;">7.19</td>
<td style="text-align: center;">3.76</td>
<td style="text-align: center;">5.98</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">1.62</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gz</td>
<td style="text-align: center;">k</td>
<td style="text-align: center;">0.76</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">1.13</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">13.06</td>
<td style="text-align: center;">10.68</td>
<td style="text-align: center;">2.83</td>
<td style="text-align: center;">3.46</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: center;">bl</td>
<td style="text-align: center;">h</td>
<td style="text-align: center;">0.31</td>
<td style="text-align: center;">0.30</td>
<td style="text-align: center;">1.04</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">11.01</td>
<td style="text-align: center;">5.54</td>
<td style="text-align: center;">16.35</td>
<td style="text-align: center;">32.50</td>
<td style="text-align: center;">0.79</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.96</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">1.18</td>
</tr>
<tr class="odd">
<td style="text-align: center;">nl</td>
<td style="text-align: center;">g</td>
<td style="text-align: center;">1.19</td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;">1.33</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">10.67</td>
<td style="text-align: center;">9.62</td>
<td style="text-align: center;">1.97</td>
<td style="text-align: center;">2.18</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.80</td>
</tr>
<tr class="even">
<td style="text-align: center;">zx</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">3.37</td>
<td style="text-align: center;">3.08</td>
<td style="text-align: center;">5.84</td>
<td style="text-align: center;">49</td>
<td style="text-align: center;">10.12</td>
<td style="text-align: center;">11.16</td>
<td style="text-align: center;">4.84</td>
<td style="text-align: center;">4.39</td>
<td style="text-align: center;">0.73</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.60</td>
</tr>
<tr class="odd">
<td style="text-align: center;">kv</td>
<td style="text-align: center;">g</td>
<td style="text-align: center;">3.54</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">5.95</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">11.21</td>
<td style="text-align: center;">11.80</td>
<td style="text-align: center;">4.10</td>
<td style="text-align: center;">3.90</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: center;">tn</td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">1.23</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">1.96</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">12.77</td>
<td style="text-align: center;">14.84</td>
<td style="text-align: center;">3.21</td>
<td style="text-align: center;">2.76</td>
<td style="text-align: center;">0.74</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.73</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">0.97</td>
</tr>
<tr class="odd">
<td style="text-align: center;">yk</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.63</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">11.18</td>
<td style="text-align: center;">6.38</td>
<td style="text-align: center;">3.31</td>
<td style="text-align: center;">5.80</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">1.05</td>
</tr>
<tr class="even">
<td style="text-align: center;">ud</td>
<td style="text-align: center;">k</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.21</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">11.13</td>
<td style="text-align: center;">11.38</td>
<td style="text-align: center;">3.50</td>
<td style="text-align: center;">3.43</td>
<td style="text-align: center;">0.38</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">1.43</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="descripive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descripive-statistics">Descripive statistics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">skimr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skim</span>(studies)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">studies</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">disease</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">650</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">endpoint</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">null_rejected</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: left;">FAL: 7141, TRU: 2859</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">assumed_delta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">31.39</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">actual_delta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">33.86</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.33</td>
<td style="text-align: right;">7.89</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">266.44</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_planned</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">179.94</td>
<td style="text-align: right;">673.96</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">37.00</td>
<td style="text-align: right;">64.00</td>
<td style="text-align: right;">138.00</td>
<td style="text-align: right;">26294.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">n_per_year_assumed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.68</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">10.02</td>
<td style="text-align: right;">10.51</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">11.96</td>
<td style="text-align: right;">91.31</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_per_year_actual</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9.95</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: right;">5.09</td>
<td style="text-align: right;">7.68</td>
<td style="text-align: right;">9.67</td>
<td style="text-align: right;">11.72</td>
<td style="text-align: right;">100.92</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">expected_study_duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">60.65</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">5.58</td>
<td style="text-align: right;">11.95</td>
<td style="text-align: right;">2255.34</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">actual_study_duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.59</td>
<td style="text-align: right;">72.64</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">3.94</td>
<td style="text-align: right;">6.78</td>
<td style="text-align: right;">14.82</td>
<td style="text-align: right;">2827.49</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">actual_power</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">utility_null_rejected</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">utility_null_not_rejected</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">cost_per_patient</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">35.66</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="additional-aspects" class="level3">
<h3 class="anchored" data-anchor-id="additional-aspects">Additional aspects:</h3>
<ul>
<li><code>expected_study_duration</code> and <code>actual_study_duration</code> have not very realistic values yet → maybe not all of the considered studies would have been feasible due to insufficient patient numbers <code>expected_study_duration</code> <em>very</em> long for some studies</li>
</ul>


</section>
</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-21-generation-of-in-silico-studies/2023-08-21-generation-of-in-silico-studies.html</guid>
  <pubDate>Sun, 20 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Algorithmic study design – white paper</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-21-algorithmic-study-design----white-paper/2023-08-21-algorithmic-study-design----white-paper.html</link>
  <description><![CDATA[ 



<p>Currently, the design of clinical studies is carried out mostly manually by domaine experts. Here, we want to do first steps to think about how the design of experiments could be done in an algorithmic way, potentially / hopefully resulting in more useful clinical studies.</p>
<section id="what-defines-a-study-design" class="level2">
<h2 class="anchored" data-anchor-id="what-defines-a-study-design">What defines a study design?</h2>
<p>Non-exhaustive list of parameters:</p>
<ul>
<li>Parameter to study (e. g. Hba1c, blood pressure / survival time)</li>
<li>Inclusion criteria (e. g. age &gt; 65 / Diabetes Mellitus Type II)</li>
<li>Intervention / grouping (e. g. Metformine + diet vs.&nbsp;diet only)</li>
<li>Hypotheses (e. g. Hba1c after 3 months in group Metformine + diet lower than in group diet only)</li>
<li>…</li>
</ul>
<section id="open-questions" class="level3">
<h3 class="anchored" data-anchor-id="open-questions">Open questions:</h3>
<ul>
<li>How can we formally describe the space of possible studies?</li>
</ul>
<p>→ in the end, a study should be represented as a point <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%20x"> in the space of different study designs</p>
</section>
</section>
<section id="utility-of-a-particular-study-design" class="level2">
<h2 class="anchored" data-anchor-id="utility-of-a-particular-study-design">Utility of a particular study design</h2>
<ul>
<li>Each study design is associated with different possible outcomes</li>
<li>An outcome could be formally defined as the combination of statements about the hypotheses
<ul>
<li><ol start="5" type="a">
<li><ol start="7" type="a">
<li>hypothesis 1 - evidence for alternative hypothesis, hypotheses 2 - no evidence for alternative hypotheses</li>
</ol></li>
</ol></li>
<li>another example: single hypothesis – Hba1c is lower in Metformine group</li>
<li>Not clear, if this definition is sufficient</li>
</ul></li>
<li>We model the utiliy of a study design as a random variable <img src="https://latex.codecogs.com/png.latex?U">, each realization being a study carried out the particular study design</li>
<li>The expected value of <img src="https://latex.codecogs.com/png.latex?U"> can be determined if we have the probabilities and utilities of each outcome</li>
</ul>
</section>
<section id="sketch-of-an-algorithmic-approach" class="level2">
<h2 class="anchored" data-anchor-id="sketch-of-an-algorithmic-approach">Sketch of an algorithmic approach</h2>
<p>Idea: Find an algorithm to maximize the expected utility over the space of different study designs</p>
<ul>
<li>Define the space of all study designs to be taken into consideration
<ul>
<li>Complex, but probably doable in some way, maybe in a meaningful way</li>
</ul></li>
<li>Enumerate all different outcomes of each study
<ul>
<li>Probably doable</li>
</ul></li>
<li>Assign probability and utility to each study outcome of each study in order to determine the expected utility of all studies
<ul>
<li>This is difficult - I don’t know how to algorithmically determine the utility of a study</li>
</ul></li>
<li>Select studies with a high utility
<ul>
<li>I don’t know how to design an “optimizer” in a meaningful / useful way</li>
<li>One idea is to simulate many studies and use the simulations to train an optimizer. But how can we assign utilities to the simulated designs?`</li>
</ul></li>
</ul>
<p>→ In conclusion, this approach (especially steps 3 and 4) seems so complex to me that I have doubts if I can do it, I would definitely need guidance how to do it</p>
</section>
<section id="another-approach" class="level2">
<h2 class="anchored" data-anchor-id="another-approach">Another approach?</h2>
<ul>
<li>Does anyone have an idea for an easier approach?</li>
</ul>


</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-21-algorithmic-study-design----white-paper/2023-08-21-algorithmic-study-design----white-paper.html</guid>
  <pubDate>Sun, 20 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Leave-one-out cross-validation in Python</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-11-leave-one-out-cross-validation-in-python/2023-08-11-leave-one-out-cross-validation-in-python.html</link>
  <description><![CDATA[ 



<section id="strategy" class="level2">
<h2 class="anchored" data-anchor-id="strategy">Strategy</h2>
<ul>
<li>Look at the <code>cars</code> dataset that is shipped in <code>base</code> R</li>
<li>Fit models
<ul>
<li>for each model, leave out one data point</li>
<li>predict the response value for that data point based on the model that is not based on that data point</li>
<li>calculate mean absolute error and mean squared error</li>
</ul></li>
</ul>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<section id="init" class="level3">
<h3 class="anchored" data-anchor-id="init">Init</h3>
<section id="chunk-in-r-to-setup-my-python-environment-can-be-omitted-for-users-with-python-ready-to-use" class="level4">
<h4 class="anchored" data-anchor-id="chunk-in-r-to-setup-my-python-environment-can-be-omitted-for-users-with-python-ready-to-use">Chunk in R to setup my Python environment (can be omitted for users with Python ready to use)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sbloggel'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">required =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
</section>
<section id="chunk-to-load-python-libraries-and-set-up-the-data" class="level4">
<h4 class="anchored" data-anchor-id="chunk-to-load-python-libraries-and-set-up-the-data">Chunk to load Python libraries and set up the data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> statsmodels.formula.api <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> smf</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-4">cars <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(r[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cars'</span>])</span></code></pre></div>
</div>
</section>
</section>
<section id="show-that-fitting-in-r-and-python-yields-identical-results" class="level3">
<h3 class="anchored" data-anchor-id="show-that-fitting-in-r-and-python-yields-identical-results">Show that fitting in R and Python yields identical results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> smf.ols(formula <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed ~ dist'</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars).fit()</span>
<span id="cb3-2">fm.summary()</span></code></pre></div>
<div class="cell-output-display">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>speed</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.651</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>89.57</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Wed, 23 Aug 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>1.49e-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>12:04:41</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-127.39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>50</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>258.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>48</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>262.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>8.2839</td>
<td>0.874</td>
<td>9.474</td>
<td>0.000</td>
<td>6.526</td>
<td>10.042</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dist</td>
<td>0.1656</td>
<td>0.017</td>
<td>9.464</td>
<td>0.000</td>
<td>0.130</td>
<td>0.201</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>0.720</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.195</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.698</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>0.827</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>-0.207</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.661</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>2.526</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>98.0</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = speed ~ dist, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5293 -2.1550  0.3615  2.4377  6.4179 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.28391    0.87438   9.474 1.44e-12 ***
dist         0.16557    0.01749   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.156 on 48 degrees of freedom
Multiple R-squared:  0.6511,    Adjusted R-squared:  0.6438 
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
</div>
</section>
<section id="show-that-prediction-in-r-and-python-yields-identical-results" class="level3">
<h3 class="anchored" data-anchor-id="show-that-prediction-in-r-and-python-yields-identical-results">Show that prediction in R and Python yields identical results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">fm.predict(cars.iloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    8.615041
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm, cars[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
8.615041 </code></pre>
</div>
</div>
</section>
<section id="perform-leave-one-out-cross-validation-in-python" class="level3">
<h3 class="anchored" data-anchor-id="perform-leave-one-out-cross-validation-in-python">Perform leave-one-out-cross-validation in Python</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prepare column for predictions:</span></span>
<span id="cb10-2">cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prediction'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.nan</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fit models:</span></span>
<span id="cb10-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>):</span>
<span id="cb10-6">  train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars.drop(index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i)</span>
<span id="cb10-7">  test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars.iloc[i]</span>
<span id="cb10-8">  fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> smf.ols(formula<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed ~ dist'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>train).fit()</span>
<span id="cb10-9">  cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prediction'</span>].iloc[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fm.predict(test)</span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calculate prediction error:</span></span>
<span id="cb10-12">cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'error'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prediction'</span>]</span>
<span id="cb10-13"></span>
<span id="cb10-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mean absolute error:</span></span>
<span id="cb10-15">np.mean(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'error'</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.6335683917489323</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># root mean squared error:</span></span>
<span id="cb12-2">np.sqrt(np.mean(np.square(cars[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'error'</span>])))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.244276599631193</code></pre>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>Results are identical to those produced in R: <a href="https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r">Link</a></li>
<li>Also, the discrepancy with Friedemann’s results is now resolved</li>
</ul>


</section>

 ]]></description>
  <category>Python</category>
  <category>Linear model vs neural nets</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-11-leave-one-out-cross-validation-in-python/2023-08-11-leave-one-out-cross-validation-in-python.html</guid>
  <pubDate>Thu, 10 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Cars dataset and tidymodels</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-08-cars-dataset-and-tidymodels/2023-08-08-cars-dataset-and-tidymodels.html</link>
  <description><![CDATA[ 



<section id="init" class="level2">
<h2 class="anchored" data-anchor-id="init">Init</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidymodels'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ broom        1.0.4     ✔ recipes      1.0.6
✔ dials        1.2.0     ✔ rsample      1.1.1
✔ dplyr        1.1.2     ✔ tibble       3.2.1
✔ ggplot2      3.4.2     ✔ tidyr        1.3.0
✔ infer        1.0.4     ✔ tune         1.1.1
✔ modeldata    1.1.0     ✔ workflows    1.1.3
✔ parsnip      1.1.0     ✔ workflowsets 1.0.1
✔ purrr        1.0.1     ✔ yardstick    1.2.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ purrr::discard() masks scales::discard()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ recipes::step()  masks stats::step()
• Learn how to get started at https://www.tidymodels.org/start/</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span></code></pre></div>
</div>
</section>
<section id="do-vfold-cross-validation-on-the-cars-dataset-using-a-linear-model-a-random-forest-model-and-a-neural-net" class="level2">
<h2 class="anchored" data-anchor-id="do-vfold-cross-validation-on-the-cars-dataset-using-a-linear-model-a-random-forest-model-and-a-neural-net">Do vfold cross-validation on the cars dataset using a linear model, a random forest model and a neural net</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create data for resampling:</span></span>
<span id="cb6-2">cars_folds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vfold_cv</span>(cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repeats =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create model specifications:</span></span>
<span id="cb6-5">lm_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">linear_reg</span>()</span>
<span id="cb6-6">rf_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rand_forest</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'regression'</span>)</span>
<span id="cb6-7">nn_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mlp</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">epochs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hidden_units =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">penalty =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'regression'</span>)</span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create workflows:</span></span>
<span id="cb6-11">all_workflows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_set</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">preproc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"formula"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist),</span>
<span id="cb6-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">models =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lm =</span> lm_spec, </span>
<span id="cb6-15">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rf =</span> rf_spec,</span>
<span id="cb6-16">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nn =</span> nn_spec)</span>
<span id="cb6-17">  )</span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the workflows:</span></span>
<span id="cb6-20">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_workflows <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_map</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> cars_folds,</span>
<span id="cb6-22">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">control_resamples</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_pred =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb6-23"></span>
<span id="cb6-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display summary statistics for all model types:</span></span>
<span id="cb6-25">(metrics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(result))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  wflow_id   .config        preproc model .metric .estimator  mean     n std_err
  &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
1 formula_lm Preprocessor1… formula line… rmse    standard   3.18     10  0.288 
2 formula_lm Preprocessor1… formula line… rsq     standard   0.656    10  0.0885
3 formula_rf Preprocessor1… formula rand… rmse    standard   3.14     10  0.340 
4 formula_rf Preprocessor1… formula rand… rsq     standard   0.621    10  0.0901
5 formula_nn Preprocessor1… formula mlp   rmse    standard   2.99     10  0.253 
6 formula_nn Preprocessor1… formula mlp   rsq     standard   0.643    10  0.0834</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">metrics <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> .metric, </span>
<span id="cb8-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(mean, std_err), </span>
<span id="cb8-3">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> wflow_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">wflow_id</th>
<th style="text-align: center;">mean_rmse</th>
<th style="text-align: center;">mean_rsq</th>
<th style="text-align: center;">std_err_rmse</th>
<th style="text-align: center;">std_err_rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">formula_lm</td>
<td style="text-align: center;">3.180583</td>
<td style="text-align: center;">0.6561715</td>
<td style="text-align: center;">0.2883717</td>
<td style="text-align: center;">0.0885333</td>
</tr>
<tr class="even">
<td style="text-align: center;">formula_rf</td>
<td style="text-align: center;">3.142965</td>
<td style="text-align: center;">0.6212505</td>
<td style="text-align: center;">0.3399041</td>
<td style="text-align: center;">0.0901077</td>
</tr>
<tr class="odd">
<td style="text-align: center;">formula_nn</td>
<td style="text-align: center;">2.994578</td>
<td style="text-align: center;">0.6426283</td>
<td style="text-align: center;">0.2528375</td>
<td style="text-align: center;">0.0833891</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot predictions against actual values for all predictions:</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_predictions</span>(result) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> model) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(speed, .pred, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Real value of speed'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Prediction'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Model'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-08-cars-dataset-and-tidymodels/2023-08-08-cars-dataset-and-tidymodels_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="open-questions" class="level2">
<h2 class="anchored" data-anchor-id="open-questions">Open Questions</h2>
<ul>
<li>I don’t exactly understand how tidymodels performs cross-validation, how the metrics are calculated etc. Documentation of the tidymodels package has not been informative to me so far (probably I have to read more into it).</li>
<li>How to collect other metrics, e.g.&nbsp;mean absolute error?</li>
<li>How to conventiently join the predictors to the prediction tibble?</li>
<li>How do I extract honest coefficients from the linear model?</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>Linear model vs neural nets</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-08-cars-dataset-and-tidymodels/2023-08-08-cars-dataset-and-tidymodels.html</guid>
  <pubDate>Mon, 07 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Leave-one-out cross-validation in R</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r.html</link>
  <description><![CDATA[ 



<section id="strategy" class="level2">
<h2 class="anchored" data-anchor-id="strategy">Strategy</h2>
<ul>
<li>Fit “straight” models: linear model, neural net with 2 layers with 3 perceptrons each</li>
<li>Perform “Leave-one-out-cross-validation” (LOOC)</li>
<li>Calculate mean absolute prediction error and root mean squared error of the different methods
<ul>
<li>In cross-validation case for the left-out data point</li>
</ul></li>
</ul>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'neuralnet'</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_geom_defaults</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">leave_one_out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vectorize</span>(</span>
<span id="cb2-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(i, type) {</span>
<span id="cb2-3">    training <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cars[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>i, ]</span>
<span id="cb2-4">    test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cars[i, ]</span>
<span id="cb2-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm'</span>) {</span>
<span id="cb2-6">      fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> training)</span>
<span id="cb2-7">      pp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> test)</span>
<span id="cb2-8">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb2-9">      fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">neuralnet</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, </span>
<span id="cb2-10">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear.output =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> training, </span>
<span id="cb2-11">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hidden =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), </span>
<span id="cb2-12">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stepmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e+7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb2-13">      pp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> test)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-14">    }</span>
<span id="cb2-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(pp)</span>
<span id="cb2-16">  }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vectorize.args =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'i'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">fm_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars)</span>
<span id="cb3-2"></span>
<span id="cb3-3">fm_nn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">neuralnet</span>(speed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dist, </span>
<span id="cb3-4">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear.output =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars, </span>
<span id="cb3-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hidden =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), </span>
<span id="cb3-6">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stepmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e+7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb3-7"></span>
<span id="cb3-8">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-9">  cars,</span>
<span id="cb3-10">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear model straight'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_lm),</span>
<span id="cb3-11">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural net straight'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_nn, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> cars)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb3-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear model with LOOC'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leave_one_out</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(cars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm'</span>),</span>
<span id="cb3-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural net with LOOC'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leave_one_out</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(cars), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nn'</span>)</span>
<span id="cb3-14">)</span></code></pre></div>
</div>
<section id="predictions-for-straight-models-for-all-integers-from-0-to-125" class="level3">
<h3 class="anchored" data-anchor-id="predictions-for-straight-models-for-all-integers-from-0-to-125">Predictions for straight models for all integers from 0 to 125</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">pred_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">125</span>)</span>
<span id="cb4-2">pred_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pred_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear model'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_lm, pred_df),</span>
<span id="cb4-4">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural net'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(fm_nn, pred_df)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-5"></span>
<span id="cb4-6">text_to_add <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Original data as black dots'</span>)</span>
<span id="cb4-7">pred_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>dist) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, speed), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Model type'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="predictions-for-all-dist-values-that-are-in-the-original-data-set-as-well" class="level3">
<h3 class="anchored" data-anchor-id="predictions-for-all-dist-values-that-are-in-the-original-data-set-as-well">Predictions for all dist values that are in the original data set as well</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>speed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>dist) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'speed'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Model type'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, speed), cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dist, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">data_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(dist, speed), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Method'</span>) </span>
<span id="cb6-3"></span>
<span id="cb6-4">data_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">error =</span> value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> speed,</span>
<span id="cb6-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">squared_error =</span> error<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Method) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Mean absolute error'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(error)),</span>
<span id="cb6-9">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Root mean squared error'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(squared_error))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 34%">
<col style="width: 30%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Mean absolute error</th>
<th style="text-align: center;">Root mean squared error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Linear model straight</td>
<td style="text-align: center;">2.52</td>
<td style="text-align: center;">3.09</td>
</tr>
<tr class="even">
<td style="text-align: center;">Linear model with LOOC</td>
<td style="text-align: center;">2.63</td>
<td style="text-align: center;">3.24</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Neural net straight</td>
<td style="text-align: center;">1.95</td>
<td style="text-align: center;">2.43</td>
</tr>
<tr class="even">
<td style="text-align: center;">Neural net with LOOC</td>
<td style="text-align: center;">2.89</td>
<td style="text-align: center;">3.46</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>The neural net seems to overfit!</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>Linear model vs neural nets</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-08-leave-one-out-cross-validation-in-r/2023-08-08-leave-one-out-cross-validation-in-r.html</guid>
  <pubDate>Mon, 07 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Regularization in R</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-05-regularization-in-r/2023-08-05-regularization-in-r.html</link>
  <description><![CDATA[ 



<ul>
<li>ridge regression</li>
<li>lasso regression</li>
<li>elastic net</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-05-regularization-in-r/2023-08-05-regularization-in-r.html</guid>
  <pubDate>Fri, 04 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Getting to know mlr3</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-mlr3/2023-08-04-getting-to-know-mlr3.html</link>
  <description><![CDATA[ 



<p><a href="https://cran.r-project.org/package=mlr3">Link to package</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mlr3'</span>)</span></code></pre></div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-mlr3/2023-08-04-getting-to-know-mlr3.html</guid>
  <pubDate>Thu, 03 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Getting to know tidymodels</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels.html</link>
  <description><![CDATA[ 



<ul>
<li>Tutorials by Julia Silge: <a href="https://www.youtube.com/@JuliaSilge/search">Link</a></li>
<li>Blog post criticising tidymodels: <a href="https://staffblogs.le.ac.uk/teachingr/2020/10/05/on-not-using-tidymodels/">Link</a>, written by <a href="https://github.com/thompson575">this person</a></li>
</ul>
<section id="which-packages-belong-to-the-metapackage-tidymodels" class="level2">
<h2 class="anchored" data-anchor-id="which-packages-belong-to-the-metapackage-tidymodels">Which packages belong to the metapackage tidymodels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">tidymodels<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidymodels_packages</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_self =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "broom"        "cli"          "conflicted"   "dials"        "dplyr"       
 [6] "ggplot2"      "hardhat"      "infer"        "modeldata"    "parsnip"     
[11] "purrr"        "recipes"      "rlang"        "rsample"      "rstudioapi"  
[16] "tibble"       "tidyr"        "tune"         "workflows"    "workflowsets"
[21] "yardstick"    "tidymodels"  </code></pre>
</div>
</div>
</section>
<section id="tutorial-1---palmerpenguins-dataset" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-1---palmerpenguins-dataset">Tutorial 1 - palmerpenguins dataset</h2>
<ul>
<li><a href="https://juliasilge.com/blog/palmer-penguins/">Link</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'palmerpenguins'</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3">penguins_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>year, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>island)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidymodels)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ broom        1.0.4     ✔ rsample      1.1.1
✔ dials        1.2.0     ✔ tune         1.1.1
✔ infer        1.0.4     ✔ workflows    1.1.3
✔ modeldata    1.1.0     ✔ workflowsets 1.0.1
✔ parsnip      1.1.0     ✔ yardstick    1.2.0
✔ recipes      1.0.6     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ dplyr::filter()   masks stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()
• Search for functions across packages at https://www.tidymodels.org/find/</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(penguins_df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 333
Columns: 6
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, 36.7, 39.3, 38.9, 39.2, 41.1, 38.6…
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, 19.3, 20.6, 17.8, 19.6, 17.6, 21.2…
$ flipper_length_mm &lt;int&gt; 181, 186, 195, 193, 190, 181, 195, 182, 191, 198, 18…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, 3450, 3650, 3625, 4675, 3200, 3800…
$ sex               &lt;fct&gt; male, female, female, female, male, female, male, fe…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">penguin_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_split</span>(penguins_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> sex)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(penguin_split)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ data  : tibble [333 × 6] (S3: tbl_df/tbl/data.frame)
  ..$ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
  ..$ bill_length_mm   : num [1:333] 39.1 39.5 40.3 36.7 39.3 38.9 39.2 41.1 38.6 34.6 ...
  ..$ bill_depth_mm    : num [1:333] 18.7 17.4 18 19.3 20.6 17.8 19.6 17.6 21.2 21.1 ...
  ..$ flipper_length_mm: int [1:333] 181 186 195 193 190 181 195 182 191 198 ...
  ..$ body_mass_g      : int [1:333] 3750 3800 3250 3450 3650 3625 4675 3200 3800 4400 ...
  ..$ sex              : Factor w/ 2 levels "female","male": 2 1 1 1 2 1 2 1 2 2 ...
 $ in_id : int [1:249] 2 3 4 11 12 18 24 26 28 33 ...
 $ out_id: logi NA
 $ id    : tibble [1 × 1] (S3: tbl_df/tbl/data.frame)
  ..$ id: chr "Resample1"
 - attr(*, "class")= chr [1:3] "initial_split" "mc_split" "rsplit"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">penguin_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(penguin_split)</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(penguin_train)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [249 × 6] (S3: tbl_df/tbl/data.frame)
 $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ bill_length_mm   : num [1:249] 39.5 40.3 36.7 36.6 38.7 35.9 37.9 39.5 39.5 42.2 ...
 $ bill_depth_mm    : num [1:249] 17.4 18 19.3 17.8 19 19.2 18.6 16.7 17.8 18.5 ...
 $ flipper_length_mm: int [1:249] 186 195 193 185 195 189 172 178 188 180 ...
 $ body_mass_g      : int [1:249] 3800 3250 3450 3700 3450 3800 3150 3250 3300 3550 ...
 $ sex              : Factor w/ 2 levels "female","male": 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">penguin_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(penguin_split)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb17-2">penguin_boot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bootstraps</span>(penguin_train)</span>
<span id="cb17-3">penguin_boot</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Bootstrap sampling 
# A tibble: 25 × 2
   splits           id         
   &lt;list&gt;           &lt;chr&gt;      
 1 &lt;split [249/93]&gt; Bootstrap01
 2 &lt;split [249/91]&gt; Bootstrap02
 3 &lt;split [249/90]&gt; Bootstrap03
 4 &lt;split [249/91]&gt; Bootstrap04
 5 &lt;split [249/85]&gt; Bootstrap05
 6 &lt;split [249/87]&gt; Bootstrap06
 7 &lt;split [249/94]&gt; Bootstrap07
 8 &lt;split [249/88]&gt; Bootstrap08
 9 &lt;split [249/95]&gt; Bootstrap09
10 &lt;split [249/89]&gt; Bootstrap10
# ℹ 15 more rows</code></pre>
</div>
</div>
<section id="question" class="level3">
<h3 class="anchored" data-anchor-id="question">Question:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how can I extract a single bootstrap sample?</span></span>
<span id="cb19-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_boot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(splits) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>()</span>
<span id="cb19-6"></span>
<span id="cb19-7">x[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 249 × 6
   species bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
   &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt; 
 1 Adelie            39.5          17.4               186        3800 female
 2 Adelie            40.3          18                 195        3250 female
 3 Adelie            36.7          19.3               193        3450 female
 4 Adelie            36.6          17.8               185        3700 female
 5 Adelie            38.7          19                 195        3450 female
 6 Adelie            35.9          19.2               189        3800 female
 7 Adelie            37.9          18.6               172        3150 female
 8 Adelie            39.5          16.7               178        3250 female
 9 Adelie            39.5          17.8               188        3300 female
10 Adelie            42.2          18.5               180        3550 female
# ℹ 239 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_boot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Bootstrap01'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(splits) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>()</span>
<span id="cb21-5"></span>
<span id="cb21-6">x[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 249 × 6
   species bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
   &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt; 
 1 Adelie            39.5          17.4               186        3800 female
 2 Adelie            40.3          18                 195        3250 female
 3 Adelie            36.7          19.3               193        3450 female
 4 Adelie            36.6          17.8               185        3700 female
 5 Adelie            38.7          19                 195        3450 female
 6 Adelie            35.9          19.2               189        3800 female
 7 Adelie            37.9          18.6               172        3150 female
 8 Adelie            39.5          16.7               178        3250 female
 9 Adelie            39.5          17.8               188        3300 female
10 Adelie            42.2          18.5               180        3550 female
# ℹ 239 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">glm_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logistic_reg</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">rf_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rand_forest</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"classification"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ranger"</span>)</span>
<span id="cb24-4"></span>
<span id="cb24-5">rf_spec</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest Model Specification (classification)

Computational engine: ranger </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">penguin_wf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_formula</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .)</span>
<span id="cb26-3"></span>
<span id="cb26-4">penguin_wf</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Formula
Model: None

── Preprocessor ────────────────────────────────────────────────────────────────
sex ~ .</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">glm_rs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_wf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_model</span>(glm_spec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fit_resamples</span>(</span>
<span id="cb28-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> penguin_boot,</span>
<span id="cb28-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">control_resamples</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_pred =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb28-6">  )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">glm_rs</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Bootstrap sampling 
# A tibble: 25 × 5
   splits           id          .metrics         .notes           .predictions
   &lt;list&gt;           &lt;chr&gt;       &lt;list&gt;           &lt;list&gt;           &lt;list&gt;      
 1 &lt;split [249/93]&gt; Bootstrap01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 2 &lt;split [249/91]&gt; Bootstrap02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 3 &lt;split [249/90]&gt; Bootstrap03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 4 &lt;split [249/91]&gt; Bootstrap04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 5 &lt;split [249/85]&gt; Bootstrap05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 6 &lt;split [249/87]&gt; Bootstrap06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 7 &lt;split [249/94]&gt; Bootstrap07 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 8 &lt;split [249/88]&gt; Bootstrap08 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 9 &lt;split [249/95]&gt; Bootstrap09 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
10 &lt;split [249/89]&gt; Bootstrap10 &lt;tibble [2 × 4]&gt; &lt;tibble [1 × 3]&gt; &lt;tibble&gt;    
# ℹ 15 more rows

There were issues with some computations:

  - Warning(s) x2: glm.fit: fitted probabilities numerically 0 or 1 occurred

Run `show_notes(.Last.tune.result)` for more information.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">rf_rs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_wf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_model</span>(rf_spec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fit_resamples</span>(</span>
<span id="cb35-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> penguin_boot,</span>
<span id="cb35-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">control_resamples</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_pred =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb35-6">  )</span>
<span id="cb35-7"></span>
<span id="cb35-8">rf_rs</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Bootstrap sampling 
# A tibble: 25 × 5
   splits           id          .metrics         .notes           .predictions
   &lt;list&gt;           &lt;chr&gt;       &lt;list&gt;           &lt;list&gt;           &lt;list&gt;      
 1 &lt;split [249/93]&gt; Bootstrap01 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 2 &lt;split [249/91]&gt; Bootstrap02 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 3 &lt;split [249/90]&gt; Bootstrap03 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 4 &lt;split [249/91]&gt; Bootstrap04 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 5 &lt;split [249/85]&gt; Bootstrap05 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 6 &lt;split [249/87]&gt; Bootstrap06 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 7 &lt;split [249/94]&gt; Bootstrap07 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 8 &lt;split [249/88]&gt; Bootstrap08 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
 9 &lt;split [249/95]&gt; Bootstrap09 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
10 &lt;split [249/89]&gt; Bootstrap10 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 3]&gt; &lt;tibble&gt;    
# ℹ 15 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(rf_rs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary     0.899    25 0.00704 Preprocessor1_Model1
2 roc_auc  binary     0.971    25 0.00307 Preprocessor1_Model1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(glm_rs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  .metric  .estimator  mean     n std_err .config             
  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary     0.919    25 0.00527 Preprocessor1_Model1
2 roc_auc  binary     0.977    25 0.00220 Preprocessor1_Model1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">glm_rs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conf_mat_resampled</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  Prediction Truth   Freq
  &lt;fct&gt;      &lt;fct&gt;  &lt;dbl&gt;
1 female     female 41.8 
2 female     male    3.72
3 male       female  3.68
4 male       male   41.6 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">glm_rs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_predictions</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">roc_curve</span>(sex, .pred_female) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb43-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> specificity, sensitivity, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray80"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">penguin_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> penguin_wf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb44-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_model</span>(glm_spec) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb44-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">last_fit</span>(penguin_split)</span>
<span id="cb44-4"></span>
<span id="cb44-5">penguin_final</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Manual resampling 
# A tibble: 1 × 6
  splits           id               .metrics .notes   .predictions .workflow 
  &lt;list&gt;           &lt;chr&gt;            &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    
1 &lt;split [249/84]&gt; train/test split &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(penguin_final)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary         0.905 Preprocessor1_Model1
2 roc_auc  binary         0.966 Preprocessor1_Model1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_predictions</span>(penguin_final) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb48-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conf_mat</span>(sex, .pred_class)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction female male
    female     39    5
    male        3   37</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">penguin_final<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>.workflow[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb50-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exponentiate =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 5
  term              estimate std.error statistic     p.value
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 (Intercept)       2.35e-42  18.1        -5.30  0.000000115
2 speciesChinstrap  9.76e- 4   1.91       -3.62  0.000295   
3 speciesGentoo     1.96e- 4   3.25       -2.63  0.00866    
4 bill_length_mm    1.88e+ 0   0.159       4.00  0.0000639  
5 bill_depth_mm     7.50e+ 0   0.455       4.43  0.00000940 
6 flipper_length_mm 1.06e+ 0   0.0653      0.863 0.388      
7 body_mass_g       1.01e+ 0   0.00138     4.63  0.00000374 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">penguins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb52-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb52-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(bill_depth_mm, bill_length_mm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> body_mass_g)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-04-getting-to-know-tidymodels/2023-08-04-getting-to-know-tidymodels.html</guid>
  <pubDate>Thu, 03 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Kaplan Meier plots</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots.html</link>
  <description><![CDATA[ 



<p>Goal: draw facetted Kaplan-Meier-plots with p-value</p>
<section id="with-ggquickeda" class="level2">
<h2 class="anchored" data-anchor-id="with-ggquickeda">With ggquickeda</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survival'</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggquickeda'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggquickeda'

The following object is masked from 'package:base':

    +</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">text_to_add <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> text, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> y, </span>
<span id="cb5-3">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Male'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'p = 0.1'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,</span>
<span id="cb5-4">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Female'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'p = 0.03'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb5-5"></span>
<span id="cb5-6"></span>
<span id="cb5-7"></span>
<span id="cb5-8">colon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb5-10">    sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Male'</span>,</span>
<span id="cb5-11">    sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Female'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perfor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(perfor)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-13">  </span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> status, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> perfor)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_km</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_kmticks</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text, </span>
<span id="cb5-18">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, </span>
<span id="cb5-19">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-20">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> text_to_add, </span>
<span id="cb5-21">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Estimated survival'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: status
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic with geom_path was deprecated in ggplot2 3.4.0.
ℹ Please use the `linewidth` aesthetic instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="with-survminer" class="level2">
<h2 class="anchored" data-anchor-id="with-survminer">With survminer</h2>
<section id="do-faceting-with-survminer" class="level3">
<h3 class="anchored" data-anchor-id="do-faceting-with-survminer">Do faceting with survminer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survminer'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpubr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survminer'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    myeloma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon )</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot_facet</span>(fit, colon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">facet.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rx'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>), </span>
<span id="cb12-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ggtheme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_grey</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as.tibble()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` instead.
ℹ The signature and semantics have changed, see `?as_tibble`.
ℹ The deprecated feature was likely used in the survminer package.
  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `select_()` was deprecated in dplyr 0.7.0.
ℹ Please use `select()` instead.
ℹ The deprecated feature was likely used in the survminer package.
  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="extract-plot-object-so-it-can-be-modified-in-a-more-usual-ggplot2-style" class="level3">
<h3 class="anchored" data-anchor-id="extract-plot-object-so-it-can-be-modified-in-a-more-usual-ggplot2-style">Extract plot object so it can be modified in a more usual ggplot2 style</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> perfor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon )</span>
<span id="cb15-2">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>)</span>
<span id="cb15-3">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_grey</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time [days]'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> perfor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon )</span>
<span id="cb16-2">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perfor'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">facet.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sex'</span>)</span></code></pre></div>
</div>
</section>
<section id="show-possible-problem-in-survminer" class="level3">
<h3 class="anchored" data-anchor-id="show-possible-problem-in-survminer">Show possible problem in survminer</h3>
<ul>
<li>After facetting, the p-values seem not be correct anymore</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rx, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon)</span>
<span id="cb17-2">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-3">gg</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(rx))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(rx, sex))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="try-to-help-someone" class="level3">
<h3 class="anchored" data-anchor-id="try-to-help-someone">Try to help someone</h3>
<ul>
<li><a href="https://github.com/kassambara/survminer/issues/617">Link</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survival'</span>)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'survminer'</span>)</span>
<span id="cb20-4"></span>
<span id="cb20-5">text_to_add <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> text, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> y, </span>
<span id="cb20-7">          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Some text'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb20-8">          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Some other text'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb20-9"></span>
<span id="cb20-10">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colon)</span>
<span id="cb20-11">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit)</span>
<span id="cb20-12">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gray</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text),</span>
<span id="cb20-14">             text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">gg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>))</span>
<span id="cb21-2">gg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gray</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> text),</span>
<span id="cb21-4">             text_to_add, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="with-ggsurvfit" class="level2">
<h2 class="anchored" data-anchor-id="with-ggsurvfit">With ggsurvfit</h2>
<ul>
<li>Link to package: <a href="https://www.danieldsjoberg.com/ggsurvfit/index.html">Link</a></li>
<li>I found this package later – I don’t know why I haven’t across it earlier</li>
<li>At first glance, it seams actively maintained and seems to produce really nice plots</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggsurvfit'</span>)</span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(df_colon)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 929
Columns: 14
$ id       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…
$ rx       &lt;fct&gt; Levamisole+5-FU, Levamisole+5-FU, Observation, Levamisole+5-F…
$ sex      &lt;fct&gt; Male, Male, Female, Female, Male, Female, Male, Male, Male, F…
$ age      &lt;dbl&gt; 43, 63, 71, 66, 69, 57, 77, 54, 46, 68, 47, 52, 64, 68, 46, 6…
$ obstruct &lt;fct&gt; Not Obstructed, Not Obstructed, Not Obstructed, Obstructed, N…
$ perfor   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ adhere   &lt;fct&gt; Not Adhered, Not Adhered, Adhered, Not Adhered, Not Adhered, …
$ nodes    &lt;dbl&gt; 5, 1, 7, 6, 22, 9, 5, 1, 2, 1, 1, 2, 1, 3, 4, 1, 6, 1, 1, 1, …
$ status   &lt;dbl&gt; 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0…
$ differ   &lt;fct&gt; Moderate, Moderate, Moderate, Moderate, Moderate, Moderate, M…
$ extent   &lt;fct&gt; Serosa, Serosa, Muscle, Serosa, Serosa, Serosa, Serosa, Seros…
$ surg     &lt;fct&gt; Limited Time Since Surgery, Limited Time Since Surgery, Limit…
$ node4    &lt;dbl&gt; 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0…
$ time     &lt;dbl&gt; 2.6502396, 8.4517454, 1.4839151, 0.6707734, 1.4318960, 2.4750…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> surg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_colon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvfit</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_confidence_interval</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_risktable</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_quantile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_value =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-03-kaplan-meier-plots/2023-08-03-kaplan-meier-plots.html</guid>
  <pubDate>Wed, 02 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Reducing image file size with ImageMagick</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/2023-08-03-reducing-image-file-size-with-imagemagick.html</link>
  <description><![CDATA[ 



<section id="links" class="level2">
<h2 class="anchored" data-anchor-id="links">Links</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/7261855/recommendation-for-compressing-jpg-files-with-imagemagick">stackoverflow post recommandations for compressing</a></li>
<li><a href="https://stackoverflow.com/questions/6917219/imagemagick-scale-jpeg-image-with-a-maximum-file-size">stackoverflow maximum file size</a></li>
<li><a href="https://www.smashingmagazine.com/2015/06/efficient-image-resizing-with-imagemagick/">Extensive analysis of imagemagick options</a></li>
</ul>
</section>
<section id="initial-analysis" class="level2">
<h2 class="anchored" data-anchor-id="initial-analysis">Initial analysis</h2>
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_original.jpg" class="img-fluid" style="width:32.0%" data-fig-align="center" alt="Koga Original"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_signal.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center" alt="Koga Signal version"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_edited.jpg" class="img-fluid" style="width:32.0%" data-fig-align="center" alt="Koga ImageMagick"></p>
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_original.jpg" class="img-fluid" style="width:99.0%" data-fig-align="center" alt="Koga Original"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_signal.jpeg" class="img-fluid" style="width:99.0%" data-fig-align="center" alt="Koga Signal version"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/koga_edited.jpg" class="img-fluid" style="width:99.0%" data-fig-align="center" alt="Koga ImageMagick"></p>
</section>
<section id="currently-best-version" class="level2">
<h2 class="anchored" data-anchor-id="currently-best-version">Currently best version</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'convert koga_original.jpg -quality 50 -resize 2048 low_quality_3.jpg'</span>)</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/low_quality_3.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Currently best version</figcaption>
</figure>
</div>
</section>
<section id="even-a-lot-smaller" class="level2">
<h2 class="anchored" data-anchor-id="even-a-lot-smaller">Even a lot smaller</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'convert koga_original.jpg -quality 50 -resize 1024 low_quality_4.jpg'</span>)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'convert koga_original.jpg -quality 50 -resize 512 low_quality_5.jpg'</span>)</span></code></pre></div>
</div>
<p><img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/low_quality_4.jpg" class="img-fluid" alt="Even a lot smaller"> <img src="https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/low_quality_5.jpg" class="img-fluid" alt="Even a lot smaller"></p>
</section>
<section id="file-sizes" class="level2">
<h2 class="anchored" data-anchor-id="file-sizes">File sizes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fs'</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filenames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir_ls</span>(), </span>
<span id="cb3-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filesizes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file_size</span>(filenames)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 85%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">filenames</th>
<th style="text-align: center;">filesizes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2023-08-03-reducing-image-file-size-with-imagemagick.qmd</td>
<td style="text-align: center;">2.09K</td>
</tr>
<tr class="even">
<td style="text-align: center;">2023-08-03-reducing-image-file-size-with-imagemagick.rmarkdown</td>
<td style="text-align: center;">2.1K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2023-08-03-reducing-image-file-size-with-imagemagick_files</td>
<td style="text-align: center;">96</td>
</tr>
<tr class="even">
<td style="text-align: center;">koga_edited.jpg</td>
<td style="text-align: center;">193.93K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">koga_original.jpg</td>
<td style="text-align: center;">2.5M</td>
</tr>
<tr class="even">
<td style="text-align: center;">koga_signal.jpeg</td>
<td style="text-align: center;">505.13K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">low_quality_1.jpg</td>
<td style="text-align: center;">206.18K</td>
</tr>
<tr class="even">
<td style="text-align: center;">low_quality_2.jpg</td>
<td style="text-align: center;">516.7K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">low_quality_3.jpg</td>
<td style="text-align: center;">387.38K</td>
</tr>
<tr class="even">
<td style="text-align: center;">low_quality_4.jpg</td>
<td style="text-align: center;">206.18K</td>
</tr>
<tr class="odd">
<td style="text-align: center;">low_quality_5.jpg</td>
<td style="text-align: center;">146.79K</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

 ]]></description>
  <category>R</category>
  <category>Mishmash</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-03-reducing-image-file-size-with-imagemagick/2023-08-03-reducing-image-file-size-with-imagemagick.html</guid>
  <pubDate>Wed, 02 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Approximating Pi</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-23-approximating-pi/2023-07-23-approximating-pi.html</link>
  <description><![CDATA[ 



<p>This is a really pointless post about approximating <img src="https://latex.codecogs.com/png.latex?%5Cpi">, inspired by <a href="https://www.r-bloggers.com/2023/07/happy-pi-approximation-day/">this</a> post.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">current_min_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb1-2">current_best_numerator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span></span>
<span id="cb1-3">current_best_denominator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(denominator <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e7</span>) {</span>
<span id="cb1-6">  numerator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(denominator <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi)</span>
<span id="cb1-7">  pi_approx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> numerator <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denominator</span>
<span id="cb1-8">  pi_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pi_approx)</span>
<span id="cb1-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(pi_error <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> current_min_error) {</span>
<span id="cb1-10">    current_min_error <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pi_error</span>
<span id="cb1-11">    current_best_numerator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> numerator</span>
<span id="cb1-12">    current_best_denominator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> denominator</span>
<span id="cb1-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'numerator:'</span>, numerator, </span>
<span id="cb1-14">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', denominator:'</span>, denominator, </span>
<span id="cb1-15">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', pi_approx: '</span>, numerator <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denominator, </span>
<span id="cb1-16">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', absolute error'</span>, pi_error, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)))</span>
<span id="cb1-17">  }</span>
<span id="cb1-18">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numerator: 179 , denominator: 57 , pi_approx:  3.14035087719298 , absolute error 0.00124177639681067 
numerator: 201 , denominator: 64 , pi_approx:  3.140625 , absolute error 0.000967653589793116 
numerator: 223 , denominator: 71 , pi_approx:  3.14084507042254 , absolute error 0.000747583167258092 
numerator: 245 , denominator: 78 , pi_approx:  3.14102564102564 , absolute error 0.000567012564152147 
numerator: 267 , denominator: 85 , pi_approx:  3.14117647058824 , absolute error 0.000416183001557879 
numerator: 289 , denominator: 92 , pi_approx:  3.14130434782609 , absolute error 0.000288305763706198 
numerator: 311 , denominator: 99 , pi_approx:  3.14141414141414 , absolute error 0.000178512175651679 
numerator: 333 , denominator: 106 , pi_approx:  3.14150943396226 , absolute error 8.32196275291075e-05 
numerator: 355 , denominator: 113 , pi_approx:  3.14159292035398 , absolute error 2.66764189404967e-07 
numerator: 52163 , denominator: 16604 , pi_approx:  3.14159238737654 , absolute error 2.66213257216208e-07 
numerator: 52518 , denominator: 16717 , pi_approx:  3.14159239097924 , absolute error 2.62610550638698e-07 
numerator: 52873 , denominator: 16830 , pi_approx:  3.14159239453357 , absolute error 2.5905622225153e-07 
numerator: 53228 , denominator: 16943 , pi_approx:  3.14159239804049 , absolute error 2.55549304384317e-07 
numerator: 53583 , denominator: 17056 , pi_approx:  3.14159240150094 , absolute error 2.52088855123844e-07 
numerator: 53938 , denominator: 17169 , pi_approx:  3.14159240491584 , absolute error 2.48673956537715e-07 
numerator: 54293 , denominator: 17282 , pi_approx:  3.14159240828608 , absolute error 2.45303715118439e-07 
numerator: 54648 , denominator: 17395 , pi_approx:  3.14159241161253 , absolute error 2.41977260895254e-07 
numerator: 55003 , denominator: 17508 , pi_approx:  3.14159241489605 , absolute error 2.3869374565777e-07 
numerator: 55358 , denominator: 17621 , pi_approx:  3.14159241813745 , absolute error 2.35452343400055e-07 
numerator: 55713 , denominator: 17734 , pi_approx:  3.14159242133754 , absolute error 2.32252249432463e-07 
numerator: 56068 , denominator: 17847 , pi_approx:  3.14159242449711 , absolute error 2.29092678605269e-07 
numerator: 56423 , denominator: 17960 , pi_approx:  3.14159242761693 , absolute error 2.25972866640944e-07 
numerator: 56778 , denominator: 18073 , pi_approx:  3.14159243069773 , absolute error 2.22892067025526e-07 
numerator: 57133 , denominator: 18186 , pi_approx:  3.14159243374024 , absolute error 2.19849553229068e-07 
numerator: 57488 , denominator: 18299 , pi_approx:  3.14159243674518 , absolute error 2.16844615597012e-07 
numerator: 57843 , denominator: 18412 , pi_approx:  3.14159243971323 , absolute error 2.13876562682458e-07 
numerator: 58198 , denominator: 18525 , pi_approx:  3.14159244264507 , absolute error 2.10944719025719e-07 
numerator: 58553 , denominator: 18638 , pi_approx:  3.14159244554137 , absolute error 2.08048426042495e-07 
numerator: 58908 , denominator: 18751 , pi_approx:  3.14159244840275 , absolute error 2.05187041135702e-07 
numerator: 59263 , denominator: 18864 , pi_approx:  3.14159245122986 , absolute error 2.02359937251373e-07 
numerator: 59618 , denominator: 18977 , pi_approx:  3.14159245402329 , absolute error 1.995665015464e-07 
numerator: 59973 , denominator: 19090 , pi_approx:  3.14159245678366 , absolute error 1.96806136720795e-07 
numerator: 60328 , denominator: 19203 , pi_approx:  3.14159245951153 , absolute error 1.94078258353159e-07 
numerator: 60683 , denominator: 19316 , pi_approx:  3.1415924622075 , absolute error 1.91382296677034e-07 
numerator: 61038 , denominator: 19429 , pi_approx:  3.1415924648721 , absolute error 1.88717694804552e-07 
numerator: 61393 , denominator: 19542 , pi_approx:  3.14159246750588 , absolute error 1.86083908282342e-07 
numerator: 61748 , denominator: 19655 , pi_approx:  3.14159247010939 , absolute error 1.83480405979708e-07 
numerator: 62103 , denominator: 19768 , pi_approx:  3.14159247268312 , absolute error 1.80906668756364e-07 
numerator: 62458 , denominator: 19881 , pi_approx:  3.1415924752276 , absolute error 1.78362189018344e-07 
numerator: 62813 , denominator: 19994 , pi_approx:  3.14159247774332 , absolute error 1.7584647027391e-07 
numerator: 63168 , denominator: 20107 , pi_approx:  3.14159248023077 , absolute error 1.73359027577646e-07 
numerator: 63523 , denominator: 20220 , pi_approx:  3.14159248269041 , absolute error 1.70899387530454e-07 
numerator: 63878 , denominator: 20333 , pi_approx:  3.14159248512271 , absolute error 1.6846708605911e-07 
numerator: 64233 , denominator: 20446 , pi_approx:  3.14159248752812 , absolute error 1.66061670192619e-07 
numerator: 64588 , denominator: 20559 , pi_approx:  3.1415924899071 , absolute error 1.63682696285861e-07 
numerator: 64943 , denominator: 20672 , pi_approx:  3.14159249226006 , absolute error 1.61329731351856e-07 
numerator: 65298 , denominator: 20785 , pi_approx:  3.14159249458744 , absolute error 1.5900235039723e-07 
numerator: 65653 , denominator: 20898 , pi_approx:  3.14159249688965 , absolute error 1.56700138642663e-07 
numerator: 66008 , denominator: 21011 , pi_approx:  3.1415924991671 , absolute error 1.54422690190614e-07 
numerator: 66363 , denominator: 21124 , pi_approx:  3.14159250142019 , absolute error 1.52169607581243e-07 
numerator: 66718 , denominator: 21237 , pi_approx:  3.14159250364929 , absolute error 1.499405017924e-07 
numerator: 67073 , denominator: 21350 , pi_approx:  3.1415925058548 , absolute error 1.47734992239634e-07 
numerator: 67428 , denominator: 21463 , pi_approx:  3.14159250803709 , absolute error 1.45552705888008e-07 
numerator: 67783 , denominator: 21576 , pi_approx:  3.14159251019651 , absolute error 1.43393278584369e-07 
numerator: 68138 , denominator: 21689 , pi_approx:  3.14159251233344 , absolute error 1.41256352392816e-07 
numerator: 68493 , denominator: 21802 , pi_approx:  3.14159251444822 , absolute error 1.39141577371049e-07 
numerator: 68848 , denominator: 21915 , pi_approx:  3.14159251654118 , absolute error 1.37048611126289e-07 
numerator: 69203 , denominator: 22028 , pi_approx:  3.14159251861267 , absolute error 1.34977118371182e-07 
numerator: 69558 , denominator: 22141 , pi_approx:  3.14159252066302 , absolute error 1.32926769591535e-07 
numerator: 69913 , denominator: 22254 , pi_approx:  3.14159252269255 , absolute error 1.30897243266759e-07 
numerator: 70268 , denominator: 22367 , pi_approx:  3.14159252470157 , absolute error 1.28888223649426e-07 
numerator: 70623 , denominator: 22480 , pi_approx:  3.14159252669039 , absolute error 1.26899401653446e-07 
numerator: 70978 , denominator: 22593 , pi_approx:  3.14159252865932 , absolute error 1.2493047396589e-07 
numerator: 71333 , denominator: 22706 , pi_approx:  3.14159253060865 , absolute error 1.22981143491074e-07 
numerator: 71688 , denominator: 22819 , pi_approx:  3.14159253253867 , absolute error 1.21051119350568e-07 
numerator: 72043 , denominator: 22932 , pi_approx:  3.14159253444968 , absolute error 1.19140115995009e-07 
numerator: 72398 , denominator: 23045 , pi_approx:  3.14159253634194 , absolute error 1.17247853648195e-07 
numerator: 72753 , denominator: 23158 , pi_approx:  3.14159253821574 , absolute error 1.15374057862994e-07 
numerator: 73108 , denominator: 23271 , pi_approx:  3.14159254007133 , absolute error 1.13518459521345e-07 
numerator: 73463 , denominator: 23384 , pi_approx:  3.141592541909 , absolute error 1.11680795722435e-07 
numerator: 73818 , denominator: 23497 , pi_approx:  3.14159254372899 , absolute error 1.09860806229989e-07 
numerator: 74173 , denominator: 23610 , pi_approx:  3.14159254553155 , absolute error 1.08058238801334e-07 
numerator: 74528 , denominator: 23723 , pi_approx:  3.14159254731695 , absolute error 1.06272843414246e-07 
numerator: 74883 , denominator: 23836 , pi_approx:  3.14159254908542 , absolute error 1.04504376263748e-07 
numerator: 75238 , denominator: 23949 , pi_approx:  3.1415925508372 , absolute error 1.02752597541667e-07 
numerator: 75593 , denominator: 24062 , pi_approx:  3.14159255257252 , absolute error 1.0101727232481e-07 
numerator: 75948 , denominator: 24175 , pi_approx:  3.14159255429162 , absolute error 9.92981696867901e-08 
numerator: 76303 , denominator: 24288 , pi_approx:  3.14159255599473 , absolute error 9.75950631421085e-08 
numerator: 76658 , denominator: 24401 , pi_approx:  3.14159255768206 , absolute error 9.59077310902501e-08 
numerator: 77013 , denominator: 24514 , pi_approx:  3.14159255935384 , absolute error 9.42359545952343e-08 
numerator: 77368 , denominator: 24627 , pi_approx:  3.14159256101027 , absolute error 9.25795200501511e-08 
numerator: 77723 , denominator: 24740 , pi_approx:  3.14159256265158 , absolute error 9.0938216512626e-08 
numerator: 78078 , denominator: 24853 , pi_approx:  3.14159256427795 , absolute error 8.9311838813444e-08 
numerator: 78433 , denominator: 24966 , pi_approx:  3.14159256588961 , absolute error 8.77001831156576e-08 
numerator: 78788 , denominator: 25079 , pi_approx:  3.14159256748674 , absolute error 8.61030513554795e-08 
numerator: 79143 , denominator: 25192 , pi_approx:  3.14159256906955 , absolute error 8.45202472454787e-08 
numerator: 79498 , denominator: 25305 , pi_approx:  3.14159257063821 , absolute error 8.29515793832059e-08 
numerator: 79853 , denominator: 25418 , pi_approx:  3.14159257219293 , absolute error 8.13968590307468e-08 
numerator: 80208 , denominator: 25531 , pi_approx:  3.14159257373389 , absolute error 7.9855901002901e-08 
numerator: 80563 , denominator: 25644 , pi_approx:  3.14159257526127 , absolute error 7.83285232230924e-08 
numerator: 80918 , denominator: 25757 , pi_approx:  3.14159257677525 , absolute error 7.68145476115478e-08 
numerator: 81273 , denominator: 25870 , pi_approx:  3.141592578276 , absolute error 7.5313797864851e-08 
numerator: 81628 , denominator: 25983 , pi_approx:  3.14159257976369 , absolute error 7.38261016763886e-08 
numerator: 81983 , denominator: 26096 , pi_approx:  3.1415925812385 , absolute error 7.23512889599931e-08 
numerator: 82338 , denominator: 26209 , pi_approx:  3.1415925827006 , absolute error 7.08891940703893e-08 
numerator: 82693 , denominator: 26322 , pi_approx:  3.14159258415014 , absolute error 6.94396526945695e-08 
numerator: 83048 , denominator: 26435 , pi_approx:  3.14159258558729 , absolute error 6.80025036281506e-08 
numerator: 83403 , denominator: 26548 , pi_approx:  3.1415925870122 , absolute error 6.65775887753739e-08 
numerator: 83758 , denominator: 26661 , pi_approx:  3.14159258842504 , absolute error 6.51647527050159e-08 
numerator: 84113 , denominator: 26774 , pi_approx:  3.14159258982595 , absolute error 6.37638426503884e-08 
numerator: 84468 , denominator: 26887 , pi_approx:  3.14159259121509 , absolute error 6.237470762116e-08 
numerator: 84823 , denominator: 27000 , pi_approx:  3.14159259259259 , absolute error 6.09972006238024e-08 
numerator: 85178 , denominator: 27113 , pi_approx:  3.14159259395862 , absolute error 5.96311755529655e-08 
numerator: 85533 , denominator: 27226 , pi_approx:  3.1415925953133 , absolute error 5.82764898560129e-08 
numerator: 85888 , denominator: 27339 , pi_approx:  3.14159259665679 , absolute error 5.69330023125758e-08 
numerator: 86243 , denominator: 27452 , pi_approx:  3.14159259798922 , absolute error 5.56005756990885e-08 
numerator: 86598 , denominator: 27565 , pi_approx:  3.14159259931072 , absolute error 5.42790727919851e-08 
numerator: 86953 , denominator: 27678 , pi_approx:  3.14159260062143 , absolute error 5.29683608085918e-08 
numerator: 87308 , denominator: 27791 , pi_approx:  3.14159260192149 , absolute error 5.16683078544133e-08 
numerator: 87663 , denominator: 27904 , pi_approx:  3.14159260321101 , absolute error 5.03787838113112e-08 
numerator: 88018 , denominator: 28017 , pi_approx:  3.14159260449013 , absolute error 4.90996621138606e-08 
numerator: 88373 , denominator: 28130 , pi_approx:  3.14159260575898 , absolute error 4.78308170848152e-08 
numerator: 88728 , denominator: 28243 , pi_approx:  3.14159260701767 , absolute error 4.65721248232853e-08 
numerator: 89083 , denominator: 28356 , pi_approx:  3.14159260826633 , absolute error 4.53234649810952e-08 
numerator: 89438 , denominator: 28469 , pi_approx:  3.14159260950508 , absolute error 4.40847172100689e-08 
numerator: 89793 , denominator: 28582 , pi_approx:  3.14159261073403 , absolute error 4.28557647147443e-08 
numerator: 90148 , denominator: 28695 , pi_approx:  3.1415926119533 , absolute error 4.16364911437483e-08 
numerator: 90503 , denominator: 28808 , pi_approx:  3.14159261316301 , absolute error 4.04267828102434e-08 
numerator: 90858 , denominator: 28921 , pi_approx:  3.14159261436327 , absolute error 3.92265278037485e-08 
numerator: 91213 , denominator: 29034 , pi_approx:  3.14159261555418 , absolute error 3.80356151019612e-08 
numerator: 91568 , denominator: 29147 , pi_approx:  3.14159261673586 , absolute error 3.68539367912035e-08 
numerator: 91923 , denominator: 29260 , pi_approx:  3.14159261790841 , absolute error 3.56813858459759e-08 
numerator: 92278 , denominator: 29373 , pi_approx:  3.14159261907194 , absolute error 3.45178561289572e-08 
numerator: 92633 , denominator: 29486 , pi_approx:  3.14159262022655 , absolute error 3.33632450555399e-08 
numerator: 92988 , denominator: 29599 , pi_approx:  3.14159262137234 , absolute error 3.22174495970273e-08 
numerator: 93343 , denominator: 29712 , pi_approx:  3.14159262250942 , absolute error 3.10803693892581e-08 
numerator: 93698 , denominator: 29825 , pi_approx:  3.14159262363789 , absolute error 2.99519054003383e-08 
numerator: 94053 , denominator: 29938 , pi_approx:  3.14159262475783 , absolute error 2.88319603747311e-08 
numerator: 94408 , denominator: 30051 , pi_approx:  3.14159262586936 , absolute error 2.77204375009887e-08 
numerator: 94763 , denominator: 30164 , pi_approx:  3.14159262697255 , absolute error 2.66172430762879e-08 
numerator: 95118 , denominator: 30277 , pi_approx:  3.14159262806751 , absolute error 2.55222829537161e-08 
numerator: 95473 , denominator: 30390 , pi_approx:  3.14159262915433 , absolute error 2.44354660949853e-08 
numerator: 95828 , denominator: 30503 , pi_approx:  3.14159263023309 , absolute error 2.33567014618075e-08 
numerator: 96183 , denominator: 30616 , pi_approx:  3.14159263130389 , absolute error 2.22858997922515e-08 
numerator: 96538 , denominator: 30729 , pi_approx:  3.14159263236682 , absolute error 2.1222973600743e-08 
numerator: 96893 , denominator: 30842 , pi_approx:  3.14159263342196 , absolute error 2.01678358457968e-08 
numerator: 97248 , denominator: 30955 , pi_approx:  3.14159263446939 , absolute error 1.91204021504632e-08 
numerator: 97603 , denominator: 31068 , pi_approx:  3.14159263550921 , absolute error 1.80805876937029e-08 
numerator: 97958 , denominator: 31181 , pi_approx:  3.14159263654148 , absolute error 1.70483094308338e-08 
numerator: 98313 , denominator: 31294 , pi_approx:  3.14159263756631 , absolute error 1.60234865376196e-08 
numerator: 98668 , denominator: 31407 , pi_approx:  3.14159263858376 , absolute error 1.50060377457351e-08 
numerator: 99023 , denominator: 31520 , pi_approx:  3.14159263959391 , absolute error 1.39958844513899e-08 
numerator: 99378 , denominator: 31633 , pi_approx:  3.14159264059685 , absolute error 1.2992948050794e-08 
numerator: 99733 , denominator: 31746 , pi_approx:  3.14159264159264 , absolute error 1.19971517165141e-08 
numerator: 100088 , denominator: 31859 , pi_approx:  3.14159264258137 , absolute error 1.1008419065206e-08 
numerator: 100443 , denominator: 31972 , pi_approx:  3.14159264356312 , absolute error 1.00266754898826e-08 
numerator: 100798 , denominator: 32085 , pi_approx:  3.14159264453795 , absolute error 9.0518468276457e-09 
numerator: 101153 , denominator: 32198 , pi_approx:  3.14159264550593 , absolute error 8.08386113604342e-09 
numerator: 101508 , denominator: 32311 , pi_approx:  3.14159264646715 , absolute error 7.12264558444531e-09 
numerator: 101863 , denominator: 32424 , pi_approx:  3.14159264742166 , absolute error 6.1681300067562e-09 
numerator: 102218 , denominator: 32537 , pi_approx:  3.14159264836955 , absolute error 5.22024468097015e-09 
numerator: 102573 , denominator: 32650 , pi_approx:  3.14159264931087 , absolute error 4.27892032917043e-09 
numerator: 102928 , denominator: 32763 , pi_approx:  3.1415926502457 , absolute error 3.34408900570793e-09 
numerator: 103283 , denominator: 32876 , pi_approx:  3.14159265117411 , absolute error 2.41568454129037e-09 
numerator: 103638 , denominator: 32989 , pi_approx:  3.14159265209615 , absolute error 1.49363987844708e-09 
numerator: 103993 , denominator: 33102 , pi_approx:  3.1415926530119 , absolute error 5.77890624242627e-10 
numerator: 104348 , denominator: 33215 , pi_approx:  3.14159265392142 , absolute error 3.31628058347633e-10 
numerator: 208341 , denominator: 66317 , pi_approx:  3.14159265346744 , absolute error 1.22356347276309e-10 
numerator: 312689 , denominator: 99532 , pi_approx:  3.14159265361894 , absolute error 2.91433543964104e-11 
numerator: 833719 , denominator: 265381 , pi_approx:  3.14159265358108 , absolute error 8.71525074330748e-12 
numerator: 1146408 , denominator: 364913 , pi_approx:  3.1415926535914 , absolute error 1.61071156412618e-12 
numerator: 3126535 , denominator: 995207 , pi_approx:  3.14159265358865 , absolute error 1.14264153694421e-12 
numerator: 4272943 , denominator: 1360120 , pi_approx:  3.14159265358939 , absolute error 4.04121180963557e-13 
numerator: 5419351 , denominator: 1725033 , pi_approx:  3.14159265358982 , absolute error 2.22044604925031e-14 </code></pre>
</div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-23-approximating-pi/2023-07-23-approximating-pi.html</guid>
  <pubDate>Sat, 22 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Bicycle comparison</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/2023-07-23-bicycle-comparison.html</link>
  <description><![CDATA[ 



<section id="the-three-bikes" class="level2">
<h2 class="anchored" data-anchor-id="the-three-bikes">The three bikes</h2>
<p><img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/koga_old.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center"> <img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/koga_new.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center"> <img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/hammerbacher.jpeg" class="img-fluid" style="width:32.0%" data-fig-align="center"></p>
</section>
<section id="points-to-be-represented" class="level2">
<h2 class="anchored" data-anchor-id="points-to-be-represented">Points to be represented</h2>
<ul>
<li>front axis</li>
<li>back axis</li>
<li>front beginning of tire</li>
<li>back beginning of tire</li>
<li>handlebar low</li>
<li>handlebar high</li>
<li>saddle front</li>
<li>saddle back</li>
<li>pedals</li>
</ul>
<p>Coordinate system: Point 1 is front axis, point 2 is back of saddle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">loc_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'front_axis'</span>,</span>
<span id="cb1-2">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'back_axis'</span>,</span>
<span id="cb1-3">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'front_beginning_of_tire'</span>,</span>
<span id="cb1-4">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'back_beginning_of_tire'</span>,</span>
<span id="cb1-5">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'handlebar_low'</span>,</span>
<span id="cb1-6">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'handlebar_high'</span>,</span>
<span id="cb1-7">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'saddle_front'</span>,</span>
<span id="cb1-8">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'saddle_back'</span>,</span>
<span id="cb1-9">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pedals'</span>)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'digitize'</span>)</span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">load</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'not_yet_formatted.Rdata'</span>)</span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save(list = c('koga_new', 'koga_old', 'hammerbacher'), file = 'not_yet_formatted.Rdata')</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># help(package = 'digitize')</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># koga_old &lt;- digitize('koga_old.jpeg')</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># koga_new &lt;- digitize('koga_new.jpeg')</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hammerbacher &lt;- digitize('hammerbacher.jpeg')</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21">tidy_digit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(dat) {</span>
<span id="cb1-22">  var_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deparse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substitute</span>(dat))</span>
<span id="cb1-23">  dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var_name =</span> var_name,</span>
<span id="cb1-26">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">loc =</span> loc_names)</span>
<span id="cb1-27">}</span>
<span id="cb1-28"></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_new)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
         x        y var_name loc                    
     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;                  
1 -0.00334 -0.00309 koga_new front_axis             
2  1.07     0.0401  koga_new back_axis              
3 -0.321   -0.0679  koga_new front_beginning_of_tire
4  1.08    -0.383   koga_new back_beginning_of_tire 
5  0.207    1.02    koga_new handlebar_low          
6  0.0870   1.12    koga_new handlebar_high         
7  0.722    0.978   koga_new saddle_front           
8  0.997    0.994   koga_new saddle_back            
9  0.622   -0.0432  koga_new pedals                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_old)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
          x        y var_name loc                    
      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;                  
1  3.33e-16 -0.00317 koga_old front_axis             
2  1.14e+ 0  0.0190  koga_old back_axis              
3 -3.33e- 1  0.0254  koga_old front_beginning_of_tire
4  1.15e+ 0 -0.410   koga_old back_beginning_of_tire 
5  2.46e- 1  1.03    koga_old handlebar_low          
6  1.01e- 1  1.19    koga_old handlebar_high         
7  7.25e- 1  0.952   koga_old saddle_front           
8  9.96e- 1  0.997   koga_old saddle_back            
9  6.63e- 1 -0.0698  koga_old pedals                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(hammerbacher)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
         x        y var_name     loc                    
     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;                  
1  0.00376  0.00599 hammerbacher front_axis             
2  1.20     0.0659  hammerbacher back_axis              
3 -0.331   -0.150   hammerbacher front_beginning_of_tire
4  0.932   -0.275   hammerbacher back_beginning_of_tire 
5  0.256    1.32    hammerbacher handlebar_low          
6  0.256    1.32    hammerbacher handlebar_high         
7  0.737    0.946   hammerbacher saddle_front           
8  0.996    0.994   hammerbacher saddle_back            
9  0.695   -0.0419  hammerbacher pedals                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">dd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_old), </span>
<span id="cb7-2">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(koga_new),</span>
<span id="cb7-3">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_digit</span>(hammerbacher))</span>
<span id="cb7-4"></span>
<span id="cb7-5">dd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> var_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/2023-07-23-bicycle-comparison_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(dd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bikes.csv'</span>)</span></code></pre></div>
</div>
</section>
<section id="todo" class="level2">
<h2 class="anchored" data-anchor-id="todo">Todo:</h2>
<ul>
<li>measure distance between axes</li>
<li>measure distance between</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-23-bicycle-comparison/2023-07-23-bicycle-comparison.html</guid>
  <pubDate>Sat, 22 Jul 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>First pytorch tutorial</title>
  <link>https://sbloggel.netlify.app/posts/2023-07-21-first-pytorch-tutorial/2023-07-21-first-pytorch-tutorial.html</link>
  <description><![CDATA[ 



<ul>
<li><a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">Link to tutorial</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'machine_learning'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nn</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datasets</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: 'dlopen(/Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/image.so, 0x0006): Symbol not found: __ZN3c106detail19maybe_wrap_dim_slowIxEET_S2_S2_b
  Referenced from: &lt;8CBD0B78-6C7C-3C8B-8C76-ACA7B6112818&gt; /Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torchvision/image.so
  Expected in:     &lt;07CB8E54-8386-3606-A01E-B92223F93B74&gt; /Users/seb/Library/r-miniconda-arm64/envs/machine_learning/lib/python3.9/site-packages/torch/lib/libc10.dylib'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.transforms <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ToTensor</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download training data from open datasets.</span></span>
<span id="cb6-4">training_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datasets.FashionMNIST(</span>
<span id="cb6-5">    root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>,</span>
<span id="cb6-6">    train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-7">    download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-8">    transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor(),</span>
<span id="cb6-9">)</span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download test data from open datasets.</span></span>
<span id="cb6-12">test_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datasets.FashionMNIST(</span>
<span id="cb6-13">    root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>,</span>
<span id="cb6-14">    train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb6-15">    download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb6-16">    transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ToTensor(),</span>
<span id="cb6-17">)</span>
<span id="cb6-18"></span>
<span id="cb6-19"></span>
<span id="cb6-20">training_data.data.shape</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([60000, 28, 28])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">test_data.data.shape</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([10000, 28, 28])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create data loaders.</span></span>
<span id="cb10-4">train_dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(training_data, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size)</span>
<span id="cb10-5">test_dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(test_data, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>batch_size)</span>
<span id="cb10-6"></span>
<span id="cb10-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> X, y <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> test_dataloader:</span>
<span id="cb10-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Shape of X [N, C, H, W]: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>X<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Shape of y: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dtype<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of X [N, C, H, W]: torch.Size([64, 1, 28, 28])
Shape of y: torch.Size([64]) torch.int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get cpu, gpu or mps device for training.</span></span>
<span id="cb12-2">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb12-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span></span>
<span id="cb12-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available()</span>
<span id="cb12-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mps"</span></span>
<span id="cb12-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.backends.mps.is_available()</span>
<span id="cb12-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpu"</span></span>
<span id="cb12-8">)</span>
<span id="cb12-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Using </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>device<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> device"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Using mps device</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define model</span></span>
<span id="cb14-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb14-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb14-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb14-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.flatten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Flatten()</span>
<span id="cb14-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.linear_relu_stack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.Sequential(</span>
<span id="cb14-7">            nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>),</span>
<span id="cb14-8">            nn.ReLU(),</span>
<span id="cb14-9">            nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>),</span>
<span id="cb14-10">            nn.ReLU(),</span>
<span id="cb14-11">            nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb14-12">        )</span>
<span id="cb14-13"></span>
<span id="cb14-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x):</span>
<span id="cb14-15">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.flatten(x)</span>
<span id="cb14-16">        logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.linear_relu_stack(x)</span>
<span id="cb14-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> logits</span>
<span id="cb14-18"></span>
<span id="cb14-19">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NeuralNetwork().to(device)</span>
<span id="cb14-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(model)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NeuralNetwork(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_relu_stack): Sequential(
    (0): Linear(in_features=784, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=512, bias=True)
    (3): ReLU()
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">loss_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.CrossEntropyLoss()</span>
<span id="cb16-2">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.SGD(model.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> train(dataloader, model, loss_fn, optimizer):</span>
<span id="cb17-2">    size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader.dataset)</span>
<span id="cb17-3">    model.train()</span>
<span id="cb17-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> batch, (X, y) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(dataloader):</span>
<span id="cb17-5">        X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.to(device), y.to(device)</span>
<span id="cb17-6"></span>
<span id="cb17-7">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute prediction error</span></span>
<span id="cb17-8">        pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(X)</span>
<span id="cb17-9">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_fn(pred, y)</span>
<span id="cb17-10"></span>
<span id="cb17-11">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backpropagation</span></span>
<span id="cb17-12">        loss.backward()</span>
<span id="cb17-13">        optimizer.step()</span>
<span id="cb17-14">        optimizer.zero_grad()</span>
<span id="cb17-15"></span>
<span id="cb17-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb17-17">            loss, current <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss.item(), (batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(X)</span>
<span id="cb17-18">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;7f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">  [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>current<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;5d}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>size<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;5d}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">]"</span>)</span>
<span id="cb17-19">            </span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> test(dataloader, model, loss_fn):</span>
<span id="cb18-2">    size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader.dataset)</span>
<span id="cb18-3">    num_batches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader)</span>
<span id="cb18-4">    model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb18-5">    test_loss, correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb18-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb18-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> X, y <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> dataloader:</span>
<span id="cb18-8">            X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.to(device), y.to(device)</span>
<span id="cb18-9">            pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(X)</span>
<span id="cb18-10">            test_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> loss_fn(pred, y).item()</span>
<span id="cb18-11">            correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> (pred.argmax(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>().item()</span>
<span id="cb18-12">    test_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> num_batches</span>
<span id="cb18-13">    correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> size</span>
<span id="cb18-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Test Error: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> Accuracy: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>correct)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;0.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%, Avg loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>test_loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:&gt;8f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">epochs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb19-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(epochs):</span>
<span id="cb19-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-------------------------------"</span>)</span>
<span id="cb19-4">    train(train_dataloader, model, loss_fn, optimizer)</span>
<span id="cb19-5">    test(test_dataloader, model, loss_fn)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1
-------------------------------
loss: 2.293884  [   64/60000]
loss: 2.280516  [ 6464/60000]
loss: 2.254215  [12864/60000]
loss: 2.257743  [19264/60000]
loss: 2.241249  [25664/60000]
loss: 2.206033  [32064/60000]
loss: 2.222995  [38464/60000]
loss: 2.183638  [44864/60000]
loss: 2.180845  [51264/60000]
loss: 2.147983  [57664/60000]
Test Error: 
 Accuracy: 40.3%, Avg loss: 2.137891 

Epoch 2
-------------------------------
loss: 2.147081  [   64/60000]
loss: 2.142349  [ 6464/60000]
loss: 2.073414  [12864/60000]
loss: 2.100391  [19264/60000]
loss: 2.053971  [25664/60000]
loss: 1.983526  [32064/60000]
loss: 2.020415  [38464/60000]
loss: 1.931436  [44864/60000]
loss: 1.939984  [51264/60000]
loss: 1.877790  [57664/60000]
Test Error: 
 Accuracy: 56.7%, Avg loss: 1.862921 

Epoch 3
-------------------------------
loss: 1.894928  [   64/60000]
loss: 1.875024  [ 6464/60000]
loss: 1.740222  [12864/60000]
loss: 1.794675  [19264/60000]
loss: 1.693364  [25664/60000]
loss: 1.631936  [32064/60000]
loss: 1.665979  [38464/60000]
loss: 1.550617  [44864/60000]
loss: 1.587191  [51264/60000]
loss: 1.492842  [57664/60000]
Test Error: 
 Accuracy: 60.1%, Avg loss: 1.494139 

Epoch 4
-------------------------------
loss: 1.558476  [   64/60000]
loss: 1.533684  [ 6464/60000]
loss: 1.366379  [12864/60000]
loss: 1.457518  [19264/60000]
loss: 1.342172  [25664/60000]
loss: 1.323192  [32064/60000]
loss: 1.354460  [38464/60000]
loss: 1.258602  [44864/60000]
loss: 1.304382  [51264/60000]
loss: 1.218093  [57664/60000]
Test Error: 
 Accuracy: 63.1%, Avg loss: 1.229637 

Epoch 5
-------------------------------
loss: 1.300160  [   64/60000]
loss: 1.291894  [ 6464/60000]
loss: 1.113367  [12864/60000]
loss: 1.240308  [19264/60000]
loss: 1.116215  [25664/60000]
loss: 1.128032  [32064/60000]
loss: 1.166063  [38464/60000]
loss: 1.082035  [44864/60000]
loss: 1.127863  [51264/60000]
loss: 1.062129  [57664/60000]
Test Error: 
 Accuracy: 64.9%, Avg loss: 1.068099 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Done!"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Done!</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">torch.save(model.state_dict(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.pth"</span>)</span>
<span id="cb23-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saved PyTorch Model State to model.pth"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saved PyTorch Model State to model.pth</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> NeuralNetwork().to(device)</span>
<span id="cb25-2">model.load_state_dict(torch.load(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.pth"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;All keys matched successfully&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">classes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb27-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-shirt/top"</span>,</span>
<span id="cb27-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trouser"</span>,</span>
<span id="cb27-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pullover"</span>,</span>
<span id="cb27-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dress"</span>,</span>
<span id="cb27-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coat"</span>,</span>
<span id="cb27-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sandal"</span>,</span>
<span id="cb27-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shirt"</span>,</span>
<span id="cb27-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sneaker"</span>,</span>
<span id="cb27-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bag"</span>,</span>
<span id="cb27-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ankle boot"</span>,</span>
<span id="cb27-12">]</span>
<span id="cb27-13"></span>
<span id="cb27-14">model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NeuralNetwork(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_relu_stack): Sequential(
    (0): Linear(in_features=784, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=512, bias=True)
    (3): ReLU()
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> test_data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], test_data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb29-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb29-3">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x.to(device)</span>
<span id="cb29-4">    pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x)</span>
<span id="cb29-5">    predicted, actual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classes[pred[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].argmax(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)], classes[y]</span>
<span id="cb29-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Predicted: "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>predicted<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">", Actual: "</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>actual<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Predicted: "Ankle boot", Actual: "Ankle boot"</code></pre>
</div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2023-07-21-first-pytorch-tutorial/2023-07-21-first-pytorch-tutorial.html</guid>
  <pubDate>Thu, 20 Jul 2023 22:00:00 GMT</pubDate>
</item>
</channel>
</rss>
