<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Seb&#39;s blog</title>
<link>https://sbloggel.netlify.app/index.html</link>
<atom:link href="https://sbloggel.netlify.app/index.xml" rel="self" type="application/rss+xml"/>
<description>Seb&#39;s private blog about statistics and other topics</description>
<generator>quarto-1.3.433</generator>
<lastBuildDate>Wed, 18 Jan 2023 23:00:00 GMT</lastBuildDate>
<item>
  <title>SIRS model dynamics</title>
  <dc:creator>Sebastian Gerdes</dc:creator>
  <link>https://sbloggel.netlify.app/posts/2023-01-20-sirs-model-dynamics/index.html</link>
  <description><![CDATA[ 



<section id="loading-the-required-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-required-libraries">Loading the required libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggplot2'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deSolve'</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>())</span></code></pre></div>
</div>
</section>
<section id="simulate-odes" class="level2">
<h2 class="anchored" data-anchor-id="simulate-odes">Simulate ODEs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">sir_ode_deterministic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(t, state, pars) {</span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(state, pars)), {</span>
<span id="cb2-3">    dS <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> S <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> R</span>
<span id="cb2-4">    dI <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> S <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gamma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> I</span>
<span id="cb2-5">    dR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gamma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> R</span>
<span id="cb2-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dS =</span> dS, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dI =</span> dI, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dR =</span> dR)))</span>
<span id="cb2-7">  }) </span>
<span id="cb2-8">}</span>
<span id="cb2-9"></span>
<span id="cb2-10"></span>
<span id="cb2-11">infected_initial <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb2-12">initial_condition <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">S =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> infected_initial,</span>
<span id="cb2-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">I =</span> infected_initial,</span>
<span id="cb2-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">R =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-16"></span>
<span id="cb2-17">step_length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-18">max_time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-19">timepoints <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, max_time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> step_length)</span>
<span id="cb2-20">grid_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-21">grid_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-22">grid_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-23"></span>
<span id="cb2-24">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>()</span>
<span id="cb2-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(beta <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> grid_values) {</span>
<span id="cb2-26">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(gamma <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> grid_values) {</span>
<span id="cb2-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(lambda <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> grid_values) {</span>
<span id="cb2-28">      parameters <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> beta, </span>
<span id="cb2-29">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gamma =</span> gamma,</span>
<span id="cb2-30">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> lambda)</span>
<span id="cb2-31">      solution <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ode</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> initial_condition, </span>
<span id="cb2-32">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> timepoints,</span>
<span id="cb2-33">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">func =</span> sir_ode_deterministic,</span>
<span id="cb2-34">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parms =</span> parameters) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-35">        unclass <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> as_tibble</span>
<span id="cb2-36">      solution<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> beta</span>
<span id="cb2-37">      solution<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gamma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gamma</span>
<span id="cb2-38">      solution<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lambda</span>
<span id="cb2-39">      result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(result, solution)</span>
<span id="cb2-40">    }</span>
<span id="cb2-41">  }</span>
<span id="cb2-42">}</span>
<span id="cb2-43"></span>
<span id="cb2-44">result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(result, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'S'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'I'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span>))</span>
<span id="cb2-45"></span>
<span id="cb2-46">last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> result <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> max_time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(name, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'S'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'I'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span>)))</span>
<span id="cb2-49"></span>
<span id="cb2-50">last <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(beta, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(gamma), </span>
<span id="cb2-54">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(lambda), </span>
<span id="cb2-55">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Fraction'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Compartment'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trans=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log10'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-01-20-sirs-model-dynamics/index_files/figure-html/explore_model_dynamics-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">last <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> beta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_area</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(gamma), </span>
<span id="cb3-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(lambda), </span>
<span id="cb3-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Fraction'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Compartment'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trans=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log10'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-01-20-sirs-model-dynamics/index_files/figure-html/explore_model_dynamics-2.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">ss <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> last <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(beta, gamma, lambda) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ss =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(value))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'beta', 'gamma'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="analytical-approach" class="level2">
<h2 class="anchored" data-anchor-id="analytical-approach">Analytical approach</h2>
<p>Solution in terms of parameters in red.</p>
<section id="equilibrium-conditions" class="level3">
<h3 class="anchored" data-anchor-id="equilibrium-conditions">Equilibrium conditions</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A1%20&amp;=%20S%20+%20I%20+%20R%20%20%5Cqquad%20&amp;(1)%20%5C%5C%0A0%20&amp;=%20-%5Cbeta%20I%20S%20+%20%5Clambda%20R%20%5Cqquad%20&amp;(2)%20%5C%5C%0A0%20&amp;=%20%5Cbeta%20I%20S%20-%20%5Cgamma%20I%20%5Cqquad%20&amp;(3)%20%5C%5C%0A0%20&amp;=%20%5Cgamma%20I%20-%20%5Clambda%20R%20%5Cqquad%20&amp;(4)%0A%5Cend%7Balign%7D%0A"></p>
</section>
<section id="algebraic-transformation" class="level3">
<h3 class="anchored" data-anchor-id="algebraic-transformation">Algebraic transformation</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AR%20&amp;=%201%20-%20S%20-%20I%20%5Cqquad%20&amp;(1b)%20%5C%5C%0AS%20&amp;=%20%5Cgamma%20/%20%5Cbeta%20%5Cqquad%20&amp;(3b)%0A%5Cend%7Balign%7D%0A"></p>
</section>
<section id="plugging-in" class="level3">
<h3 class="anchored" data-anchor-id="plugging-in">Plugging in</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A(3b)%20%5Crightarrow%20(2):%20%5Cquad%20I%20&amp;=%20%5Clambda%20/%20%5Cgamma%20R%20%20%5Cqquad%20&amp;(5)%20%5C%5C%0A(1b)%20%5Crightarrow%20(5):%20%5Cquad%20I%20&amp;=%20%5Cfrac%7B%5Clambda(%5Cbeta%20-%20%5Cgamma)%7D%7B%5Cbeta(%5Cgamma%20+%20%5Clambda)%7D%20%5Cqquad%20&amp;(6)%20%5C%5C%0A(3b)%20+%20(6)%20%5Crightarrow%20(1b):%20R%20&amp;=%20%5Cfrac%7B%5Cgamma(%5Cbeta%20-%20%5Cgamma)%7D%7B%5Cbeta(%5Cgamma%20+%20%5Clambda)%7D%20%5Cqquad%20&amp;(7)%0A%5Cend%7Balign%7D%0A"></p>
</section>
<section id="plots" class="level3">
<h3 class="anchored" data-anchor-id="plots">Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">last_w <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(last, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> name, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> value)</span>
<span id="cb6-2">last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>S_calc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gamma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta)</span>
<span id="cb6-3">last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>I_calc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(last_w, (lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gamma))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb6-5">                 (beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (gamma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lambda))))</span>
<span id="cb6-6">last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>R_calc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(last_w, (gamma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gamma)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb6-8">                         (beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (gamma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lambda)))))</span>
<span id="cb6-9"></span>
<span id="cb6-10">last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>I_calc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>S_calc <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> last_w<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>R_calc</span>
<span id="cb6-11"></span>
<span id="cb6-12">last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> last_w <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'S_calc'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'I_calc'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R_calc'</span>))</span>
<span id="cb6-14"></span>
<span id="cb6-15"></span>
<span id="cb6-16">last <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> beta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_area</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(gamma), </span>
<span id="cb6-20">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(lambda), </span>
<span id="cb6-21">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Fraction'</span>,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Compartment'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trans=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log10'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-01-20-sirs-model-dynamics/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-01-20-sirs-model-dynamics/index.html</guid>
  <pubDate>Wed, 18 Jan 2023 23:00:00 GMT</pubDate>
</item>
</channel>
</rss>
