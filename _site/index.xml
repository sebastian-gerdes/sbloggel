<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Seb&#39;s blog</title>
<link>https://sbloggel.netlify.app/index.html</link>
<atom:link href="https://sbloggel.netlify.app/index.xml" rel="self" type="application/rss+xml"/>
<description>Seb&#39;s private blog about statistics and other topics</description>
<generator>quarto-1.3.433</generator>
<lastBuildDate>Tue, 26 Mar 2024 23:00:00 GMT</lastBuildDate>
<item>
  <title>Clone size distributions</title>
  <link>https://sbloggel.netlify.app/posts/2024-03-27-clone-size-distributions/2024-03-27-clone-size-distributions.html</link>
  <description><![CDATA[ 



<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb2-2">nr_of_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000000</span></span>
<span id="cb2-3">cell_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((nr_of_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n))</span>
<span id="cb2-4">cell_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, ] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, nr_of_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb2-7">  cell_ids[i, ] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cell_ids[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ]</span>
<span id="cb2-8">  ii_death <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-9">  ii_birth <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-10">  cell_ids[i, ii_death] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cell_ids[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ii_birth]</span>
<span id="cb2-11"></span>
<span id="cb2-12">np.column_stack(np.unique(cell_ids[nr_of_steps], return_counts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[ 857., 1000.]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb4-2">nr_of_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb4-3">cell_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(n)</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(nr_of_steps):</span>
<span id="cb4-6">  ii_death <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-7">  ii_birth <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-8">  cell_ids[ii_death] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cell_ids[ii_birth]</span>
<span id="cb4-9"></span>
<span id="cb4-10">np.column_stack(np.unique(cell_ids, return_counts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[ 0,  7],
       [ 4,  6],
       [ 5,  3],
       [18,  4]])</code></pre>
</div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2024-03-27-clone-size-distributions/2024-03-27-clone-size-distributions.html</guid>
  <pubDate>Tue, 26 Mar 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Testing shinylive</title>
  <link>https://sbloggel.netlify.app/posts/2024-03-11-testing-shinylive/2024-03-11-testing-shinylive.html</link>
  <description><![CDATA[ 






 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2024-03-11-testing-shinylive/2024-03-11-testing-shinylive.html</guid>
  <pubDate>Sun, 10 Mar 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Simulating data in Python</title>
  <link>https://sbloggel.netlify.app/posts/2024-01-22-simulating-data-in-python/2024-01-22-simulating-data-in-python.html</link>
  <description><![CDATA[ 



<section id="which-environment" class="level2">
<h2 class="anchored" data-anchor-id="which-environment">Which environment?</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> get_env():</span>
<span id="cb1-4">    sp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sys.path[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb1-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"envs"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> sp:</span>
<span id="cb1-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sp[sp.index(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"envs"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb1-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">get_env()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>'fast_ai_course_2022'</code></pre>
</div>
</div>
</section>
<section id="importing-the-required-libraries" class="level2">
<h2 class="anchored" data-anchor-id="importing-the-required-libraries">Importing the required libraries</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb3-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> patsy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dmatrices, dmatrix</span></code></pre></div>
</div>
</section>
<section id="simulating-the-data" class="level2">
<h2 class="anchored" data-anchor-id="simulating-the-data">Simulating the data</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb4-2">sd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-3"></span>
<span id="cb4-4">dat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame()</span>
<span id="cb4-5">dat[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.normal(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, n)</span>
<span id="cb4-6">dat[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.normal(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, n)</span>
<span id="cb4-7">dat[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x3"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.choice([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>], size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n, replace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb4-8">dat[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"epsilon"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.normal(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, sd, n)</span>
<span id="cb4-9">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dmatrix(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ~ x1 + x2 + x3"</span>, dat)</span>
<span id="cb4-10">X.design_info.column_names</span>
<span id="cb4-11">beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span></code></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">dat[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.matmul(X, beta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dat[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"epsilon"</span>]</span>
<span id="cb5-2">dat</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x1</th>
<th data-quarto-table-cell-role="th">x2</th>
<th data-quarto-table-cell-role="th">x3</th>
<th data-quarto-table-cell-role="th">epsilon</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-7.579337</td>
<td>-1.600375</td>
<td>B</td>
<td>1.394259</td>
<td>61.015673</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.827419</td>
<td>1.912467</td>
<td>B</td>
<td>-2.066038</td>
<td>59.936446</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.916864</td>
<td>3.079072</td>
<td>B</td>
<td>-2.647573</td>
<td>56.111148</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-8.580745</td>
<td>11.137583</td>
<td>B</td>
<td>-0.409475</td>
<td>32.734615</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>11.100234</td>
<td>4.150596</td>
<td>B</td>
<td>0.588830</td>
<td>67.387871</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>-5.862918</td>
<td>-7.058553</td>
<td>B</td>
<td>-1.026161</td>
<td>71.228028</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>3.791414</td>
<td>2.979757</td>
<td>A</td>
<td>-2.858461</td>
<td>8.973439</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>4.200092</td>
<td>3.668948</td>
<td>B</td>
<td>-1.505371</td>
<td>59.356825</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>-0.381726</td>
<td>-1.413223</td>
<td>B</td>
<td>2.492208</td>
<td>68.936928</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>-6.374441</td>
<td>-0.552026</td>
<td>A</td>
<td>3.637649</td>
<td>12.367261</td>
</tr>
</tbody>
</table>

<p>100 rows Ã— 5 columns</p>
</div>
</div>
</div>
</section>
<section id="showing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="showing-the-data">Showing the data</h2>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">sns.scatterplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dat, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2024-01-22-simulating-data-in-python/2024-01-22-simulating-data-in-python_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">sns.scatterplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dat, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2024-01-22-simulating-data-in-python/2024-01-22-simulating-data-in-python_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">sns.scatterplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dat, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x3"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2024-01-22-simulating-data-in-python/2024-01-22-simulating-data-in-python_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>

 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2024-01-22-simulating-data-in-python/2024-01-22-simulating-data-in-python.html</guid>
  <pubDate>Sun, 21 Jan 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Plotnine and sample data sets from statsmodels</title>
  <link>https://sbloggel.netlify.app/posts/2024-01-15-plotnine-and-sample-data-sets-from-statsmodels/2024-01-15-plotnine-and-sample-data-sets-from-statsmodels.html</link>
  <description><![CDATA[ 



<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> statsmodels.api <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sm</span>
<span id="cb1-2">cars <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sm.datasets.get_rdataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cars"</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>]</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> plotnine <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ggplot, aes, geom_point</span>
<span id="cb1-4">p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ggplot(cars, aes(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"speed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dist"</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_point()</span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># p.save("test.pdf", width = 24, height = 24)</span></span>
<span id="cb1-6">p</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Figure Size: (640 x 480)&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2024-01-15-plotnine-and-sample-data-sets-from-statsmodels/2024-01-15-plotnine-and-sample-data-sets-from-statsmodels_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="614"></p>
</div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2024-01-15-plotnine-and-sample-data-sets-from-statsmodels/2024-01-15-plotnine-and-sample-data-sets-from-statsmodels.html</guid>
  <pubDate>Sun, 14 Jan 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Understanding competing risks</title>
  <link>https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks.html</link>
  <description><![CDATA[ 



<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(survival)</span></code></pre></div>
</div>
<ul>
<li>Kaplan-Meier-Estimator:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb2-2">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_event_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rexp</span>(n), </span>
<span id="cb2-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_event_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rexp</span>(n), </span>
<span id="cb2-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_observed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmin</span>(t_event_1, t_event_2), </span>
<span id="cb2-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">event =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(t_event_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> t_event_2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb2-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status_event_1 =</span> t_event_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> t_event_2, </span>
<span id="cb2-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status_event_2 =</span> t_event_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> t_event_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(t_observed)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">s_event_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>t_event_1, status_event_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb3-2">s_event_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>t_event_2, status_event_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb3-3">                                    </span>
<span id="cb3-4">inc_event_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stepfun</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(s_event_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_event_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>surv))</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(inc_event_1)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks_files/figure-html/competing_risks_km-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">inc_event_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stepfun</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(s_event_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_event_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>surv))</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(inc_event_2)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks_files/figure-html/competing_risks_km-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inc_event_1</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inc_event_2</span>(x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks_files/figure-html/competing_risks_km-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">s_event_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>t_event_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb6-2">s_event_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survfit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>t_event_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb6-3"></span>
<span id="cb6-4">inc_event_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stepfun</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(s_event_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_event_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>surv))</span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(inc_event_1)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks_files/figure-html/without_censoring-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">inc_event_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stepfun</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(s_event_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_event_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>surv))</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(inc_event_2)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks_files/figure-html/without_censoring-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inc_event_1</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inc_event_2</span>(x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks_files/figure-html/without_censoring-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">dd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">event_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, </span>
<span id="cb9-2">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">no_event =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">event_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">event_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>t_observed))</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n) {</span>
<span id="cb9-8">  dd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>event_1[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>event_1[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>event[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb9-9">  dd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>event_2[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>event_2[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>event[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb9-10">}</span>
<span id="cb9-11"></span>
<span id="cb9-12">dd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(no_event, event_1, event_2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(time, value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_area</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Individuals'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks_files/figure-html/area_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>



 ]]></description>
  <category>R</category>
  <category>Self-study</category>
  <guid>https://sbloggel.netlify.app/posts/2023-11-19-understanding-competing-risks/2023-11-19-understanding-competing-risks.html</guid>
  <pubDate>Sat, 18 Nov 2023 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Quantifizierung von Alkoholintoxikation</title>
  <link>https://sbloggel.netlify.app/posts/2023-10-17-quantifizierung-von-alkoholintoxikation/2023-10-17-quantifizierung-von-alkoholintoxikation.html</link>
  <description><![CDATA[ 



<p><a href="https://psychiatrietogo.de/tag/atemalkohol/">Link</a> zu Jan Drehers Beitrag</p>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-10-17-quantifizierung-von-alkoholintoxikation/2023-10-17-quantifizierung-von-alkoholintoxikation.html</guid>
  <pubDate>Mon, 16 Oct 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Understanding the multivariate normal distribution</title>
  <link>https://sbloggel.netlify.app/posts/2023-10-10-understanding-the-multivariate-normal-distribution/2023-10-10-understanding-the-multivariate-normal-distribution.html</link>
  <description><![CDATA[ 



<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<p><a href="https://stats.stackexchange.com/questions/628367/how-do-i-adequately-calculate-the-distribution-of-function-of-the-multivariate-n">Link to question at stackexchange</a></p>
<section id="relations" class="level2">
<h2 class="anchored" data-anchor-id="relations">Relations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span></span>
<span id="cb2-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n)</span>
<span id="cb2-3">p_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pnorm</span>(x)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecdf</span>(p_values))</span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dotted'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-10-10-understanding-the-multivariate-normal-distribution/2023-10-10-understanding-the-multivariate-normal-distribution_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># help(package = 'mvtnorm')</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># help(package = 'multcomp')</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mvtnorm'</span>)</span>
<span id="cb3-5">var_x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-6">var_x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-7">cov_x1_x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb3-8">sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(var_x1, cov_x1_x2), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(cov_x1_x2, var_x2))</span>
<span id="cb3-9">sigma</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]  1.0  0.3
[2,]  0.3  1.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rmvnorm</span>(n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> sigma)</span>
<span id="cb5-2"></span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># calc_p &lt;- function(x) {</span></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pmvnorm(lower = -abs(x),</span></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           upper = abs(x),</span></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           sigma = sigma)</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># }</span></span>
<span id="cb5-9"></span>
<span id="cb5-10">calc_p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmvnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb5-12">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb5-13">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> sigma)</span>
<span id="cb5-14">}</span>
<span id="cb5-15"></span>
<span id="cb5-16"></span>
<span id="cb5-17"></span>
<span id="cb5-18"></span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># should be a straight line, but isn't - I don't understand why...</span></span>
<span id="cb5-21">p_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(dat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>), ], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, calc_p)</span>
<span id="cb5-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecdf</span>(p_values), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb5-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dotted'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-10-10-understanding-the-multivariate-normal-distribution/2023-10-10-understanding-the-multivariate-normal-distribution_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">ii_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(var_x1))</span>
<span id="cb6-2">ii_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(var_x2))</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ii_1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 229</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ii_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 246</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ii_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> ii_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 457</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ii_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> ii_2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-10-10-understanding-the-multivariate-normal-distribution/2023-10-10-understanding-the-multivariate-normal-distribution.html</guid>
  <pubDate>Mon, 09 Oct 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Decision trees</title>
  <link>https://sbloggel.netlify.app/posts/2023-10-07-decision-trees/2023-10-07-decision-trees.html</link>
  <description><![CDATA[ 



<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rpart'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rpart.plot'</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">train_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(iris), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(iris))</span>
<span id="cb2-2">train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iris[train_index, ]</span>
<span id="cb2-3">test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iris[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>train_index, ]</span>
<span id="cb2-4"></span>
<span id="cb2-5">tree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpart</span>(Species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpart.plot</span>(tree, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Decision Tree for the Iris Dataset"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-10-07-decision-trees/2023-10-07-decision-trees_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">cfit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpart</span>(pgstat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> eet <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> grade <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gleason <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ploidy,</span>
<span id="cb3-2">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> stagec)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpart.plot</span>(cfit2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Decision Tree for the stagec Dataset"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-10-07-decision-trees/2023-10-07-decision-trees_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-10-07-decision-trees/2023-10-07-decision-trees.html</guid>
  <pubDate>Fri, 06 Oct 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Gradient descent</title>
  <link>https://sbloggel.netlify.app/posts/2023-10-07-gradient-descent/2023-10-07-gradient-descent.html</link>
  <description><![CDATA[ 



<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span></span>
<span id="cb2-2">beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb2-3">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(beta), </span>
<span id="cb2-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(beta), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb2-5"></span>
<span id="cb2-6">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-7"></span>
<span id="cb2-8">fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(fm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X - 1)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.0310 -2.1055 -0.2301  1.9095 11.2183 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
X1  0.85705    0.06124  13.995  &lt; 2e-16 ***
X2 -0.32103    0.05629  -5.703 4.24e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.212 on 198 degrees of freedom
Multiple R-squared:  0.5391,    Adjusted R-squared:  0.5344 
F-statistic: 115.8 on 2 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">calc_log_likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(beta_1, beta_2) {</span>
<span id="cb4-2">  beta_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(beta_1, beta_2)</span>
<span id="cb4-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(beta_hat)</span></span>
<span id="cb4-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cat('\n')</span></span>
<span id="cb4-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># return(NULL)</span></span>
<span id="cb4-6">  y_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> beta_hat</span>
<span id="cb4-7">  epsilon_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_hat </span>
<span id="cb4-8">  sigma_hat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(epsilon_hat)</span>
<span id="cb4-9">  dn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(epsilon_hat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, sigma_hat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(dn))</span>
<span id="cb4-11">}</span>
<span id="cb4-12"></span>
<span id="cb4-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calc_log_likelihood</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -516.1865</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logLik</span>(fm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -516.1859 (df=3)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>), </span>
<span id="cb8-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))</span>
<span id="cb8-3"></span>
<span id="cb8-4">dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>loglik <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2_dbl</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta_1, dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta_2, calc_log_likelihood)</span>
<span id="cb8-5"></span>
<span id="cb8-6">ii <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>loglik)</span>
<span id="cb8-7"></span>
<span id="cb8-8">middle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat[ii, ]</span>
<span id="cb8-9"></span>
<span id="cb8-10">dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(beta_1, beta_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> loglik)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_contour</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> middle<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta_1, </span>
<span id="cb8-14">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> middle<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>beta_2), </span>
<span id="cb8-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-10-07-gradient-descent/2023-10-07-gradient-descent_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="example-from-r-bloggers" class="level2">
<h2 class="anchored" data-anchor-id="example-from-r-bloggers">Example from r-bloggers</h2>
<ul>
<li>Source: <a href="https://www.r-bloggers.com/2017/02/implementing-the-gradient-descent-algorithm-in-r/">Link</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attach</span>(mtcars)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from package:ggplot2:

    mpg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">gradientDesc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, y, learn_rate, conv_threshold, n, max_iter) {</span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb11-3">  m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb11-4">  c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb11-5">  yhat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c</span>
<span id="cb11-6">  MSE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> yhat) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n</span>
<span id="cb11-7">  converged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> F</span>
<span id="cb11-8">  iterations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb11-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span>(converged <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> F) {</span>
<span id="cb11-10">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Implement the gradient descent algorithm</span></span>
<span id="cb11-11">    m_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> learn_rate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((yhat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)))</span>
<span id="cb11-12">    c_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> learn_rate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(yhat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y)))</span>
<span id="cb11-13">    m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m_new</span>
<span id="cb11-14">    c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> c_new</span>
<span id="cb11-15">    yhat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> m <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c</span>
<span id="cb11-16">    MSE_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> yhat) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n</span>
<span id="cb11-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(MSE <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> MSE_new <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> conv_threshold) {</span>
<span id="cb11-18">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(c, m) </span>
<span id="cb11-19">      converged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> T</span>
<span id="cb11-20">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Optimal intercept:"</span>, c, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Optimal slope:"</span>, m))</span>
<span id="cb11-21">    }</span>
<span id="cb11-22">    iterations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> iterations <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb11-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(iterations <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_iter) { </span>
<span id="cb11-24">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(c, m) </span>
<span id="cb11-25">      converged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> T</span>
<span id="cb11-26">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Optimal intercept:"</span>, c, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Optimal slope:"</span>, m))</span>
<span id="cb11-27">    }</span>
<span id="cb11-28">  }</span>
<span id="cb11-29">}</span>
<span id="cb11-30"></span>
<span id="cb11-31"></span>
<span id="cb11-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the function </span></span>
<span id="cb11-33"></span>
<span id="cb11-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gradientDesc</span>(disp, mpg, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0000293</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500000</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-10-07-gradient-descent/2023-10-07-gradient-descent_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Optimal intercept: 29.5998515177117 Optimal slope: -0.0412151089930703"</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-10-07-gradient-descent/2023-10-07-gradient-descent.html</guid>
  <pubDate>Fri, 06 Oct 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Book study notes - Competing Risks and Multistate Models with R</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-28-book-study-notes---competing-risks-and-multistate-models-with-r/2023-09-28-book-study-notes---competing-risks-and-multistate-models-with-r.html</link>
  <description><![CDATA[ 



<p>Here, I want to collect some study notes of the book by Beyersmann et al.&nbsp;â€œCompeting Risks and Multistate Models with Râ€ - (<a href="https://link.springer.com/book/10.1007/978-1-4614-2035-4">Link</a>).</p>



 ]]></description>
  <category>R</category>
  <category>survival</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-28-book-study-notes---competing-risks-and-multistate-models-with-r/2023-09-28-book-study-notes---competing-risks-and-multistate-models-with-r.html</guid>
  <pubDate>Wed, 27 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Book series - use R</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-28-book-series---use-r/2023-09-28-book-series---use-r.html</link>
  <description><![CDATA[ 



<p>The â€œUse R!â€ book series seems to contain a lot of books that are worthwile reading! <a href="https://www.springer.com/series/6991">Link to the book series</a>.</p>



 ]]></description>
  <category>R</category>
  <category>Self-study</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-28-book-series---use-r/2023-09-28-book-series---use-r.html</guid>
  <pubDate>Wed, 27 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Subfigures in quarto</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto.html</link>
  <description><![CDATA[ 



<section id="option-1" class="level2">
<h2 class="anchored" data-anchor-id="option-1">Option 1</h2>
<p>Quelle: <a href="https://quarto.org/docs/authoring/figures.html">Link</a></p>
<div id="fig-elephants" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div id="fig-test-left" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-test-left-1.png" class="img-fluid figure-img" data-ref-parent="fig-elephants" width="288"></p>
<figcaption class="figure-caption">(a) This is a test</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div id="fig-test-right" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-test-right-1.png" class="img-fluid figure-img" data-ref-parent="fig-elephants" width="288"></p>
<figcaption class="figure-caption">(b) This is another test</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="cell-output-display">
<div id="fig-test-bottom" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-test-bottom-1.png" class="img-fluid figure-img" data-ref-parent="fig-elephants" width="576"></p>
<figcaption class="figure-caption">(c) And yet a third test</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Famous Elephants</figcaption><p></p>
</figure>
</div>
<p>Figure&nbsp;1</p>
<p>Figure&nbsp;1 (a)</p>
<p>Figure&nbsp;1 (b)</p>
<p>Figure&nbsp;1 (c)</p>
</section>
<section id="option-2" class="level2">
<h2 class="anchored" data-anchor-id="option-2">Option 2</h2>
<ul>
<li>Source: <a href="https://quarto.org/docs/authoring/figures.html#computations">Link</a></li>
</ul>
<div id="fig-charts" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-charts-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-charts-1.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(a) First</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-charts-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-charts-2.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(b) Second</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-charts-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto_files/figure-html/fig-charts-3.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(c) Third</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Charts</figcaption><p></p>
</figure>
</div>
<p>Figure&nbsp;2</p>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-25-subfigures-in-quarto/2023-09-25-subfigures-in-quarto.html</guid>
  <pubDate>Sun, 24 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Testing Observable</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-25-testing-observable/2023-09-25-testing-observable.html</link>
  <description><![CDATA[ 



<section id="plot-1" class="level2">
<h2 class="anchored" data-anchor-id="plot-1">Plot 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.2     âœ” readr     2.1.4
âœ” forcats   1.0.0     âœ” stringr   1.5.0
âœ” ggplot2   3.4.2     âœ” tibble    3.2.1
âœ” lubridate 1.9.2     âœ” tidyr     1.3.0
âœ” purrr     1.0.1     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(iris)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.â€¦
$ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.â€¦
$ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.â€¦
$ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.â€¦
$ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, sâ€¦</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(iris)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">iris_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> iris<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Species, </span>
<span id="cb7-2">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sepal_length =</span> iris<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Sepal.Length,</span>
<span id="cb7-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sepal_width =</span> iris<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Sepal.Width)</span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(iris_new, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'iris.csv'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-startfrom="20" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 19;"><span id="cb8-20">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FileAttachment</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iris.csv"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">csv</span>({ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">typed</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">true</span> })</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-startfrom="25" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 24;"><span id="cb9-25">viewof sepal_length_min <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(</span>
<span id="cb9-26">  [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb9-27">  {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal length min:"</span>}</span>
<span id="cb9-28">)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-startfrom="32" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 31;"><span id="cb10-32">filtered <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(iris) {</span>
<span id="cb10-33">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sepal_length_min <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> iris<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sepal_length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb10-34">})</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-startfrom="38" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 37;"><span id="cb11-38">Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rectY</span>(filtered<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb11-39">  Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binX</span>(</span>
<span id="cb11-40">    {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb11-41">    {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sepal_length"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">fill</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>}</span>
<span id="cb11-42">  ))</span>
<span id="cb11-43">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>({</span>
<span id="cb11-44">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">facet</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb11-45">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> filtered<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-46">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-47">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sepal_length"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-48">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">marginRight</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb11-49">    }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-50">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">marks</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> [</span>
<span id="cb11-51">      Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">frame</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-52">    ]</span>
<span id="cb11-53">  }</span>
<span id="cb11-54">)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
</section>
<section id="plot-2" class="level2">
<h2 class="anchored" data-anchor-id="plot-2">Plot 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-startfrom="59" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 58;"><span id="cb12-59">Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>({</span>
<span id="cb12-60">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">marks</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> [</span>
<span id="cb12-61">    Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(penguins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_length_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_depth_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// try changing "stroke" to "fill"</span></span>
<span id="cb12-62">    Plot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">linearRegressionY</span>(penguins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_length_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"culmen_depth_mm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">stroke</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>})</span>
<span id="cb12-63">  ]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb12-64">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">ariaLabel</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Penguin culmen dimensions"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb12-65">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">ariaDescription</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scatterplot of culmen length by culmen depth for three penguin species. Linear trendlines are added to each, revealing similar positive linear trends between culmen length and depth for chinstrap, gentoo and Adelie penguins."</span></span>
<span id="cb12-66">})</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>


</section>

 ]]></description>
  <category>Observable</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-25-testing-observable/2023-09-25-testing-observable.html</guid>
  <pubDate>Sun, 24 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>SVM code example</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-12-svm-code-example/2023-09-12-svm-code-example.html</link>
  <description><![CDATA[ 



<p>Inspired from <a href="https://www.spsanderson.com/steveondata/posts/2023-09-11/index.html">this</a> blog post.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'e1071'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">ir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_setosa =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(Species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'setosa'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Yes'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'No'</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Species, Sepal.Length, Petal.Length))</span>
<span id="cb2-4"></span>
<span id="cb2-5">ir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(ir)</span>
<span id="cb2-6"></span>
<span id="cb2-7">fm_svm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">svm</span>(is_setosa <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ir)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(fm_svm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ir)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-09-12-svm-code-example/2023-09-12-svm-code-example_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>



 ]]></description>
  <category>R</category>
  <category>Self-study</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-12-svm-code-example/2023-09-12-svm-code-example.html</guid>
  <pubDate>Mon, 11 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Algorithmic study design â€“ possible approaches</title>
  <link>https://sbloggel.netlify.app/posts/2023-09-07-algorithmic-study-design-possible-concepts/2023-09-07-algorithmic-study-design-possible-concepts.html</link>
  <description><![CDATA[ 



<section id="possible-concepts" class="level2">
<h2 class="anchored" data-anchor-id="possible-concepts">Possible concepts:</h2>
<ul>
<li>Model of research environment (e. g. university hospital) and simulate a lot of studies in this environment</li>
<li>Continue Elenaâ€™s work</li>
<li>Use clinicaltrials.gov data set as training dataset for neural net</li>
<li>Simulate a lot of studies in <a href="../../posts/2023-08-21-algorithmic-study-design----white-paper/2023-08-21-algorithmic-study-design----white-paper.html">this</a> manner</li>
</ul>
</section>
<section id="further-ideas" class="level2">
<h2 class="anchored" data-anchor-id="further-ideas">Further ideas:</h2>
<ul>
<li>We could start with a descriptive analysis of the clinicaltrials.gov database</li>
<li>There are some older papers
<ul>
<li><a href="https://scholar.google.com/scholar?hl=de&amp;as_sdt=0%2C5&amp;q=clinicaltrials+database&amp;btnG=">Overview at google scholar</a></li>
<li><a href="https://jamanetwork.com/journals/jama/article-abstract/1150093">Characteristics of Clinical Trials Registered in ClinicalTrials.gov, 2007-2010</a></li>
<li><a href="https://www.bmj.com/content/361/bmj.k1452.abstract">How to avoid common problems when using ClinicalTrials.gov in research: 10 issues to consider - BMJ 2018</a></li>
</ul></li>
</ul>


</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-09-07-algorithmic-study-design-possible-concepts/2023-09-07-algorithmic-study-design-possible-concepts.html</guid>
  <pubDate>Wed, 06 Sep 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Tensorflow Decision Forests</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-28-tensorflow-decision-forests-/2023-08-28-tensorflow-decision-forests-.html</link>
  <description><![CDATA[ 



<ul>
<li>Source</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reticulate'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_condaenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensorflow_decision_forests <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tfdf</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensorflow <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tf</span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb2-8"></span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Found TensorFlow Decision Forests v"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> tfdf.__version__)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the dataset</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !wget -q https://storage.googleapis.com/download.tensorflow.org/data/palmer_penguins/penguins.csv -O /tmp/penguins.csv</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load a dataset into a Pandas Dataframe.</span></span>
<span id="cb2-16">dataset_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/tmp/penguins.csv"</span>)</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the first 3 examples.</span></span>
<span id="cb2-19">dataset_df.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-20"></span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encode the categorical labels as integers.</span></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Details:</span></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This stage is necessary if your classification label is represented as a</span></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># string since Keras expects integer classification labels.</span></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># When using `pd_dataframe_to_tf_dataset` (see below), this step can be skipped.</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name of the label column.</span></span>
<span id="cb2-30">label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32">classes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset_df[label].unique().tolist()</span>
<span id="cb2-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Label classes: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>classes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-34"></span>
<span id="cb2-35">dataset_df[label] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset_df[label].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(classes.index)</span>
<span id="cb2-36"></span>
<span id="cb2-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the dataset into a training and a testing dataset.</span></span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> split_dataset(dataset, test_ratio<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.30</span>):</span>
<span id="cb2-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Splits a panda dataframe in two."""</span></span>
<span id="cb2-41">  test_indices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.rand(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataset)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> test_ratio</span>
<span id="cb2-42">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> dataset[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>test_indices], dataset[test_indices]</span>
<span id="cb2-43"></span>
<span id="cb2-44"></span>
<span id="cb2-45">train_ds_pd, test_ds_pd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> split_dataset(dataset_df)</span>
<span id="cb2-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> examples in training, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> examples for testing."</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(</span>
<span id="cb2-47">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(train_ds_pd), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(test_ds_pd)))</span>
<span id="cb2-48"></span>
<span id="cb2-49"></span>
<span id="cb2-50">train_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.pd_dataframe_to_tf_dataset(train_ds_pd, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label)</span>
<span id="cb2-51">test_ds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.pd_dataframe_to_tf_dataset(test_ds_pd, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label)</span>
<span id="cb2-52"></span>
<span id="cb2-53"></span>
<span id="cb2-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># %set_cell_height 300</span></span>
<span id="cb2-55"></span>
<span id="cb2-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Specify the model.</span></span>
<span id="cb2-57">model_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tfdf.keras.RandomForestModel(verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train the model.</span></span>
<span id="cb2-60">model_1.fit(train_ds)</span>
<span id="cb2-61"></span>
<span id="cb2-62"></span>
<span id="cb2-63">model_1.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>])</span>
<span id="cb2-64">evaluation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_1.evaluate(test_ds, return_dict<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-65"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>()</span>
<span id="cb2-66"></span>
<span id="cb2-67"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> name, value <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> evaluation.items():</span>
<span id="cb2-68">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>value<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-69"></span>
<span id="cb2-70"></span>
<span id="cb2-71">tfdf.model_plotter.plot_model_in_colab(model_1, tree_idx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, max_depth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-28-tensorflow-decision-forests-/2023-08-28-tensorflow-decision-forests-.html</guid>
  <pubDate>Sun, 27 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Two-Way-ANOVA with and without interaction vs.Â individual t-tests</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Often, the effect of different interventions is to be studied. This can be done by comparing individual sets of interventions (e. g. drug A vs.&nbsp;placebo and drug B vs.&nbsp;placebo) or in a factorial design (e. g. ANOVA). For individual comparisons statistical tests such as the t-test can be appropriate. Importantly, correction for multiple testing should to be carried out. The effect of combination of several drugs can be studied easily in the factorial design, while it is more complicated via t-tests.</p>
<p>Here, it is studied if ANOVA analysis with subsequent joint testing of the relevant hypotheses offers advantages in terms of required sample size / statistical power in comparison to analysis via separate t-tests for some configurations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tidyverse'</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multcomp'</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'knitr'</span>)</span></code></pre></div>
</div>
</section>
<section id="simulation-model" class="level2">
<h2 class="anchored" data-anchor-id="simulation-model">Simulation model</h2>
<ul>
<li>Normally distributed data</li>
<li>Two-way factorial design
<ul>
<li>Factor <code>F1</code> with levels <code>A</code> and <code>B</code></li>
<li>Factor <code>F2</code> with levels <code>A</code> and <code>B</code></li>
</ul></li>
<li>Means:
<ul>
<li><code>F1</code> = <code>A</code>, <code>F2</code> = <code>A</code> â†’ <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200"></li>
<li><code>F1</code> = <code>A</code>, <code>F2</code> = <code>B</code> â†’ <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%201"></li>
<li><code>F1</code> = <code>B</code>, <code>F2</code> = <code>A</code> â†’ <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%201"></li>
<li><code>F1</code> = <code>B</code>, <code>F2</code> = <code>B</code> â†’ <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%203"></li>
</ul></li>
<li>Standard deviation of error:
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%201"></li>
</ul></li>
<li>In treatment coding, this corresponds to the coefficient vector <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20=%20(0,%201,%201,%201)%5ET"></li>
<li>10 individuals per group</li>
</ul>
</section>
<section id="example-of-simulated-data" class="level2">
<h2 class="anchored" data-anchor-id="example-of-simulated-data">Example of simulated data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">generate_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb2-2">  dd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">F1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">F2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>))</span>
<span id="cb2-3">  X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dd)</span>
<span id="cb2-4">  dd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> (X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> beta)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dd)))</span>
<span id="cb2-5">}</span>
<span id="cb2-6"></span>
<span id="cb2-7">sample_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>()</span>
<span id="cb2-8"> </span>
<span id="cb2-9">sample_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(F1, F2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> label_both, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'(Points are jittered along x-axis)'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interaction-plots" class="level2">
<h2 class="anchored" data-anchor-id="interaction-plots">Interaction plots</h2>
<section id="with-base-r" class="level3">
<h3 class="anchored" data-anchor-id="with-base-r">With base R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(sample_data, </span>
<span id="cb3-2">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interaction.plot</span>(F1, F2, y))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(sample_data, </span>
<span id="cb4-2">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interaction.plot</span>(F2, F1, y))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="with-catstats-package" class="level3">
<h3 class="anchored" data-anchor-id="with-catstats-package">With catstats package</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remotes::install_github("greenwood-stat/catstats")</span></span>
<span id="cb5-2">catstats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intplotarray</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sample_data)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="simulate-many-datasets-in-order-to-estimate-power-to-test-the-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="simulate-many-datasets-in-order-to-estimate-power-to-test-the-hypotheses">Simulate many datasets in order to estimate power to test the hypotheses</h2>
<ul>
<li>For ANOVA analysis the multcomp package is used in order to simultaneously test the hypotheses (correction for multiple testing with respect to the two (without interactgion) or three hypotheses (with interaction) is included by design)</li>
<li>Calculate p-values testing the main effects (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_1%20=%200"> and <img src="https://latex.codecogs.com/png.latex?%5Cbeta_2%20=%200">) and the interaction (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_3%20=%200">) for each of the simulations</li>
<li>Estimate power empirically</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">simulate_two_way_ANOVA <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_interaction =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) {</span>
<span id="cb6-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(include_interaction) {</span>
<span id="cb6-3">    fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>())</span>
<span id="cb6-4">    ii <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-5">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb6-6">    fm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> F2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_data</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subset =</span> (F1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> F2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>))</span>
<span id="cb6-7">    ii <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb6-8">  }</span>
<span id="cb6-9">  hypotheses_tests <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glht</span>(fm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linfct =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(fm))[ii], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'= 0'</span>))</span>
<span id="cb6-10">  p_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(hypotheses_tests)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pvalues</span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attributes</span>(p_values) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(p_values)</span>
<span id="cb6-13">}</span></code></pre></div>
</div>
<section id="power-of-anova-analysis-without-interaction" class="level3">
<h3 class="anchored" data-anchor-id="power-of-anova-analysis-without-interaction">Power of ANOVA analysis without interaction</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">nr_of_sims <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Effect =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 2'</span>),</span>
<span id="cb7-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Power =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_sims, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_two_way_ANOVA</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> </span>
<span id="cb7-4">                         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> nr_of_sims) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Effect</th>
<th style="text-align: center;">Power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Main effect 1</td>
<td style="text-align: center;">0.469</td>
</tr>
<tr class="even">
<td style="text-align: center;">Main effect 2</td>
<td style="text-align: center;">0.463</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="power-of-anova-analysis-with-interaction" class="level3">
<h3 class="anchored" data-anchor-id="power-of-anova-analysis-with-interaction">Power of ANOVA analysis with interaction</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">nr_of_sims <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Effect =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Main effect 2'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Interaction'</span>),</span>
<span id="cb8-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Power =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_sims, </span>
<span id="cb8-4">                                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_two_way_ANOVA</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include_interaction =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> </span>
<span id="cb8-5">                         <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> nr_of_sims) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Effect</th>
<th style="text-align: center;">Power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Main effect 1</td>
<td style="text-align: center;">0.438</td>
</tr>
<tr class="even">
<td style="text-align: center;">Main effect 2</td>
<td style="text-align: center;">0.439</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Interaction</td>
<td style="text-align: center;">0.222</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="power-of-separate-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="power-of-separate-t-tests">Power of separate t-tests</h3>
<section id="bonferroni-correction-for-two-tests" class="level4">
<h4 class="anchored" data-anchor-id="bonferroni-correction-for-two-tests">Bonferroni correction for two tests:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sig.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 10
          delta = 1
             sd = 1
      sig.level = 0.025
          power = 0.4360626
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</section>
<section id="bonferroni-correction-for-three-tests" class="level4">
<h4 class="anchored" data-anchor-id="bonferroni-correction-for-three-tests">Bonferroni correction for three tests:</h4>
<ul>
<li>Variance of estimator of interaction effect
<ul>
<li>â€œthe variance of a sum of uncorrelated random variables is equal to the sum of their variancesâ€ <a href="https://en.wikipedia.org/w/index.php?title=Variance&amp;oldid=1180635227">(Source)</a></li>
<li>Hypothesis for testing main effects: sum with two terms</li>
</ul></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0AH_0:%20%5Cqquad%20%5Cmu_A%20-%20%5Cmu_0%20=%200%20%5Cqquad%20(&amp;%5Ciff%20%5Cbeta_1%20=%200)%5C%5C%0AH_0:%20%5Cqquad%20%5Cmu_B%20-%20%5Cmu_0%20=%200%20%5Cqquad%20(&amp;%5Ciff%20%5Cbeta_2%20=%200)%0A%5Cend%7Balign%7D"></p>
<ul>
<li>Hypotheses for testing interaction: sum with four terms</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0AH_0:%20%5Cqquad%20%5Cmu_A%20+%20%5Cmu_B%20-%20%5Cmu_%7BAB%7D%20-%20%5Cmu_0%20=%200%20%20%5Cqquad%20(&amp;%5Ciff%20%5Cbeta_3%20=%200)%0A%5Cend%7Balign%7D"></p>
<ul>
<li>Additional formulations of <img src="https://latex.codecogs.com/png.latex?H_0"> for interaction effect: <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0AH_0:%20%5Cqquad%20&amp;%20%5Cmu_A%20-%20%5Cmu_0%20&amp;%20+%20&amp;%20%5Cmu_B%20-%20%5Cmu_0%20&amp;%20=%20&amp;%20%5Cmu_%7BAB%7D%20-%20%5Cmu_0%20%5C%5C%0AH_0:%20%5Cqquad%20&amp;%20%5Cbeta_1%20&amp;%20+%20&amp;%20%5Cbeta_2%20&amp;%20=%20&amp;%20%5Cbeta_1%20+%20%5Cbeta_2%20+%20%5Cbeta_3%0A%5Cend%7Balign%7D"></li>
<li>Conclusion: Variance of estimate of interaction effect is twice the variance of the estimate of the main effects</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Main effects:</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sig.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 10
          delta = 1
             sd = 1
      sig.level = 0.01666667
          power = 0.3690371
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Interaction effect:</span></span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sig.level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 10
          delta = 1
             sd = 1.414214
      sig.level = 0.01666667
          power = 0.1746347
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>Power in Two-Way-ANOVA without interaction is slightly greater than power of two separate t-tests corrected with Bonferroni procedure (30 individuals needed in both cases, provided that the control group is â€˜recycledâ€™ in the t-test case)
<ul>
<li>Model without interaction:
<ul>
<li>Power for main effects ANOVA: 0.469</li>
<li>Power for main effects t-test: 0.436</li>
</ul></li>
<li>Model with interaction:
<ul>
<li>Power for main effects ANOVA: 0.441</li>
<li>Power for main effects t-test: 0.369</li>
<li>Power for interaction ANOVA: 0.218</li>
<li>Power for interaction t-test: 0.175</li>
</ul></li>
</ul></li>
<li>Power in Two-Way-ANOVA with interaction is approximately equal to power of two separate t-tests corrected with Bonferroni procedure (10 additional individuals needed in order to test interaction)</li>
<li>Power could be improved without increased total sample size by appropriately increasing the size of the control group (not shown here) - see Friedemannâ€™s document (is in local folder however not uploaded)</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>ANOVA vs t-Tests</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-28-anova-with-interactions-vs.-individual-t-tests/2023-08-28-anova-with-interactions-vs.-individual-t-tests.html</guid>
  <pubDate>Sun, 27 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Simulating a clinical study with a mechanistic model in the background</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background.html</link>
  <description><![CDATA[ 



<section id="description-of-virtual-study" class="level2">
<h2 class="anchored" data-anchor-id="description-of-virtual-study">Description of virtual study</h2>
<ul>
<li>Increased doses for leukemia in comparison to â€œstandardâ€ doses with some substance X is to be studied</li>
<li>Randomized, controlled, double-blind clinical trial</li>
<li>Groups:
<ul>
<li>standard regimen: X 1 mg - 0 - 2 mg - 0 for 10 days</li>
<li>adjusted regimen: X 2 mg - 0 - 3 mg - 0 for 10 days</li>
</ul></li>
<li>Leukemic burden is assumed to be lognormally distributed initially</li>
<li>Postleukemic burden is assumed to be: Leukemic burden pretherapy divided by area under the plasma level curve</li>
<li>Some plausible pharmacokinetic model is assumed, with rate constants depending on age and weight</li>
<li>Primary endpoint: Molecular remission (defined as postleukemic burden &lt; 0.0012)</li>
</ul>
</section>
<section id="definition-of-study-population" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-study-population">Definition of study population</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb1-2">nr_of_patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span></span>
<span id="cb1-3">patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nr_of_patients,</span>
<span id="cb1-4">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'standard_dosing'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjusted_dosing'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> nr_of_patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(nr_of_patients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb1-6">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(nr_of_patients, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb1-7">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_scaled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(age)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-8">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight_scaled =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(weight)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-9">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'male'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'female'</span>), </span>
<span id="cb1-10">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> nr_of_patients, </span>
<span id="cb1-11">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-12">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">leukemic_burden_pretherapy =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_patients))</span>
<span id="cb1-13"></span>
<span id="cb1-14">patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_n</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 7%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">id</th>
<th style="text-align: center;">group</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">age_scaled</th>
<th style="text-align: center;">weight_scaled</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">leukemic_burden_pretherapy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">182</td>
<td style="text-align: center;">adjusted_dosing</td>
<td style="text-align: center;">72.63185</td>
<td style="text-align: center;">81.90230</td>
<td style="text-align: center;">1.3483988</td>
<td style="text-align: center;">0.1487158</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">2.670092</td>
</tr>
<tr class="even">
<td style="text-align: center;">13</td>
<td style="text-align: center;">standard_dosing</td>
<td style="text-align: center;">64.00771</td>
<td style="text-align: center;">92.32476</td>
<td style="text-align: center;">0.4340111</td>
<td style="text-align: center;">1.1952301</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">2.416850</td>
</tr>
<tr class="odd">
<td style="text-align: center;">68</td>
<td style="text-align: center;">standard_dosing</td>
<td style="text-align: center;">60.53004</td>
<td style="text-align: center;">62.43473</td>
<td style="text-align: center;">0.0652855</td>
<td style="text-align: center;">-1.8060152</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">1.798109</td>
</tr>
<tr class="even">
<td style="text-align: center;">127</td>
<td style="text-align: center;">adjusted_dosing</td>
<td style="text-align: center;">62.35387</td>
<td style="text-align: center;">79.39178</td>
<td style="text-align: center;">0.2586592</td>
<td style="text-align: center;">-0.1033647</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">1.186002</td>
</tr>
<tr class="odd">
<td style="text-align: center;">25</td>
<td style="text-align: center;">standard_dosing</td>
<td style="text-align: center;">53.74961</td>
<td style="text-align: center;">76.36343</td>
<td style="text-align: center;">-0.6536207</td>
<td style="text-align: center;">-0.4074403</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">3.048497</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="definition-of-pharmacokinetic-model" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-pharmacokinetic-model">Definition of pharmacokinetic model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">calc_plasma_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(applications, patient, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb2-2">  plasma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">timepoint =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max, </span>
<span id="cb2-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb2-4">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id, </span>
<span id="cb2-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>group) </span>
<span id="cb2-6">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(applications)) {</span>
<span id="cb2-7">    ii <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> applications<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time[i]</span>
<span id="cb2-8">    plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[ii<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[ii<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> applications<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dose[i]</span>
<span id="cb2-9">  }</span>
<span id="cb2-10">  degraded <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>t_max) {</span>
<span id="cb2-12">    degraded <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> degraded <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-13">      plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb2-14">      (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>age_scaled <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> patient<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weight_scaled) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb2-15">    plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plasma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> degraded</span>
<span id="cb2-16">  }</span>
<span id="cb2-17">  plasma</span>
<span id="cb2-18">}</span></code></pre></div>
</div>
</section>
<section id="definition-of-dosing-schemes" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-dosing-schemes">Definition of dosing schemes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">standard_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb3-2">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span>
<span id="cb3-3">adjusted_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb3-4">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>))</span></code></pre></div>
</div>
</section>
<section id="calculation-of-plasma-levels" class="level2">
<h2 class="anchored" data-anchor-id="calculation-of-plasma-levels">Calculation of plasma levels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">plasma_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>()</span>
<span id="cb4-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nr_of_patients){</span>
<span id="cb4-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(patients<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>group[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'standard_dosing'</span>) {</span>
<span id="cb4-4">    current_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> standard_dosing</span>
<span id="cb4-5">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb4-6">    current_dosing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_dosing</span>
<span id="cb4-7">  }</span>
<span id="cb4-8">  plasma_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plasma_levels <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calc_plasma_levels</span>(</span>
<span id="cb4-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">applications =</span> current_dosing, </span>
<span id="cb4-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">patient =</span> patients[i, ],</span>
<span id="cb4-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>))</span>
<span id="cb4-13">}</span></code></pre></div>
</div>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">plasma_levels <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(nr_of_patients, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(timepoint, level, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Plasma levels of randomly chosen individuals'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Patient id'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://sbloggel.netlify.app/posts/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(plasma_levels, id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">auc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(level)))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">patients <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patients <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">leukemic_burden_posttherapy =</span> leukemic_burden_pretherapy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> auc,</span>
<span id="cb8-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">molecular_remission =</span> leukemic_burden_posttherapy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2e-3</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(patients<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>leukemic_burden_posttherapy)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
8.897e-05 5.727e-04 1.214e-03 1.981e-03 2.403e-03 2.008e-02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contigency table of group vs. molecular_remission (yes / no)</span></span>
<span id="cb10-2">(study_outcome <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xtabs</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> molecular_remission, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> patients))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 molecular_remission
group             FALSE TRUE
  adjusted_dosing    61   39
  standard_dosing    38   62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate study p-value</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chisq.test</span>(study_outcome)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  study_outcome
X-squared = 9.681, df = 1, p-value = 0.001862</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>Here, a hypothetical clinical study has been simulated</li>
<li>a lot of fine-tuning and a lot of knowledge about the underlying mechanisms is needed</li>
<li>hard to generalize that for the next application - probably, a similar amount of fine-tuning will be needed</li>
</ul>


</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background/2023-08-22-simulating-a-clinical-study-with-a-mechanistic-model-in-the-background.html</guid>
  <pubDate>Mon, 21 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Generation of in silico studies</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-21-generation-of-in-silico-studies/2023-08-21-generation-of-in-silico-studies.html</link>
  <description><![CDATA[ 



<section id="description-of-simulation-model" class="level2">
<h2 class="anchored" data-anchor-id="description-of-simulation-model">Description of simulation model</h2>
<ul>
<li><code>disease</code>: Random names for quantity of interest (in reality something like â€˜Hba1câ€™, â€˜Survival after therapy with Imatinibeâ€™ etc.)
<ul>
<li>3 letters, duplicates allowed</li>
</ul></li>
<li><code>assumed_delta</code>: Assumed difference in means that has been used for designing the study, lognormal distribution is assumed</li>
<li><code>actual_delta</code>: <em>Ground truth</em> difference in means, assumed 0 in 50% of the cases, in the rest of the cases <code>assumed_delta</code> multiplied by random number uniformly distributed between 0.2 and 1.3</li>
<li><code>sd</code>: Standard deviation of <code>disease</code> - some hopefully reasonable random number</li>
<li><code>n_planned</code>: Designed group size according to <code>assumed_delta</code> and <code>sd</code> based on <code>stats::power.t.test()</code></li>
<li><code>n_per_year_assumed</code>: Assumed mean number of patients that can be included in study</li>
<li><code>n_per_year_actual</code>: Actual number of patients that can be included per year</li>
<li><code>expected_study duration</code> and <code>actual_study_duration</code>: Designed group size divided by expected / actual number of patients per year</li>
<li><code>actual_power</code>: Power calculated based on <code>actual_delta</code> and <code>sd</code></li>
<li><code>null_rejected</code>: Boolean variable based on Bernoulli trial with <img src="https://latex.codecogs.com/png.latex?p"> taken from <code>actual_power</code></li>
<li><code>utiliy_null_rejected</code>: Utility of study - uniformly distributed random number between 0 and 1</li>
<li><code>utiliy_null_not_rejected</code>: <code>utiliy_null_rejected</code> / 2</li>
<li><code>cost_per_patient</code>: Monetary cost to include a patient in the study - random number on arbitrary scale</li>
</ul>
</section>
<section id="simulation-results" class="level2">
<h2 class="anchored" data-anchor-id="simulation-results">Simulation results</h2>
<div class="cell" data-hash="2023-08-21-generation-of-in-silico-studies_cache/html/simulation_679af1554d92ec67bb518ca622c0a09c">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set parameters:</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>)</span>
<span id="cb1-3">nr_of_studies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># utiliy functions:</span></span>
<span id="cb1-6">get_random_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(letters, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> length), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>))</span>
<span id="cb1-8">}</span>
<span id="cb1-9"></span>
<span id="cb1-10">get_n_planned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vectorize</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(delta, sd, power) {</span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> delta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">power =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>()</span>
<span id="cb1-13">})</span>
<span id="cb1-14"></span>
<span id="cb1-15">get_actual_power <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vectorize</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(delta, sd, n) {</span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">power.t.test</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> delta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>power</span>
<span id="cb1-17">})</span>
<span id="cb1-18"></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simulate studies:</span></span>
<span id="cb1-21">studies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">disease =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_random_names</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_studies, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-22">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endpoint =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_random_names</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> nr_of_studies, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb1-23">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">assumed_delta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies),</span>
<span id="cb1-24">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_delta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb1-25">                                        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb1-26">                                        assumed_delta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>)),</span>
<span id="cb1-27">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> assumed_delta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies)),</span>
<span id="cb1-28">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_planned =</span> </span>
<span id="cb1-29">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_n_planned</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> assumed_delta, </span>
<span id="cb1-30">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, </span>
<span id="cb1-31">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">power =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>),</span>
<span id="cb1-32">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_per_year_assumed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies),</span>
<span id="cb1-33">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_per_year_actual =</span> </span>
<span id="cb1-34">                    n_per_year_assumed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_planned, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>),</span>
<span id="cb1-35">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expected_study_duration =</span> n_planned <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_per_year_assumed,</span>
<span id="cb1-36">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_study_duration =</span> n_planned <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_per_year_actual,</span>
<span id="cb1-37">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_power =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_actual_power</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> actual_delta, </span>
<span id="cb1-38">                                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> sd, </span>
<span id="cb1-39">                                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_planned),</span>
<span id="cb1-40">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">null_rejected =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> actual_power,</span>
<span id="cb1-41">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">utility_null_rejected =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(nr_of_studies),</span>
<span id="cb1-42">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">utility_null_not_rejected =</span> utility_null_rejected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-43">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cost_per_patient =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rlnorm</span>(nr_of_studies))</span></code></pre></div>
</div>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<section id="randomly-chosen-studies" class="level3">
<h3 class="anchored" data-anchor-id="randomly-chosen-studies">20 randomly chosen studies:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_n</span>(studies, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">disease</th>
<th style="text-align: center;">endpoint</th>
<th style="text-align: center;">assumed_delta</th>
<th style="text-align: center;">actual_delta</th>
<th style="text-align: center;">sd</th>
<th style="text-align: center;">n_planned</th>
<th style="text-align: center;">n_per_year_assumed</th>
<th style="text-align: center;">n_per_year_actual</th>
<th style="text-align: center;">expected_study_duration</th>
<th style="text-align: center;">actual_study_duration</th>
<th style="text-align: center;">actual_power</th>
<th style="text-align: center;">null_rejected</th>
<th style="text-align: center;">utility_null_rejected</th>
<th style="text-align: center;">utility_null_not_rejected</th>
<th style="text-align: center;">cost_per_patient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">et</td>
<td style="text-align: center;">z</td>
<td style="text-align: center;">1.63</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">5.15</td>
<td style="text-align: center;">159</td>
<td style="text-align: center;">11.59</td>
<td style="text-align: center;">9.02</td>
<td style="text-align: center;">13.72</td>
<td style="text-align: center;">17.63</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.51</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">2.07</td>
</tr>
<tr class="even">
<td style="text-align: center;">rc</td>
<td style="text-align: center;">i</td>
<td style="text-align: center;">0.42</td>
<td style="text-align: center;">0.53</td>
<td style="text-align: center;">0.60</td>
<td style="text-align: center;">33</td>
<td style="text-align: center;">11.74</td>
<td style="text-align: center;">8.54</td>
<td style="text-align: center;">2.81</td>
<td style="text-align: center;">3.86</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.36</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">3.63</td>
</tr>
<tr class="odd">
<td style="text-align: center;">zf</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">1.22</td>
<td style="text-align: center;">1.80</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">10.67</td>
<td style="text-align: center;">7.60</td>
<td style="text-align: center;">3.75</td>
<td style="text-align: center;">5.27</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">0.34</td>
</tr>
<tr class="even">
<td style="text-align: center;">ok</td>
<td style="text-align: center;">y</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.16</td>
<td style="text-align: center;">0.32</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">12.30</td>
<td style="text-align: center;">10.05</td>
<td style="text-align: center;">2.11</td>
<td style="text-align: center;">2.59</td>
<td style="text-align: center;">0.42</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">3.49</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ny</td>
<td style="text-align: center;">r</td>
<td style="text-align: center;">1.50</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">4.34</td>
<td style="text-align: center;">133</td>
<td style="text-align: center;">11.60</td>
<td style="text-align: center;">13.08</td>
<td style="text-align: center;">11.47</td>
<td style="text-align: center;">10.17</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: center;">cp</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">1.62</td>
<td style="text-align: center;">1.72</td>
<td style="text-align: center;">5.90</td>
<td style="text-align: center;">211</td>
<td style="text-align: center;">11.06</td>
<td style="text-align: center;">8.24</td>
<td style="text-align: center;">19.08</td>
<td style="text-align: center;">25.59</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.49</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">1.25</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rw</td>
<td style="text-align: center;">b</td>
<td style="text-align: center;">13.74</td>
<td style="text-align: center;">9.18</td>
<td style="text-align: center;">31.73</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">22.36</td>
<td style="text-align: center;">25.38</td>
<td style="text-align: center;">3.80</td>
<td style="text-align: center;">3.35</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: center;">wt</td>
<td style="text-align: center;">q</td>
<td style="text-align: center;">1.96</td>
<td style="text-align: center;">1.64</td>
<td style="text-align: center;">2.68</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">10.79</td>
<td style="text-align: center;">10.16</td>
<td style="text-align: center;">2.87</td>
<td style="text-align: center;">3.05</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">1.02</td>
</tr>
<tr class="odd">
<td style="text-align: center;">is</td>
<td style="text-align: center;">t</td>
<td style="text-align: center;">1.22</td>
<td style="text-align: center;">1.30</td>
<td style="text-align: center;">2.54</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">11.28</td>
<td style="text-align: center;">12.09</td>
<td style="text-align: center;">6.21</td>
<td style="text-align: center;">5.79</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.52</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: center;">dt</td>
<td style="text-align: center;">z</td>
<td style="text-align: center;">0.55</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.92</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">10.62</td>
<td style="text-align: center;">11.70</td>
<td style="text-align: center;">4.33</td>
<td style="text-align: center;">3.93</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">0.83</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gj</td>
<td style="text-align: center;">h</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">1.50</td>
<td style="text-align: center;">29</td>
<td style="text-align: center;">10.19</td>
<td style="text-align: center;">10.29</td>
<td style="text-align: center;">2.85</td>
<td style="text-align: center;">2.82</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">1.04</td>
</tr>
<tr class="even">
<td style="text-align: center;">ux</td>
<td style="text-align: center;">h</td>
<td style="text-align: center;">0.56</td>
<td style="text-align: center;">0.46</td>
<td style="text-align: center;">0.91</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">11.44</td>
<td style="text-align: center;">7.19</td>
<td style="text-align: center;">3.76</td>
<td style="text-align: center;">5.98</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">1.62</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gz</td>
<td style="text-align: center;">k</td>
<td style="text-align: center;">0.76</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">1.13</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">13.06</td>
<td style="text-align: center;">10.68</td>
<td style="text-align: center;">2.83</td>
<td style="text-align: center;">3.46</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: center;">bl</td>
<td style="text-align: center;">h</td>
<td style="text-align: center;">0.31</td>
<td style="text-align: center;">0.30</td>
<td style="text-align: center;">1.04</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">11.01</td>
<td style="text-align: center;">5.54</td>
<td style="text-align: center;">16.35</td>
<td style="text-align: center;">32.50</td>
<td style="text-align: center;">0.79</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.96</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">1.18</td>
</tr>
<tr class="odd">
<td style="text-align: center;">nl</td>
<td style="text-align: center;">g</td>
<td style="text-align: center;">1.19</td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;">1.33</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">10.67</td>
<td style="text-align: center;">9.62</td>
<td style="text-align: center;">1.97</td>
<td style="text-align: center;">2.18</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">1.80</td>
</tr>
<tr class="even">
<td style="text-align: center;">zx</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">3.37</td>
<td style="text-align: center;">3.08</td>
<td style="text-align: center;">5.84</td>
<td style="text-align: center;">49</td>
<td style="text-align: center;">10.12</td>
<td style="text-align: center;">11.16</td>
<td style="text-align: center;">4.84</td>
<td style="text-align: center;">4.39</td>
<td style="text-align: center;">0.73</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.60</td>
</tr>
<tr class="odd">
<td style="text-align: center;">kv</td>
<td style="text-align: center;">g</td>
<td style="text-align: center;">3.54</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">5.95</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">11.21</td>
<td style="text-align: center;">11.80</td>
<td style="text-align: center;">4.10</td>
<td style="text-align: center;">3.90</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: center;">tn</td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">1.23</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">1.96</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">12.77</td>
<td style="text-align: center;">14.84</td>
<td style="text-align: center;">3.21</td>
<td style="text-align: center;">2.76</td>
<td style="text-align: center;">0.74</td>
<td style="text-align: center;">TRUE</td>
<td style="text-align: center;">0.73</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">0.97</td>
</tr>
<tr class="odd">
<td style="text-align: center;">yk</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.63</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">11.18</td>
<td style="text-align: center;">6.38</td>
<td style="text-align: center;">3.31</td>
<td style="text-align: center;">5.80</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">1.05</td>
</tr>
<tr class="even">
<td style="text-align: center;">ud</td>
<td style="text-align: center;">k</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.21</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">11.13</td>
<td style="text-align: center;">11.38</td>
<td style="text-align: center;">3.50</td>
<td style="text-align: center;">3.43</td>
<td style="text-align: center;">0.38</td>
<td style="text-align: center;">FALSE</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">1.43</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="descripive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descripive-statistics">Descripive statistics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">skimr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skim</span>(studies)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">studies</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">disease</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">650</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">endpoint</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">null_rejected</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: left;">FAL: 7141, TRU: 2859</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">assumed_delta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">31.39</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">actual_delta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">33.86</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.33</td>
<td style="text-align: right;">7.89</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">266.44</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_planned</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">179.94</td>
<td style="text-align: right;">673.96</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">37.00</td>
<td style="text-align: right;">64.00</td>
<td style="text-align: right;">138.00</td>
<td style="text-align: right;">26294.00</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">n_per_year_assumed</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.68</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">10.02</td>
<td style="text-align: right;">10.51</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">11.96</td>
<td style="text-align: right;">91.31</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_per_year_actual</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9.95</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: right;">5.09</td>
<td style="text-align: right;">7.68</td>
<td style="text-align: right;">9.67</td>
<td style="text-align: right;">11.72</td>
<td style="text-align: right;">100.92</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">expected_study_duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">60.65</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">5.58</td>
<td style="text-align: right;">11.95</td>
<td style="text-align: right;">2255.34</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="even">
<td style="text-align: left;">actual_study_duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.59</td>
<td style="text-align: right;">72.64</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">3.94</td>
<td style="text-align: right;">6.78</td>
<td style="text-align: right;">14.82</td>
<td style="text-align: right;">2827.49</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">actual_power</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: left;">â–‡â–â–â–â–‚</td>
</tr>
<tr class="even">
<td style="text-align: left;">utility_null_rejected</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">â–‡â–‡â–‡â–‡â–‡</td>
</tr>
<tr class="odd">
<td style="text-align: left;">utility_null_not_rejected</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: left;">â–‡â–‡â–‡â–‡â–‡</td>
</tr>
<tr class="even">
<td style="text-align: left;">cost_per_patient</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">35.66</td>
<td style="text-align: left;">â–‡â–â–â–â–</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="additional-aspects" class="level3">
<h3 class="anchored" data-anchor-id="additional-aspects">Additional aspects:</h3>
<ul>
<li><code>expected_study_duration</code> and <code>actual_study_duration</code> have not very realistic values yet â†’ maybe not all of the considered studies would have been feasible due to insufficient patient numbers <code>expected_study_duration</code> <em>very</em> long for some studies</li>
</ul>


</section>
</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-21-generation-of-in-silico-studies/2023-08-21-generation-of-in-silico-studies.html</guid>
  <pubDate>Sun, 20 Aug 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Algorithmic study design â€“ white paper</title>
  <link>https://sbloggel.netlify.app/posts/2023-08-21-algorithmic-study-design----white-paper/2023-08-21-algorithmic-study-design----white-paper.html</link>
  <description><![CDATA[ 



<p>Currently, the design of clinical studies is carried out mostly manually by domaine experts. Here, we want to do first steps to think about how the design of experiments could be done in an algorithmic way, potentially / hopefully resulting in more useful clinical studies.</p>
<section id="what-defines-a-study-design" class="level2">
<h2 class="anchored" data-anchor-id="what-defines-a-study-design">What defines a study design?</h2>
<p>Non-exhaustive list of parameters:</p>
<ul>
<li>Parameter to study (e. g. Hba1c, blood pressure / survival time)</li>
<li>Inclusion criteria (e. g. age &gt; 65 / Diabetes Mellitus Type II)</li>
<li>Intervention / grouping (e. g. Metformine + diet vs.&nbsp;diet only)</li>
<li>Hypotheses (e. g. Hba1c after 3 months in group Metformine + diet lower than in group diet only)</li>
<li>â€¦</li>
</ul>
<section id="open-questions" class="level3">
<h3 class="anchored" data-anchor-id="open-questions">Open questions:</h3>
<ul>
<li>How can we formally describe the space of possible studies?</li>
</ul>
<p>â†’ in the end, a study should be represented as a point <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%20x"> in the space of different study designs</p>
</section>
</section>
<section id="utility-of-a-particular-study-design" class="level2">
<h2 class="anchored" data-anchor-id="utility-of-a-particular-study-design">Utility of a particular study design</h2>
<ul>
<li>Each study design is associated with different possible outcomes</li>
<li>An outcome could be formally defined as the combination of statements about the hypotheses
<ul>
<li><ol start="5" type="a">
<li><ol start="7" type="a">
<li>hypothesis 1 - evidence for alternative hypothesis, hypotheses 2 - no evidence for alternative hypotheses</li>
</ol></li>
</ol></li>
<li>another example: single hypothesis â€“ Hba1c is lower in Metformine group</li>
<li>Not clear, if this definition is sufficient</li>
</ul></li>
<li>We model the utiliy of a study design as a random variable <img src="https://latex.codecogs.com/png.latex?U">, each realization being a study carried out the particular study design</li>
<li>The expected value of <img src="https://latex.codecogs.com/png.latex?U"> can be determined if we have the probabilities and utilities of each outcome</li>
</ul>
</section>
<section id="sketch-of-an-algorithmic-approach" class="level2">
<h2 class="anchored" data-anchor-id="sketch-of-an-algorithmic-approach">Sketch of an algorithmic approach</h2>
<p>Idea: Find an algorithm to maximize the expected utility over the space of different study designs</p>
<ul>
<li>Define the space of all study designs to be taken into consideration
<ul>
<li>Complex, but probably doable in some way, maybe in a meaningful way</li>
</ul></li>
<li>Enumerate all different outcomes of each study
<ul>
<li>Probably doable</li>
</ul></li>
<li>Assign probability and utility to each study outcome of each study in order to determine the expected utility of all studies
<ul>
<li>This is difficult - I donâ€™t know how to algorithmically determine the utility of a study</li>
</ul></li>
<li>Select studies with a high utility
<ul>
<li>I donâ€™t know how to design an â€œoptimizerâ€ in a meaningful / useful way</li>
<li>One idea is to simulate many studies and use the simulations to train an optimizer. But how can we assign utilities to the simulated designs?`</li>
</ul></li>
</ul>
<p>â†’ In conclusion, this approach (especially steps 3 and 4) seems so complex to me that I have doubts if I can do it, I would definitely need guidance how to do it</p>
</section>
<section id="another-approach" class="level2">
<h2 class="anchored" data-anchor-id="another-approach">Another approach?</h2>
<ul>
<li>Does anyone have an idea for an easier approach?</li>
</ul>


</section>

 ]]></description>
  <category>Algorithmic study design</category>
  <guid>https://sbloggel.netlify.app/posts/2023-08-21-algorithmic-study-design----white-paper/2023-08-21-algorithmic-study-design----white-paper.html</guid>
  <pubDate>Sun, 20 Aug 2023 22:00:00 GMT</pubDate>
</item>
</channel>
</rss>
