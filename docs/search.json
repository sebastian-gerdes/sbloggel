[
  {
    "objectID": "posts/2022-10-19-kids-per-person-and-carbonc-footprint/index.html",
    "href": "posts/2022-10-19-kids-per-person-and-carbonc-footprint/index.html",
    "title": "Kids per person and carbon footprint",
    "section": "",
    "text": "Here I want collect a few resources on how much the number of kids you get affects your carbone footprint."
  },
  {
    "objectID": "posts/2022-10-19-kids-per-person-and-carbonc-footprint/index.html#interesting-links",
    "href": "posts/2022-10-19-kids-per-person-and-carbonc-footprint/index.html#interesting-links",
    "title": "Kids per person and carbon footprint",
    "section": "Interesting links",
    "text": "Interesting links\n\nhttps://iopscience.iop.org/article/10.1088/1748-9326/aa7541/meta\nhttps://www.lunduniversity.lu.se/article/four-lifestyle-choices-most-reduce-your-carbon-footprint\nhttps://www.arte.tv/de/videos/086893-003-A/re-kinderlos-dem-klima-zuliebe/"
  },
  {
    "objectID": "posts/2022-10-19-kids-per-person-and-carbonc-footprint/index.html#calculations",
    "href": "posts/2022-10-19-kids-per-person-and-carbonc-footprint/index.html#calculations",
    "title": "Kids per person and carbon footprint",
    "section": "Calculations",
    "text": "Calculations\n\nnr_of_generations_considered <-10\nnr_of_kids_per_person <- 1.7\n\nnr_of_persons <- function(nr_of_generations_considered, nr_of_kids_per_person = 1.7) {\n  responsibility_per_kid <-(1/2)^(1:nr_of_generations_considered)\n  kids_per_generations <- nr_of_kids_per_person^(1:nr_of_generations_considered)\n  total <- sum(responsibility_per_kid * kids_per_generations)\n  return(total)\n}\n\nnr_of_persons_v <- Vectorize(nr_of_persons)\n\nplot(nr_of_persons_v, 1, 100, log = 'x', xlab = 'Number of generations considered on log scale',\n     ylab = 'For how many descendents a person is responsible')\n\n\n\n\nDo calcuation with geometric series:\n\nfoo <- function(nr_of_kids_per_person) {\n  1 / (1 - (nr_of_kids_per_person / 2))\n}  \nplot(foo, 0, 1.9)"
  },
  {
    "objectID": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html",
    "href": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html",
    "title": "Retrieving and plotting COVID-19 data",
    "section": "",
    "text": "The COVID19 package allows to conveniently retrieve statistical data about the COVID-19 pandemy. Here, the data for Germany are retrieved and two exploratory plots are created."
  },
  {
    "objectID": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#loading-libraries",
    "href": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#loading-libraries",
    "title": "Retrieving and plotting COVID-19 data",
    "section": "Loading libraries",
    "text": "Loading libraries\n\nlibrary('ggplot2')\nlibrary('COVID19')"
  },
  {
    "objectID": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#retrieving-the-data",
    "href": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#retrieving-the-data",
    "title": "Retrieving and plotting COVID-19 data",
    "section": "Retrieving the data",
    "text": "Retrieving the data\n\ndeu <- covid19('Germany', level = 1) \n\nWe have invested a lot of time and effort in creating COVID-19 Data Hub, please cite the following when using it:\n\nTo cite package 'COVID19' in publications use:\n\n  Guidotti, E., Ardia, D., (2020), \"COVID-19 Data Hub\", Journal of Open\n  Source Software 5(51):2376, doi: 10.21105/joss.02376.\n\nA BibTeX entry for LaTeX users is\n\n  @Article{,\n    title = {COVID-19 Data Hub},\n    year = {2020},\n    doi = {10.21105/joss.02376},\n    author = {Emanuele Guidotti and David Ardia},\n    journal = {Journal of Open Source Software},\n    volume = {5},\n    number = {51},\n    pages = {2376},\n  }\n\nTo hide this message use 'verbose = FALSE'."
  },
  {
    "objectID": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#plotting-total-number-of-confirmed-cases",
    "href": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#plotting-total-number-of-confirmed-cases",
    "title": "Retrieving and plotting COVID-19 data",
    "section": "Plotting total number of confirmed cases",
    "text": "Plotting total number of confirmed cases\n\nggplot(data = deu, aes(date, confirmed)) + geom_point() + \n  geom_smooth()  + scale_y_log10()\n\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n\n\nWarning: Removed 11 rows containing non-finite values (`stat_smooth()`).\n\n\nWarning: Removed 11 rows containing missing values (`geom_point()`)."
  },
  {
    "objectID": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#plotting-new-cases",
    "href": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#plotting-new-cases",
    "title": "Retrieving and plotting COVID-19 data",
    "section": "Plotting new cases",
    "text": "Plotting new cases\n\ndat <- data.frame(date = deu$date[-1], new_cases = diff(deu$confirmed))\nggplot(data = dat, aes(date, new_cases)) + geom_point() + \n  geom_smooth()  + scale_y_log10()\n\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n\n\nWarning: Removed 18 rows containing non-finite values (`stat_smooth()`).\n\n\nWarning: Removed 18 rows containing missing values (`geom_point()`)."
  },
  {
    "objectID": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#conclusion",
    "href": "posts/2022-10-16-retrieving-and-plotting-covid-19-data/index.html#conclusion",
    "title": "Retrieving and plotting COVID-19 data",
    "section": "Conclusion",
    "text": "Conclusion\nThis package allows convenient retrieval of a lot of data about the COVID-19 pandemy."
  },
  {
    "objectID": "posts/2022-11-24-r-interfaces-to-trial-registries/index.html",
    "href": "posts/2022-11-24-r-interfaces-to-trial-registries/index.html",
    "title": "R interfaces to trial registries",
    "section": "",
    "text": "library('tidyverse')\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   1.0.1 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.5.0 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary('ggVennDiagram')\nlibrary('clinicaltrialr') \n\nresults_q_twist <- ct_read_results('https://www.clinicaltrials.gov/ct2/results?cond=&term=Q-TWiST&type=&rslt=&age_v=&gndr=&intr=&titles=&outc=&spons=&lead=&id=&cntry=&state=&city=&dist=&locn=&rsub=&strd_s=&strd_e=&prcd_s=&prcd_e=&sfpd_s=&sfpd_e=&rfpd_s=&rfpd_e=&lupd_s=&lupd_e=&sort=')\n\nRows: 25 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (25): NCT Number, Title, Acronym, Status, Study Results, Conditions, Int...\ndbl  (2): Rank, Enrollment\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nresults_qas <- ct_read_results('https://www.clinicaltrials.gov/ct2/results?cond=&term=%22quality+adjusted+survival%22&type=&rslt=&age_v=&gndr=&intr=&titles=&outc=&spons=&lead=&id=&cntry=&state=&city=&dist=&locn=&rsub=&strd_s=&strd_e=&prcd_s=&prcd_e=&sfpd_s=&sfpd_e=&rfpd_s=&rfpd_e=&lupd_s=&lupd_e=&sort=')\n\nRows: 42 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (25): NCT Number, Title, Acronym, Status, Study Results, Conditions, Int...\ndbl  (2): Rank, Enrollment\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nstr(results_qas)\n\nspc_tbl_ [42 × 27] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Rank                   : num [1:42] 1 2 3 4 5 6 7 8 9 10 ...\n $ NCT Number             : chr [1:42] \"NCT01117740\" \"NCT02284308\" \"NCT03326570\" \"NCT00591526\" ...\n $ Title                  : chr [1:42] \"Pleural Catheters Versus Thoracoscopic Pleurodesis\" \"Elderly With Locally Advanced Lung Cancer: Deciding Through Geriatric Assessment on the Optimal Treatment Strategy\" \"Effectiveness of Bronchoscopic Interventions for Malignant Airway Obstruction\" \"A Randomized Trial Assessing the Roles of AraC in Newly Diagnosed APL Promyelocytic Leukemia (APL)\" ...\n $ Acronym                : chr [1:42] NA \"ELDAPT\" NA NA ...\n $ Status                 : chr [1:42] \"Completed\" \"Recruiting\" \"Completed\" \"Completed\" ...\n $ Study Results          : chr [1:42] \"No Results Available\" \"No Results Available\" \"No Results Available\" \"No Results Available\" ...\n $ Conditions             : chr [1:42] \"Lung Cancer\" \"NSCLC\" \"Lung Cancer\" \"Leukemia, Promyelocytic, Acute\" ...\n $ Interventions          : chr [1:42] \"Behavioral: MDASI Questionnaire\" \"Other: Blood withdrawal\" \"Behavioral: Medical Data Collection\" \"Drug: Arac\" ...\n $ Outcome Measures       : chr [1:42] \"Quality-Adjusted Survival Times|Patient Responses to MDASI\" \"QAS (quality adjusted survival)|Geriatric assessment|Reliable predictive elements|Predictive value|Development \"| __truncated__ \"Time to Any Complication Requiring Treatment|Quality-Adjusted Survival\" \"for patients with initial WBC counts > 10000/mm3 - the main end point for this second randomization is relapse \"| __truncated__ ...\n $ Sponsor/Collaborators  : chr [1:42] \"M.D. Anderson Cancer Center\" \"Maastricht Radiation Oncology\" \"M.D. Anderson Cancer Center\" \"Groupe d'etude et de travail sur les leucemies aigues promyelocytaires|University Hospital, Lille\" ...\n $ Gender                 : chr [1:42] \"All\" \"All\" \"All\" \"All\" ...\n $ Age                    : chr [1:42] \"18 Years and older   (Adult, Older Adult)\" \"75 Years and older   (Older Adult)\" \"18 Years and older   (Adult, Older Adult)\" \"Child, Adult, Older Adult\" ...\n $ Phases                 : chr [1:42] NA \"Not Applicable\" NA \"Phase 3\" ...\n $ Enrollment             : num [1:42] 445 300 110 250 241 6600 109 40 6500 219 ...\n $ Funded Bys             : chr [1:42] \"Other\" \"Other\" \"Other\" \"Other\" ...\n $ Study Type             : chr [1:42] \"Observational\" \"Interventional\" \"Observational\" \"Interventional\" ...\n $ Study Designs          : chr [1:42] \"Observational Model: Case-Only|Time Perspective: Prospective\" \"Allocation: Randomized|Intervention Model: Parallel Assignment|Masking: None (Open Label)|Primary Purpose: Treatment\" \"Observational Model: Cohort|Time Perspective: Prospective\" \"Allocation: Randomized|Intervention Model: Parallel Assignment|Masking: None (Open Label)|Primary Purpose: Treatment\" ...\n $ Other IDs              : chr [1:42] \"2010-0103\" \"ELDAPT\" \"2011-0563|NCI-2018-01276\" \"APL2000\" ...\n $ Start Date             : chr [1:42] \"April 2010\" \"July 2016\" \"August 25, 2011\" \"June 2000\" ...\n $ Primary Completion Date: chr [1:42] \"April 2016\" \"July 2022\" \"April 1, 2019\" \"June 2004\" ...\n $ Completion Date        : chr [1:42] \"April 2016\" \"July 2023\" \"April 1, 2019\" \"June 2004\" ...\n $ First Posted           : chr [1:42] \"May 5, 2010\" \"November 6, 2014\" \"October 31, 2017\" \"January 11, 2008\" ...\n $ Results First Posted   : chr [1:42] NA NA NA NA ...\n $ Last Update Posted     : chr [1:42] \"April 11, 2016\" \"September 14, 2021\" \"April 16, 2019\" \"January 14, 2008\" ...\n $ Locations              : chr [1:42] \"University of Texas MD Anderson Cancer Center, Houston, Texas, United States\" \"University Hospital Gent, Gent, Belgium|Radiotherepiegroep, Arnhem, Gelderland, Netherlands|Caniusius-Wilhelmin\"| __truncated__ \"University of Texas MD Anderson Cancer Center, Houston, Texas, United States\" NA ...\n $ Study Documents        : chr [1:42] NA NA NA NA ...\n $ URL                    : chr [1:42] \"https://ClinicalTrials.gov/show/NCT01117740\" \"https://ClinicalTrials.gov/show/NCT02284308\" \"https://ClinicalTrials.gov/show/NCT03326570\" \"https://ClinicalTrials.gov/show/NCT00591526\" ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Rank = col_double(),\n  ..   `NCT Number` = col_character(),\n  ..   Title = col_character(),\n  ..   Acronym = col_character(),\n  ..   Status = col_character(),\n  ..   `Study Results` = col_character(),\n  ..   Conditions = col_character(),\n  ..   Interventions = col_character(),\n  ..   `Outcome Measures` = col_character(),\n  ..   `Sponsor/Collaborators` = col_character(),\n  ..   Gender = col_character(),\n  ..   Age = col_character(),\n  ..   Phases = col_character(),\n  ..   Enrollment = col_double(),\n  ..   `Funded Bys` = col_character(),\n  ..   `Study Type` = col_character(),\n  ..   `Study Designs` = col_character(),\n  ..   `Other IDs` = col_character(),\n  ..   `Start Date` = col_character(),\n  ..   `Primary Completion Date` = col_character(),\n  ..   `Completion Date` = col_character(),\n  ..   `First Posted` = col_character(),\n  ..   `Results First Posted` = col_character(),\n  ..   `Last Update Posted` = col_character(),\n  ..   Locations = col_character(),\n  ..   `Study Documents` = col_character(),\n  ..   URL = col_character()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n\n# List of items\nx <- list('Keyword \"Quality-adjusted survival\"' = results_qas$`NCT Number`, \n          'Keyword \"Q-TWiST\"' = results_q_twist$`NCT Number`)\n\n# 2D Venn diagram\nggVennDiagram(x) + theme(legend.position = 'none')"
  },
  {
    "objectID": "posts/2022-11-24-r-interfaces-to-trial-registries/index.html#package-rclinicaltrials",
    "href": "posts/2022-11-24-r-interfaces-to-trial-registries/index.html#package-rclinicaltrials",
    "title": "R interfaces to trial registries",
    "section": "Package ‘rclinicaltrials’",
    "text": "Package ‘rclinicaltrials’\n\nlibrary(rclinicaltrials)\n# z <- clinicaltrials_search(query = 'lime+disease') \n# str(z)\nclinicaltrials_count(query = \"myeloma\") \n\n[1] 3482\n\nclinicaltrials_count(query = \"29485tksrw@\")\n\n[1] 0\n\ny <- clinicaltrials_download(query = 'myeloma', count = 10, include_results = TRUE)\nstr(y)\n\nList of 2\n $ study_information:List of 6\n  ..$ study_info   :'data.frame':   10 obs. of  52 variables:\n  .. ..$ org_study_id                        : chr [1:10] \"RSCD2022004\" \"37587411\" \"69HCL21_0492\" \"Zinc finger protein 217 gene\" ...\n  .. ..$ nct_id                              : chr [1:10] \"NCT05693012\" \"NCT05448404\" \"NCT05331313\" \"NCT04212858\" ...\n  .. ..$ brief_title                         : chr [1:10] \"Assessment of Early Detection and Prognosis Based on cfDNA Methylation in Multiple Myeloma\" \"A Head-to-head Comparative Study of 18F-PSMA-1007 PET/CT and 18F-FDG PET/CT Imaging in Multiple Myeloma\" \"The Aim is to Identify Recurrent Genomic Mutations and/or Predisposing Polymorphisms in Patients With Sporadic \"| __truncated__ \"Amplification of Zinc Finger Protein 217 Gene in Multiple Myeloma\" ...\n  .. ..$ official_title                      : chr [1:10] \"Assessment of Early Detection and Prognosis Based on cfDNA Methylation in Myeloma: a Proof of Concept Study\" \"A Head-to-head Comparative Study of 18F-PSMA-1007 PET/CT and 18F-FDG PET/CT Imaging in Multiple Myeloma\" \"Analysis of Genomic Alterations in Sporadic Cases of Multiple Myeloma\" \"Amplification of Zinc- Finger Protein 217 Gene in Multiple Myeloma Patients as a Prognostic Marker\" ...\n  .. ..$ overall_status                      : chr [1:10] \"Recruiting\" \"Recruiting\" \"Not yet recruiting\" \"Unknown status\" ...\n  .. ..$ start_date.text                     : chr [1:10] \"August 1, 2022\" \"March 8, 2022\" \"December 1, 2022\" \"January 1, 2020\" ...\n  .. ..$ start_date..attrs                   : chr [1:10] \"Actual\" \"Actual\" \"Anticipated\" \"Anticipated\" ...\n  .. ..$ completion_date.text                : chr [1:10] \"December 31, 2024\" \"June 30, 2023\" \"August 31, 2024\" \"February 1, 2022\" ...\n  .. ..$ completion_date..attrs              : chr [1:10] \"Anticipated\" \"Anticipated\" \"Anticipated\" \"Anticipated\" ...\n  .. ..$ completion_date_type                : chr [1:10] \"Anticipated\" \"Anticipated\" \"Anticipated\" \"Anticipated\" ...\n  .. ..$ lead_sponsor/agency                 : chr [1:10] \"Qiu Lugui\" \"First Hospital of China Medical University\" \"Hospices Civils de Lyon\" \"Assiut University\" ...\n  .. ..$ overall_official.last_name          : chr [1:10] \"Lugui Qiu, MD, Ph.D\" NA NA NA ...\n  .. ..$ overall_official.role               : chr [1:10] \"Principal Investigator\" NA NA NA ...\n  .. ..$ overall_official.affiliation        : chr [1:10] \"Chinese Academy of Medical Sciences & Peking Union Medical College\" NA NA NA ...\n  .. ..$ study_type                          : chr [1:10] \"Observational\" \"Interventional\" \"Observational\" \"Interventional\" ...\n  .. ..$ enrollment.text                     : chr [1:10] \"398\" \"30\" \"1000\" \"100\" ...\n  .. ..$ enrollment..attrs                   : chr [1:10] \"Anticipated\" \"Anticipated\" \"Anticipated\" \"Anticipated\" ...\n  .. ..$ primary_condition                   : chr [1:10] \"Multiple Myeloma\" \"Multiple Myeloma\" \"Multiple Myeloma\" \"Multiple Myeloma\" ...\n  .. ..$ primary_outcome.measure             : chr [1:10] \"The sensitivity and specificity of a cfDNA methylation-based early detection modelfor multiple myeloma.\" \"number of myeloma lesions\" \"DNA mutations associated with the existence of multiple myeloma\" \"zinc-finger protein gene 217 in myeloma patients\" ...\n  .. ..$ primary_outcome.time_frame          : chr [1:10] \"12 months\" \"through study completion, an average of 1 year\" \"baseline, pre-intervention/procedure/surgery\" \"2 years\" ...\n  .. ..$ eligibility.sampling_method         : chr [1:10] \"Non-Probability Sample\" NA \"Non-Probability Sample\" NA ...\n  .. ..$ eligibility.textblock.1             : chr [1:10] \"\\n        Inclusion Criteria for Cancer Participants:\\r\\n\\r\\n          -  Age 40-75 years\\r\\n\\r\\n          -  A\"| __truncated__ NA \"\\n        Inclusion Criteria:\\r\\n\\r\\n          -  diagnosis of multiple myeloma\\r\\n\\r\\n          -  availabilit\"| __truncated__ NA ...\n  .. ..$ eligibility.gender                  : chr [1:10] \"All\" \"All\" \"All\" \"All\" ...\n  .. ..$ eligibility.minimum_age             : chr [1:10] \"40 Years\" \"18 Years\" \"18 Years\" \"20 Years\" ...\n  .. ..$ eligibility.maximum_age             : chr [1:10] \"75 Years\" \"N/A\" \"N/A\" \"80 Years\" ...\n  .. ..$ sponsors.lead_sponsor.agency        : chr [1:10] \"Qiu Lugui\" \"First Hospital of China Medical University\" \"Hospices Civils de Lyon\" \"Assiut University\" ...\n  .. ..$ sponsors.lead_sponsor.agency_class  : chr [1:10] \"Other\" \"Other\" \"Other\" \"Other\" ...\n  .. ..$ sponsors.collaborator.agency        : chr [1:10] \"Guangzhou Burning Rock Dx Co., Ltd.\" NA NA NA ...\n  .. ..$ sponsors.collaborator.agency_class  : chr [1:10] \"Industry\" NA NA NA ...\n  .. ..$ date_disclaimer                     : chr [1:10] \"ClinicalTrials.gov processed this data on February 01, 2023\" \"ClinicalTrials.gov processed this data on February 01, 2023\" \"ClinicalTrials.gov processed this data on February 01, 2023\" \"ClinicalTrials.gov processed this data on February 01, 2023\" ...\n  .. ..$ phase                               : chr [1:10] NA \"N/A\" NA \"N/A\" ...\n  .. ..$ primary_outcome.description         : chr [1:10] NA \"comparing the number of myeloma lesions detected by 18F-PSMA-1007 and 18F-FDG PET\" \"DNA data acquired in myeloma patient samples will be compared to those of healthy subjects using publically ava\"| __truncated__ \"Measurement of amplification of Zinc-finger protein 217 gene in Multiple myeloma patients as a prognostic marke\"| __truncated__ ...\n  .. ..$ eligibility.healthy_volunteers      : chr [1:10] NA \"No\" \"No\" \"Accepts Healthy Volunteers\" ...\n  .. ..$ primary_outcome.measure.1           : chr [1:10] NA NA \"DNA mutations associated with the existence of multiple myeloma\" NA ...\n  .. ..$ primary_outcome.time_frame.1        : chr [1:10] NA NA \"during the intervention/procedure/surgery\" NA ...\n  .. ..$ primary_outcome.description.1       : chr [1:10] NA NA \"DNA data acquired in myeloma patient samples will be compared to those of healthy subjects using publically ava\"| __truncated__ NA ...\n  .. ..$ primary_outcome.measure.2           : chr [1:10] NA NA \"DNA mutations associated with the existence of multiple myeloma\" NA ...\n  .. ..$ primary_outcome.time_frame.2        : chr [1:10] NA NA \"immediately after the intervention/procedure/surgery\" NA ...\n  .. ..$ primary_outcome.description.2       : chr [1:10] NA NA \"DNA data acquired in myeloma patient samples will be compared to those of healthy subjects using publically ava\"| __truncated__ NA ...\n  .. ..$ primary_outcome.measure.3           : chr [1:10] NA NA \"DNA mutations associated with the existence of multiple myeloma\" NA ...\n  .. ..$ primary_outcome.time_frame.3        : chr [1:10] NA NA \"at 1 year\" NA ...\n  .. ..$ primary_outcome.description.3       : chr [1:10] NA NA \"DNA data acquired in myeloma patient samples will be compared to those of healthy subjects using publically ava\"| __truncated__ NA ...\n  .. ..$ primary_outcome.measure.4           : chr [1:10] NA NA \"DNA mutations associated with the existence of multiple myeloma\" NA ...\n  .. ..$ primary_outcome.time_frame.4        : chr [1:10] NA NA \"up to 24 weeks\" NA ...\n  .. ..$ primary_outcome.description.4       : chr [1:10] NA NA \"DNA data acquired in myeloma patient samples will be compared to those of healthy subjects using publically ava\"| __truncated__ NA ...\n  .. ..$ primary_outcome.measure.5           : chr [1:10] NA NA \"DNA mutations associated with the existence of multiple myeloma\" NA ...\n  .. ..$ primary_outcome.time_frame.5        : chr [1:10] NA NA \"through study completion, an average of 1 year\" NA ...\n  .. ..$ primary_outcome.description.5       : chr [1:10] NA NA \"DNA data acquired in myeloma patient samples will be compared to those of healthy subjects using publically ava\"| __truncated__ NA ...\n  .. ..$ sponsors.collaborator.agency.1      : chr [1:10] NA NA NA NA ...\n  .. ..$ sponsors.collaborator.agency_class.1: chr [1:10] NA NA NA NA ...\n  .. ..$ sponsors.collaborator.agency.2      : chr [1:10] NA NA NA NA ...\n  .. ..$ sponsors.collaborator.agency_class.2: chr [1:10] NA NA NA NA ...\n  ..$ locations    :'data.frame':   25 obs. of  13 variables:\n  .. ..$ name                    : chr [1:25] \"National Clinical Research Center for Blood Diseases, Blood Diseases Hospital & Institute of Hematology, Chines\"| __truncated__ \"The First Affiliated Hospital of China Medical University\" \"Hospices Civils de Lyon\" \"Centro de Hematologia e Oncologia (CEHON)\" ...\n  .. ..$ address.city            : chr [1:25] \"Tianjin\" \"Shenyang\" \"Pierre Benite\" \"Salvador\" ...\n  .. ..$ address.state           : chr [1:25] \"Tianjin\" \"Liaoning\" NA \"BA\" ...\n  .. ..$ address.zip             : chr [1:25] \"300020\" NA \"69495\" \"40110-150\" ...\n  .. ..$ address.country         : chr [1:25] \"China\" \"China\" \"France\" \"Brazil\" ...\n  .. ..$ status                  : chr [1:25] \"Recruiting\" \"Recruiting\" NA NA ...\n  .. ..$ contact.last_name       : chr [1:25] \"Lugui Qiu, MD, Ph.D\" \"Xuena Li, MD\" NA NA ...\n  .. ..$ contact.phone           : chr [1:25] \"23909172\" \"86-13516035756\" NA NA ...\n  .. ..$ contact.email           : chr [1:25] \"qiulg@ihcams.ac.cn\" \"lixuenacmunm@163.com\" NA NA ...\n  .. ..$ nct_id                  : chr [1:25] \"NCT05693012\" \"NCT05448404\" \"NCT05331313\" \"NCT03506386\" ...\n  .. ..$ contact_backup.last_name: chr [1:25] NA \"Ling Xu, MM\" NA NA ...\n  .. ..$ contact_backup.phone    : chr [1:25] NA \"86-18752118670\" NA NA ...\n  .. ..$ contact_backup.email    : chr [1:25] NA \"xzmcxl@163.com\" NA NA ...\n  ..$ arms         :'data.frame':   14 obs. of  4 variables:\n  .. ..$ arm_group_label: chr [1:14] \"Cancer Arm\" \"Benign Arm\" \"Healthy arm\" \"18F-PSMA-1007 and 18F-FDG PET/CT scan\" ...\n  .. ..$ description    : chr [1:14] \"participants with newly diagnosed multiple myeloma, from whom blood samples will be collected.\" \"Participants with newly diagnosed benign hematologic disorders, from whom blood samples will be collected.\" \"Participants without known presence of malignancies or certain benign diseases, from whom blood samples will be collected.\" \"Patients of multiple myeloma PET/CT imaging: Within one week each patient underwent a PET/CT scan 60-min after \"| __truncated__ ...\n  .. ..$ nct_id         : chr [1:14] \"NCT05693012\" \"NCT05693012\" \"NCT05693012\" \"NCT05448404\" ...\n  .. ..$ arm_group_type : chr [1:14] NA NA NA \"Experimental\" ...\n  ..$ interventions:'data.frame':   12 obs. of  8 variables:\n  .. ..$ intervention_type: chr [1:12] \"Diagnostic Test\" \"Drug\" \"Drug\" \"Genetic\" ...\n  .. ..$ intervention_name: chr [1:12] \"cfDNA methylation assessment\" \"18F-PSMA-1007\" \"18F-FDG\" \"DNA sequencing\" ...\n  .. ..$ description      : chr [1:12] \"An exploratory study to establish the early detection and prognosis models of multiple myeloma patients in Chin\"| __truncated__ \"Intravenous injection of dosage of 222-370MBq(6-10mCi) 18F-PSMA-1007.\" \"Intravenous injection of dosage of 222-370MBq(6-10mCi) 18F-FDG.\" \"The aim of this study is to perform DNA sequencing on abnormal plasmocytes obtained from patients with multiple\"| __truncated__ ...\n  .. ..$ arm_group_label  : chr [1:12] \"Benign Arm\" \"18F-PSMA-1007 and 18F-FDG PET/CT scan\" \"18F-PSMA-1007 and 18F-FDG PET/CT scan\" \"patients with a diagnosis of multiple myeloma\" ...\n  .. ..$ arm_group_label.1: chr [1:12] \"Cancer Arm\" NA NA NA ...\n  .. ..$ arm_group_label.2: chr [1:12] \"Healthy arm\" NA NA NA ...\n  .. ..$ nct_id           : chr [1:12] \"NCT05693012\" \"NCT05448404\" \"NCT05448404\" \"NCT05331313\" ...\n  .. ..$ other_name       : chr [1:12] NA \"18F-PSMA-1007 injection\" \"18F-FDG injection\" NA ...\n  ..$ outcomes     :'data.frame':   35 obs. of  5 variables:\n  .. ..$ measure    : chr [1:35] \"The sensitivity and specificity of a cfDNA methylation-based early detection modelfor multiple myeloma.\" \"The sensitivity and specificity of a cfDNA methylation-based early detection model for multiple myeloma at diff\"| __truncated__ \"The performance of a cfDNA methylation-based prognostic model for multiple myeloma.\" \"The specific cfDNA methylation landscape of multiple myeloma in China\" ...\n  .. ..$ time_frame : chr [1:35] \"12 months\" \"12 months\" \"12 months\" \"12 months\" ...\n  .. ..$ type       : chr [1:35] \"primary_outcome\" \"secondary_outcome\" \"secondary_outcome\" \"secondary_outcome\" ...\n  .. ..$ description: chr [1:35] NA NA \"Treatment response and survival outcomes, measured by ORR, CR, PFS, and OS, in high-risk group and low-risk gro\"| __truncated__ \"The differently methylated regions(DMRs) between multiple myeloma and healthy/benign controls.\" ...\n  .. ..$ nct_id     : chr [1:35] \"NCT05693012\" \"NCT05693012\" \"NCT05693012\" \"NCT05693012\" ...\n  ..$ textblocks   : NULL\n $ study_results    :List of 3\n  ..$ participant_flow:'data.frame':    7 obs. of  6 variables:\n  .. ..$ title   : chr [1:7] \"Overall Study\" \"Overall Study\" \"Overall Study\" \"Overall Study\" ...\n  .. ..$ status  : chr [1:7] \"STARTED\" \"COMPLETED\" \"NOT COMPLETED\" \"STARTED\" ...\n  .. ..$ group_id: chr [1:7] \"P1\" \"P1\" \"P1\" \"P1\" ...\n  .. ..$ count   : chr [1:7] \"943\" \"943\" \"0\" \"5\" ...\n  .. ..$ arm     : chr [1:7] \"Multiple Myeloma Participants\" \"Multiple Myeloma Participants\" \"Multiple Myeloma Participants\" \"Nivolumab+DC/Myeloma Fusions/GM-CSF\" ...\n  .. ..$ nct_id  : chr [1:7] \"NCT03506386\" \"NCT03506386\" \"NCT03506386\" \"NCT03782064\" ...\n  ..$ baseline_data   :'data.frame':    9 obs. of  12 variables:\n  .. ..$ title      : chr [1:9] \"Age\" \"Sex: Female, Male\" \"Race/Ethnicity, Customized\" \"Region of Enrollment\" ...\n  .. ..$ units      : chr [1:9] \"years\" \"Participants\" \"Participants\" \"Participants\" ...\n  .. ..$ param      : chr [1:9] \"Mean\" \"Count of Participants\" \"Count of Participants\" \"Count of Participants\" ...\n  .. ..$ dispersion : chr [1:9] \"Standard Deviation\" NA NA NA ...\n  .. ..$ subtitle   : chr [1:9] NA NA \"Race\" \"Brazil\" ...\n  .. ..$ group_id   : chr [1:9] \"B1\" \"B1\" \"B1\" \"B1\" ...\n  .. ..$ value      : chr [1:9] \"68.4\" \"437\" \"576\" \"943\" ...\n  .. ..$ spread     : chr [1:9] \"11.9\" NA NA NA ...\n  .. ..$ arm        : chr [1:9] \"Multiple Myeloma Participants\" \"Multiple Myeloma Participants\" \"Multiple Myeloma Participants\" \"Multiple Myeloma Participants\" ...\n  .. ..$ nct_id     : chr [1:9] \"NCT03506386\" \"NCT03506386\" \"NCT03506386\" \"NCT03506386\" ...\n  .. ..$ lower_limit: chr [1:9] NA NA NA NA ...\n  .. ..$ upper_limit: chr [1:9] NA NA NA NA ...\n  ..$ outcome_data    :'data.frame':    8 obs. of  13 variables:\n  .. ..$ type                : chr [1:8] \"Primary\" \"Primary\" \"Secondary\" \"Secondary\" ...\n  .. ..$ title               : chr [1:8] \"Number of Multiple Myeloma (MM) Participants Categorized by Clinical Characteristics\" \"Number of Multiple Myeloma (MM) Participants Categorized by Treatment Patterns\" \"Overall Survival (OS)\" \"Duration of Treatment\" ...\n  .. ..$ description         : chr [1:8] \"MM clinical characteristics upon diagnosis were classified by eligibility criteria for transplantation (eligibl\"| __truncated__ \"Treatment patterns were collected from institutional charts [included public institution, private institution a\"| __truncated__ \"Overall survival was defined as the time elapsed between the date of diagnosis until death, with censoring of p\"| __truncated__ \"Duration of treatment was defined with respect to selected lines or regimens of interest, considering the time \"| __truncated__ ...\n  .. ..$ time_frame          : chr [1:8] \"From initial diagnosis up to end of follow up treatment or to the retrospective cut-off date within the time of\"| __truncated__ \"From initial diagnosis up to end of follow up treatment or to the retrospective cut-off date within the time of\"| __truncated__ \"From the date of diagnosis up to death within the period of interest (between January 1, 2008, and December 31,\"| __truncated__ \"From treatment initiation up to discontinuation of treatment or lost to follow-up, whichever occurs first up to\"| __truncated__ ...\n  .. ..$ population          : chr [1:8] \"All participants eligible for analyses were included. Number analyzed are the participants with data available \"| __truncated__ \"All participants eligible for analyses were included. Number analyzed are the number of participants with evalu\"| __truncated__ \"All participants eligible for analyses who had non-missing observations were analyzed. Number analyzed is the n\"| __truncated__ \"All participants eligible for analyses who had non-missing observations were analyzed. Number analyzed is the n\"| __truncated__ ...\n  .. ..$ measure             : chr [1:8] \"Number of Multiple Myeloma (MM) Participants Categorized by Clinical CharacteristicsMM clinical characteristics\"| __truncated__ \"Number of Multiple Myeloma (MM) Participants Categorized by Treatment PatternsTreatment patterns were collected\"| __truncated__ \"Overall Survival (OS)Overall survival was defined as the time elapsed between the date of diagnosis until death\"| __truncated__ \"Duration of TreatmentDuration of treatment was defined with respect to selected lines or regimens of interest, \"| __truncated__ ...\n  .. ..$ group_id            : chr [1:8] NA NA \"O1\" NA ...\n  .. ..$ non_inferiority_type: chr [1:8] NA NA \"Other\" NA ...\n  .. ..$ p_value             : chr [1:8] NA NA \"< 0.0001\" NA ...\n  .. ..$ p_value_desc        : chr [1:8] NA NA \"Statistical differences among eligible performed, eligible not performed and not eligible participants were est\"| __truncated__ NA ...\n  .. ..$ method              : chr [1:8] NA NA \"Log Rank\" NA ...\n  .. ..$ arm                 : chr [1:8] NA NA \"Multiple Myeloma Participants\" NA ...\n  .. ..$ nct_id              : chr [1:8] \"NCT03506386\" \"NCT03506386\" \"NCT03506386\" \"NCT03506386\" ..."
  },
  {
    "objectID": "posts/2022-11-24-r-interfaces-to-trial-registries/index.html#package-cthist",
    "href": "posts/2022-11-24-r-interfaces-to-trial-registries/index.html#package-cthist",
    "title": "R interfaces to trial registries",
    "section": "Package ‘cthist’",
    "text": "Package ‘cthist’\n\nhttps://www.ncbi.nlm.nih.gov/pmc/articles/PMC9249399/\n\n\nlibrary(tidyverse)\nlibrary(cthist)\nlibrary(lubridate)\n\nLoading required package: timechange\n\n\n\nAttaching package: 'lubridate'\n\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union"
  },
  {
    "objectID": "posts/2023-01-05-contribution-plots/index.html",
    "href": "posts/2023-01-05-contribution-plots/index.html",
    "title": "Contribution plots",
    "section": "",
    "text": "library('tibble')\nlibrary('ggplot2')\nlibrary('RColorBrewer')\nlibrary('plotly')\n\n\nAttaching package: 'plotly'\n\n\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n\n\nThe following object is masked from 'package:stats':\n\n    filter\n\n\nThe following object is masked from 'package:graphics':\n\n    layout\n\ntheme_set(theme_minimal())\n#help(package = 'RColorBrewer')\nnr_of_clones <- 11\nnr_of_timepoins <- 20\n\ndat <- tibble(t = rep(1:nr_of_timepoins, each = nr_of_clones),\n              p = abs(rnorm(nr_of_clones * nr_of_timepoins)),\n              s = rep(1:nr_of_clones, nr_of_timepoins))\n\ndat$p <- dat$p / rep(tapply(dat$p, dat$t, sum), each = nr_of_clones)\n\n# my_cols <- rainbow(nr_of_clones)\nmy_cols <- brewer.pal(nr_of_clones, 'Spectral')\n\n(g <- ggplot(dat, aes(x = t, y = p, group = factor(s), fill = factor(s))) + \n  geom_area(alpha = 0.65) + \n  scale_fill_manual(name = 'State', values = my_cols) +\n  xlab('Time') + ylab('Relative contibution'))\n\n\n\nggplotly(g)"
  },
  {
    "objectID": "posts/2023-01-05-contribution-plots/index.html#another-plotly-plot",
    "href": "posts/2023-01-05-contribution-plots/index.html#another-plotly-plot",
    "title": "Contribution plots",
    "section": "Another plotly plot",
    "text": "Another plotly plot\n\n(g <- ggplot(cars, aes(dist, speed)) + geom_point())\n\n\n\nggplotly(g)"
  },
  {
    "objectID": "posts/2022-09-08-antipsychotics/index.html",
    "href": "posts/2022-09-08-antipsychotics/index.html",
    "title": "Antipsychotics",
    "section": "",
    "text": "Dopamin-Rezeptoren\n\nD_1/D_5-Gruppe: Signalübertragung durch stimulatorisches G-Protein –> cAMP hoch\nD_2/D_3/D_4-Gruppe: Signalübertragung durch hemmendes G-Protein –> cAMP runter\n\n\n\nWichtige dopaminerge Neuronensysteme\n\nNigrostriatales System: Motorik (damit auch EPS)\nMesolimbisches / mesokortikales System: Hauptangriffsort der Antipsychotika\nTuberoinfundibuläres System: vermittelt die neuroendokrinologischen NW, insbesondere Prolaktin-Anstieg\n\n\n\nAntipsychotika\n\n\nWarning in read.ods(\"Antipsychotics.ods\", sheet = 1): read.ods will be\ndepreciated in the next version. Use read_ods instead.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSubstanz\nKlasse\nTrizyklisch\nTyp\nPotenz\nD1\nD2\nD3\nSer2\nM1\nalpha1\nH1\n\n\n\n\nAmisulprid\nBenzamid\n0\nAAP\nNA\n0\n3\n3\n0\n0\n0\n0\n\n\nAripiprazol\nPhenylpiperazinylcholin\n0\nAAP\nNA\n0\n3\n3\n2\n0\n1\n1\n\n\nAsenapin\nDibenzooxepinpyrrol\n0\nAAP\nNA\n1\n1\n2\n2\n0\n1\n1\n\n\nBenperidol\nButyrophenon\n0\nKAP\nHP\n0\n3\n2\n2\n0\n1\n0\n\n\nBromperidol\nButyrophenon\n0\nKAP\nHP\n1\n3\n2\n0\n0\n1\n0\n\n\nChorprothixen\nThioxanthen\n1\nKAP\nNP\n2\n1\n1\n2\n1\n1\n3\n\n\nClozapin\nDibenzodiazepin\n1\nAAP\nNA\n2\n1\n2\n3\n3\n1\n3\n\n\nFlupentixol\nThioxeanthen\n1\nKAP\nHP\n2\n3\n3\n2\n0\n1\n1\n\n\nFluphenazin\nPhenothiazin\n1\nKAP\nHP\n2\n3\n3\n2\n0\n2\n2\n\n\nFluspirilen\nDiphenylbutylpiperidin\n0\nKAP\nHP\n1\n3\n2\n1\n0\n0\n0\n\n\nHaloperidol\nButyrophenon\n0\nKAP\nHP\n2\n3\n2\n1\n0\n2\n0\n\n\nLevomepromazin\nPhenothiazin\n1\nKAP\nNP\n0\n1\n1\n1\n2\n2\n2\n\n\nLoxapin\nDibenzoxazepin\n1\nKAP\nMP\n0\n3\n1\n3\n2\n3\n3\n\n\nLurasidon\nBenzoisothiazol\n0\nAAP\nNA\n1\n3\n2\n3\n0\n2\n0\n\n\nMelperon\nButyrophenon\n0\nKAPA\nNP\n0\n1\n1\n2\n0\n1\n1\n\n\nOlanzapin\nThienobenzazepin\n1\nAAP\nNA\n2\n3\n2\n3\n2\n2\n3\n\n\nPaliperidon\nBenzisoxazol\n0\nAAP\nNA\n0\n3\n1\n3\n0\n1\n1\n\n\nPerazin\nPhenothiazin\n1\nKAP\nMP\n0\n2\n2\n2\n1\n2\n3\n\n\nPerphenazin\nPhenothiazin\n1\nKAP\nHP\n0\n3\n3\n2\n0\n2\n2\n\n\nPimozid\nDiphenylbutylpiperidin\n0\nKAP\nHP\n0\n3\n3\n2\n0\n0\n0\n\n\nPipameron\nButyrophenon\n0\nKAP\nNP\n0\n1\n1\n2\n0\n1\n0\n\n\nProthipendyl\nPhenothiazin\n1\nKAP\nNP\nNA\n1\nNA\nNA\nNA\nNA\nNA\n\n\nQuetiapin\nDibenzothiazepin\n1\nAAP\nNA\n1\n1\n1\n1\n0\n1\n2\n\n\nRisperidon\nBenzisoxazol\n0\nAAP\nNA\n2\n3\n2\n3\n0\n3\n1\n\n\nSertindol\nIndol\n0\nAAP\nNA\n2\n3\n1\n3\n0\n2\n0\n\n\nSulpirid\nBenzamid\n0\nKAPA\nMP\n0\n1\n3\n0\n0\n0\n0\n\n\nThioridazin\nPhenothiazin\n1\nKAP\nNP\n1\n2\n1\n2\n3\n3\n1\n\n\nZiprasidon\nBenzisothiazin\n0\nAAP\nNA\n1\n2\n2\n3\n0\n1\n2\n\n\nZuclopenthixol\nThioxanthen\n1\nKAP\nMP\n2\n3\n2\n0\n3\n3\n3\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSubstanz\nKlasse\nTrizyklisch\nTyp\nPotenz\nD1\nD2\nD3\nSer2\nM1\nalpha1\nH1\n\n\n\n\n\nAmisulprid : 1\nPhenothiazin : 6\nMin. :0.0000\nAAP :11\nHP : 8\nMin. :0.0000\nMin. :1.000\nMin. :1.000\nMin. :0.000\nMin. :0.0000\nMin. :0.000\nMin. :0.00\n\n\n\nAripiprazol : 1\nButyrophenon : 5\n1st Qu.:0.0000\nKAP :16\nMP : 4\n1st Qu.:0.0000\n1st Qu.:1.000\n1st Qu.:1.000\n1st Qu.:1.000\n1st Qu.:0.0000\n1st Qu.:1.000\n1st Qu.:0.00\n\n\n\nAsenapin : 1\nBenzamid : 2\nMedian :0.0000\nKAPA: 2\nNP : 6\nMedian :1.0000\nMedian :3.000\nMedian :2.000\nMedian :2.000\nMedian :0.0000\nMedian :1.000\nMedian :1.00\n\n\n\nBenperidol : 1\nBenzisoxazol : 2\nMean :0.4483\nNA\nNA’s:11\nMean :0.8929\nMean :2.276\nMean :1.929\nMean :1.857\nMean :0.6071\nMean :1.429\nMean :1.25\n\n\n\nBromperidol : 1\nDiphenylbutylpiperidin: 2\n3rd Qu.:1.0000\nNA\nNA\n3rd Qu.:2.0000\n3rd Qu.:3.000\n3rd Qu.:2.250\n3rd Qu.:3.000\n3rd Qu.:1.0000\n3rd Qu.:2.000\n3rd Qu.:2.00\n\n\n\nChorprothixen: 1\nThioxanthen : 2\nMax. :1.0000\nNA\nNA\nMax. :2.0000\nMax. :3.000\nMax. :3.000\nMax. :3.000\nMax. :3.0000\nMax. :3.000\nMax. :3.00\n\n\n\n(Other) :23\n(Other) :10\nNA\nNA\nNA\nNA’s :1\nNA\nNA’s :1\nNA’s :1\nNA’s :1\nNA’s :1\nNA’s :1"
  },
  {
    "objectID": "posts/2022-09-08-timeline/index.html",
    "href": "posts/2022-09-08-timeline/index.html",
    "title": "Timeline",
    "section": "",
    "text": "format_ods_data_frame <- \n  function(dat, \n           colnames = TRUE, \n           type_definition = TRUE) {\n    \n    result <- dat\n    \n    if (colnames) {\n      result <- result[-1, ]\n      colnames(result) <- dat[1, ]\n    }\n    \n    if (type_definition) {\n      type_defs <- result[1, ]\n      result <- result[-1, ]\n      for (i in 1:ncol(dat)) {\n        if (type_defs[i] == 'Factor') {\n          result[result[, i] == '', i] <- NA\n          result[, i] <- as.factor(result[, i])  \n        }\n        if (type_defs[i] == 'Numeric')\n          result[, i] <- as.numeric(result[, i])\n        if (type_defs[i] == 'Character')\n          result[, i] <- as.character(result[, i])\n      }\n    }\n    rownames(result) <- NULL\n    return(result)\n  }\n\nplot_timeline <- function(label,\n                          begin, \n                          end, \n                          group = NULL) {\n  n <- length(label)\n  if(is.null(group)) {\n    group <- 1:n\n  } else {\n    group <- as.numeric(group)\n  }\n  timeline_colors <- rainbow(max(group), \n                             s = 0.1)\n  par(mar = c(3.1, 2.1, 2.1, 2.1))\n  plot(0, type = 'n',\n       ylab = '', xlab = '', yaxt = 'n',\n       ylim = c(n, 0), \n       xlim = range(begin, end))\n  grid()\n  rect(xleft = begin,\n       xright = end,\n       ybottom = 0:(n - 1) + 0.1,\n       ytop = 1:n - 0.1,\n       col = timeline_colors[group])\n  text((begin + end) / 2,\n       1:n - 0.5,\n       label)\n}\n\n\nlibrary('readODS')\nModernism <- format_ods_data_frame(\n  read.ods('Art_Modernism.ods', \n           sheet = 1))\n\nWarning in read.ods(\"Art_Modernism.ods\", sheet = 1): read.ods will be\ndepreciated in the next version. Use read_ods instead.\n\n\n\npar(mar = c(3.1, 2.1, 2.1, 2.1))\nplot(0, type = 'n',\n     ylab = '', xlab = '', yaxt = 'n',\n     ylim = c(nrow(Modernism), 0), \n     xlim = range(Modernism$Begin, Modernism$End))\ngrid()\nrect(xleft = Modernism$Begin,\n     xright = Modernism$End,\n     ybottom = 0:(nrow(Modernism) - 1) + 0.1,\n     ytop = 1:nrow(Modernism) - 0.1,\n     col = rainbow(nrow(Modernism), \n                   s = 0.2))\ntext((Modernism$Begin + Modernism$End) / 2,\n     1:nrow(Modernism) - 0.5,\n     Modernism$Label)\n\n\n\n\n\npainters <- format_ods_data_frame(\n  read.ods('Painters.ods', sheet = 1))\n\nWarning in read.ods(\"Painters.ods\", sheet = 1): read.ods will be depreciated in\nthe next version. Use read_ods instead.\n\nwith(painters, \n     plot_timeline(Label, Begin, End, group = Group))"
  },
  {
    "objectID": "posts/2023-01-20-sirs-model-dynamics/index.html",
    "href": "posts/2023-01-20-sirs-model-dynamics/index.html",
    "title": "SIRS model dynamics",
    "section": "",
    "text": "library('ggplot2')\nlibrary('tidyverse')\nlibrary('deSolve')\ntheme_set(theme_bw())"
  },
  {
    "objectID": "posts/2023-01-20-sirs-model-dynamics/index.html#analytical",
    "href": "posts/2023-01-20-sirs-model-dynamics/index.html#analytical",
    "title": "SIRS model dynamics",
    "section": "Analytical",
    "text": "Analytical\nSolution in terms of parameters in red.\n\nEquilibrium conditions:\n\\[S + I + R = 1 \\qquad (1)\\] \\[0 = -\\beta I S + \\lambda R \\qquad (2)\\] \\[0 = \\beta I S - \\gamma I \\qquad (3)\\] \\[0 = \\gamma I - \\lambda R \\qquad (4)\\]\n\n\nAlgebraic transformation:\n\\[ R = 1 - S - I \\qquad (1b)\\] \\[ S = \\gamma / \\beta \\qquad (3b)\\]\n\n\nPlugging in:\n\\[ (3b) \\rightarrow (2): I = \\lambda / \\gamma R  \\qquad (5)\\] \\[ (1b) \\rightarrow (5): I = \\frac{\\lambda(\\beta - \\gamma)}{\\beta(\\gamma + \\lambda)} \\qquad (6)\\] \\[ (3b) + (6) \\rightarrow (1b): R = \\frac{\\gamma(\\beta - \\gamma)}{\\beta(\\gamma + \\lambda)} \\qquad (7)\\]\n\n\nPlots\n\nlast_w <- pivot_wider(last, names_from = name, values_from = value)\nlast_w$S + last_w$I + last_w$R\n\n  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[260] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[297] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[334] 1 1 1 1 1 1 1 1 1 1\n\nlast_w$S_calc <- pmin(1, last_w$gamma / last_w$beta)\nlast_w$I_calc <- pmax(0, pmin(1, with(last_w, (lambda * (beta - gamma))) / (beta * (gamma + lambda))))\nlast_w$R_calc <- pmax(0, pmin(1, with(last_w, (gamma * (beta - gamma)) / (beta * (gamma + lambda)))))\nggplot(last_w, aes(S, S_calc)) + geom_point()\n\n\n\nggplot(last_w, aes(I, I_calc)) + geom_point()\n\n\n\nggplot(last_w, aes(R, R_calc)) + geom_point()\n\n\n\nlast_w$I_calc <- 1 - last_w$S_calc - last_w$R_calc\n\nlast <- pivot_longer(last_w, cols = c('S_calc', 'I_calc', 'R_calc'))\nglimpse(last)\n\nRows: 1,029\nColumns: 9\n$ time   <dbl> 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100…\n$ beta   <dbl> 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, …\n$ gamma  <dbl> 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, …\n$ lambda <dbl> 0.125, 0.125, 0.125, 0.250, 0.250, 0.250, 0.500, 0.500, 0.500, …\n$ S      <dbl> 0.9273226, 0.9273226, 0.9273226, 0.9279320, 0.9279320, 0.927932…\n$ I      <dbl> 3.481509e-02, 3.481509e-02, 3.481509e-02, 4.742894e-02, 4.74289…\n$ R      <dbl> 3.786233e-02, 3.786233e-02, 3.786233e-02, 2.463904e-02, 2.46390…\n$ name   <chr> \"S_calc\", \"I_calc\", \"R_calc\", \"S_calc\", \"I_calc\", \"R_calc\", \"S_…\n$ value  <dbl> 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, …\n\nlast %>%\n  ggplot(aes(x = beta, y = value, fill = name)) + geom_area() +\n  facet_grid(rows = vars(gamma), cols = vars(lambda), labeller = label_both) +\n  ylab('Fraction') + xlab('beta') + labs(colour = 'Compartment') +\n  scale_x_continuous(trans='log10')"
  },
  {
    "objectID": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html",
    "href": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html",
    "title": "SIR-like model with deSolve in deterministic and stochastic version",
    "section": "",
    "text": "Here, an model based on the SIR model is presented in a deterministic version and in a non-deterministic version. For solving the ODEs (deterministic version) and the stochastic difference equations (stochastic version), the R package deSolve is used."
  },
  {
    "objectID": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#defining-and-solving-a-simple-ode-model",
    "href": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#defining-and-solving-a-simple-ode-model",
    "title": "SIR-like model with deSolve in deterministic and stochastic version",
    "section": "Defining and solving a simple ODE model",
    "text": "Defining and solving a simple ODE model\nA simplified SIR model: \\[ \\frac{dS}{dt} = -\\frac{\\beta I S}{N} \\]\n\\[ \\frac{dI}{dt} = \\frac{\\beta I S}{N} - \\gamma I \\]\n\\[ \\frac{dR}{dt} = \\gamma I \\]"
  },
  {
    "objectID": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#loading-the-required-libraries-and-defining-utility-functions",
    "href": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#loading-the-required-libraries-and-defining-utility-functions",
    "title": "SIR-like model with deSolve in deterministic and stochastic version",
    "section": "Loading the required libraries and defining utility functions",
    "text": "Loading the required libraries and defining utility functions\n\nlibrary('ggplot2')\nlibrary('tidyverse')\nlibrary('deSolve')\ntheme_set(theme_bw())\n\n\nplot_deSolve_result <- function(result) {\n  tib <- as_tibble(unclass(result))  \n  vars <- colnames(result)[-1]\n  long <- pivot_longer(tib, cols = all_of(vars))\n  long$name <- factor(long$name, levels = c('S', 'I', 'R'))\n  ggplot(long, aes(time, value, colour = name)) + \n    geom_line() + \n    labs(colour = 'Compartment', \n         x = 'Time',\n         y = 'Fraction')\n}"
  },
  {
    "objectID": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#definition-of-the-parameters",
    "href": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#definition-of-the-parameters",
    "title": "SIR-like model with deSolve in deterministic and stochastic version",
    "section": "Definition of the parameters",
    "text": "Definition of the parameters\n\nparameters <- list(beta = 0.2, \n                   gamma = .01,\n                   lambda = 0)\n\ninfected_initial <- 0.01\ninitial_condition <- \n  c(S = 1 - infected_initial,\n    I = infected_initial,\n    R = 0)\n\nt_max <- 100\nstep_length <- t_max / 100\ntimepoints <- seq(0, 150, length.out = 100)"
  },
  {
    "objectID": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#deterministic-model",
    "href": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#deterministic-model",
    "title": "SIR-like model with deSolve in deterministic and stochastic version",
    "section": "Deterministic model",
    "text": "Deterministic model\n\nsir_ode_deterministic <- function(t, state, pars) {\n  with(as.list(c(state, pars)), {\n    dS <- - beta * I * S + lambda * R\n    dI <- beta * I * S - gamma * I\n    dR <- gamma * I - lambda * R\n    return(list(c(dS = dS, dI = dI, dR = dR)))\n  }) \n}\n\n\nsir_solution_deterministic <- \n  ode(y = initial_condition, \n      times = timepoints,\n      func = sir_ode_deterministic,\n      parms = parameters)\nplot_deSolve_result(sir_solution_deterministic)"
  },
  {
    "objectID": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#stochastic-model",
    "href": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#stochastic-model",
    "title": "SIR-like model with deSolve in deterministic and stochastic version",
    "section": "Stochastic model",
    "text": "Stochastic model\n\nsir_ode_stochastic <- function(t, state, pars) {\n  with(as.list(c(state, pars)), {\n    S_new <- S - beta * I * S * step_length\n    I_new <- I + (beta * I * S - gamma * I) * step_length\n    R_new <- R + gamma * I * step_length\n    \n    new_values <-c(S = S_new, I = I_new, R = R_new)\n    new_values <- new_values * rlnorm(3, meanlog = 0, sdlog = 0.05)\n    new_values <- new_values / sum(new_values)\n    return(list(new_values))\n  })\n}\n\nsir_solution_stochastic <- \n  ode(y = initial_condition, \n      times = timepoints,\n      func = sir_ode_stochastic,\n      parms = parameters, \n      method = 'iteration')\n\nplot_deSolve_result(sir_solution_stochastic)"
  },
  {
    "objectID": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#conclusion",
    "href": "posts/2022-10-04-sir-like-model-with-desolve-in-deterministic-and-stochastic-version/index.html#conclusion",
    "title": "SIR-like model with deSolve in deterministic and stochastic version",
    "section": "Conclusion",
    "text": "Conclusion\nThe R package deSolve can be used to solve deterministic ODEs and stochastic difference equations."
  },
  {
    "objectID": "posts/2022-10-16-leo-s-project/index.html",
    "href": "posts/2022-10-16-leo-s-project/index.html",
    "title": "Leo’s project",
    "section": "",
    "text": "In hematological cancers, blood stem cells can be transferred to a patient after chemothery. The blood stem cells may proliferate in the patient and populate the patient’s peripheral blood afterwards.\nChimerism is defined as the ratio of the number of blood cells originating from the transplanted cells and the total number of blood cells in the patient’s blood.\nHere, a sigmoidal model for the temporal development of chimerism after transplantion is introduced and in silico data are simulated.\nLeo also posted a question about this model on the STAN forum: https://discourse.mc-stan.org/t/bad-diagnostics-with-multilevel-models/29091?u=leonhardschwager\n\n\n\n\nlibrary('tidyverse')\nset.seed(1)\n\n\n\n\n\nSource: https://en.wikipedia.org/wiki/Logistic_function\n\n\ncalc_chimerism <- function(day, d = 1, b = 1, e = 5) {\n# day: for which day the chimerism shall be calculated\n# d: maximum value of the curve\n# b: the logistic growth rate or steepness of the curve\n# e:  location of the midpoint of the sigmoid function\n  d / (1 + exp(-b * (day - e)))\n}\n\n# plot the function with default values:\nggplot() + stat_function(fun = calc_chimerism) + \n  xlim(0, 10) + labs(x = 'Time', y = 'Chimerism')\n\n\n\n\n\n\n\n\nnr_of_patients <- 10\nnr_of_measurements <- 10 # per patient\nd <- runif(n = nr_of_patients, min = 0.6, max = 1)\nb <- rnorm(n = nr_of_patients, mean = 1, sd = 0.1)\ne <- runif(n = nr_of_patients, min = 5, max = 15)\n\n\n\n\n\ndat <- tibble(patient_id = factor(1:nr_of_patients), \n              d = d, \n              b = b, \n              e = e) %>%\n  expand_grid(measurement = 1:nr_of_measurements)\n\n# compute timepoints symetrical equidistant \n# in both directions of the sigmoid midpoint \n# of the curve:\ndat$day <- dat$e * 2 * dat$measurement / nr_of_measurements\n\n\n\n\n\ndat$chimerism <- calc_chimerism(day = dat$day, \n                                d = dat$d, \n                                b = dat$b, \n                                e = dat$e)\n\n\n\n\n\nggplot(dat, aes(day, chimerism)) + \n  geom_point() + geom_line() + \n  facet_wrap(~ patient_id, ncol = 3, scales = 'free_x') + \n  xlim(0, NA) + ylim(0, 1)\n\n\n\nggplot(dat, aes(day, chimerism, color = patient_id)) + \n  geom_point() + geom_line() + \n  ylim(0, 1)"
  },
  {
    "objectID": "posts/2022-10-16-leo-s-project/index.html#fitting-a-simple-model",
    "href": "posts/2022-10-16-leo-s-project/index.html#fitting-a-simple-model",
    "title": "Leo’s project",
    "section": "Fitting a simple model",
    "text": "Fitting a simple model\n\nlibrary('brms')\n\nLoading required package: Rcpp\n\n\nLoading 'brms' package (version 2.18.0). Useful instructions\ncan be found by typing help('brms'). A more detailed introduction\nto the package is available through vignette('brms_overview').\n\n\n\nAttaching package: 'brms'\n\n\nThe following object is masked from 'package:stats':\n\n    ar\n\n# help(package = 'brms')\n# prior1 <- prior(normal(1, 0.1), nlpar = ')"
  },
  {
    "objectID": "posts/2022-07-19-sir-model/index.html",
    "href": "posts/2022-07-19-sir-model/index.html",
    "title": "SIR model",
    "section": "",
    "text": "Here I want to show some sample calculations using the SIR model (https://simple.wikipedia.org/wiki/SIR_model, https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology).\nThe SIR model is a simple ordinary differential equation model that describes the dynamics of an epidemic within a population. The model has three variables:\n\n\\(S\\) (= susceptible) quantifies the susceptible individuals\n\\(I\\) (= infectious) quantifies the individuals who are infected with the disease and can transmit the disease to susceptible individuals\n\\(R\\) (= recovered) quantifies the individuals who have recovered from the disease and can no longer be infected with the disease\n\nThe following equations describe the dynamics of the model: \\[ \\frac{dS}{dt} = -\\frac{\\beta I S}{N} \\]\n\\[ \\frac{dI}{dt} = \\frac{\\beta I S}{N} - \\lambda I \\]\n\\[ \\frac{dR}{dt} = \\lambda I \\]\nIn the following, we solve the model equations for a random parameter set.\nFurthermore, we fix \\(N\\) to \\(1\\) and set the initial conditions in a way that \\(S + I + R = 1\\) so that \\(S\\), \\(R\\) and \\(I\\) describe fractions of the population.\n\nparameters <- c(beta = 2, \n                gamma = 1)\n\ninfected_initial <- 0.01\ninitial_condition <- \n  c(S = 1 - infected_initial,\n    I = infected_initial,\n    R = 0)\n\ntimepoints <- seq(0, 15, by = .1)\n\nThen we define the model equations in R:\n\nSIR_ODE = function(time, state, parameters){\n  with(as.list(c(state, parameters)), {\n    dS <- -beta * I * S\n    dI <- beta * I * S - gamma * I\n    dR <- gamma * I\n    list(c(dS, dI, dR))\n    })\n  }\n\nFinally, we use the function ode from the deSolve package to solve the ordinary differential equations:\n\nlibrary(deSolve)\nresult <- ode(y = initial_condition, \n             times = timepoints, \n             func = SIR_ODE, \n             parms = parameters)\n\nNow we use the builtin plot function from the deSolve-package to visualize the solution:\n\nplot(result)\n\n\n\n\nWe can make some plots that are nicer looking in my taste with the lattice package. To rearrange the data from ‘wide’ to ‘long’ format (as needed for the lattice package), we use the tidyverse package.\n\nlibrary(lattice)\nlibrary(tidyverse)\n\n# convert data from wide to long format:\nlong <- as.data.frame(result) %>% \n  pivot_longer(cols = c('S', 'I', 'R'), \n               names_to = 'variable')\n\n# order factor levels so they appear in the plots in the desired order:\nlong$variable = factor(long$variable, levels = c('S', 'I', 'R'))\n\n# plot all three variables in the same panel:\nxyplot(value ~ time, \n       data = long, \n       group = variable, \n       auto.key = list(space = 'right', \n                       lines = TRUE, \n                       points = FALSE), \n       type = 'l',\n       lwd = 3)\n\n\n\n# plot the variables in separate panels:\nxyplot(value ~ time | variable, \n       data = long, \n       type = 'l', \n       lwd = 3)\n\n\n\n\nVery similar plots can be made with the ggplot2 library:\n\nggplot(data = long, aes(time, value, colour = variable)) + geom_line() + theme_classic() +\n  labs(x = 'Time', y = 'Fraction', colour = 'Compartment')\n\n\n\nggplot(data = long, aes(time, value)) + geom_line() +\n  labs(x = 'Time', y = 'Fraction', colour = 'Compartment') + facet_wrap(~ variable) + theme_classic()"
  },
  {
    "objectID": "posts/2023-01-10-sustainibility-data/index.html",
    "href": "posts/2023-01-10-sustainibility-data/index.html",
    "title": "Sustainibility data",
    "section": "",
    "text": "Quelle: Blog\nEnergie pro Jahr:\n\n\n# Wie viele Watt pro qm Erdoberfläche liefert die Sonne im Mittel:\nwatt_per_sqm <- 1340\n# Wie groß ist die Oberfläche der Erde:\nsurface_earth_sqm <- 5.1e14\n# Wie viel Sonnenenergie erreicht die Erde pro Jahr:\nenergy_sun_per_year_joule <- watt_per_sqm * surface_earth_sqm * 60 * 60 * 24 * 365.25\n(energy_per_year_kwh <- energy_sun_per_year_joule / 3.6e6)\n\n[1] 5.990684e+18"
  },
  {
    "objectID": "posts/2023-01-10-sustainibility-data/index.html#weltenergiebedarf",
    "href": "posts/2023-01-10-sustainibility-data/index.html#weltenergiebedarf",
    "title": "Sustainibility data",
    "section": "Weltenergiebedarf",
    "text": "Weltenergiebedarf\n\nWikipedia: Weltenergiebedarf 574 Exajoule = 5.74e20\n\n\n# Weltenergiebedarf:\nworld_energy_consumption_joule <- 5.74e20\n(world_energy_consumption_kwh <- world_energy_consumption_joule / 3.6e6)\n\n[1] 1.594444e+14\n\n# Wie viel mal so viel Energie liefert die Sonne:\nfac <- energy_sun_per_year_joule / world_energy_consumption_joule\n\nDie Welt liefert also ca. 3.76e+04 mal so viel Energie wie von den Menschen verbraucht wird. Bei einem Wirkungsgrad von\n\n# angenommene Effizienz von Photovoltaikanlagen:\nassumed_efficiency <- 0.1\n# Welcher Anteil der Erde müsste mit 'mittleren' PV-Anlagen bedeckt sein, um den Weltenergiebedarf mit PV-Anlagen abdecken zu können:\nfraction_earth <- 1 / (assumed_efficiency * fac)\n# Weltbevölkerung:\npopulation_earth <- 8e9\n# Wie viel \n(pv_per_person <- surface_earth_sqm * fraction_earth / population_earth)\n\n[1] 16.96732"
  },
  {
    "objectID": "posts/2023-01-10-sustainibility-data/index.html#deutschland",
    "href": "posts/2023-01-10-sustainibility-data/index.html#deutschland",
    "title": "Sustainibility data",
    "section": "Deutschland",
    "text": "Deutschland\n\nWikipedia: Weltenergiebedarf 574 Exajoule = 5.74e20\n\n\n(energy_consumption_germany_joule <- 3.3 * 1e3 * 1e9 * 3.6e6)\n\n[1] 1.188e+19\n\nsurface_germany_sqm <- 3e5 * 1e6\nenergy_sun_germany_year_joule <- watt_per_sqm * surface_germany_sqm * 60 * 60 * 24 * 365.24\n# Anteil der Fläche in Deutschland, der mit PV-Anlagen ausgestatted sein müsste:\nenergy_consumption_germany_joule / (energy_sun_germany_year_joule * assumed_efficiency)\n\n[1] 0.009364796"
  },
  {
    "objectID": "posts/2022-09-08-psychopharmaca-and-time/index.html",
    "href": "posts/2022-09-08-psychopharmaca-and-time/index.html",
    "title": "Psychopharmaca and time",
    "section": "",
    "text": "library('lattice')\nlibrary('readxl')\n\ndat <- read_excel('Psychopharmaka_Data.xlsx')\n\n\ndat <- dat[order(dat$Jahr), ]\n\n\nstripplot(order(dat$Jahr) ~ Jahr, data = dat, \n          panel = \n            function(x, y, subscripts, ...) {\n              panel.grid(h = -1, v = -1)\n              lsegments(x0 = x, y0 = y - 0.2, \n                        x1 = x, y1 = y - 0.6,\n                        lwd = 3)\n              ltext(x = x, y = y, \n                    labels = dat$Substanz[subscripts])\n              }, \n          xlim = c(1945, 2015), \n          ylab = '')"
  },
  {
    "objectID": "posts/2022-10-25-simulate-time-to-event-data/index.html",
    "href": "posts/2022-10-25-simulate-time-to-event-data/index.html",
    "title": "Simulate time to-event-data",
    "section": "",
    "text": "In this post, two methods to draw from a survival time distribution defined by an arbitrary hazard function are demonstrated. First, some central equations of survival analysis are given in order to refresh the background and establish a consistent notation. Then, the two different approaches are demonstrated."
  },
  {
    "objectID": "posts/2022-10-25-simulate-time-to-event-data/index.html#mathematical-aspects",
    "href": "posts/2022-10-25-simulate-time-to-event-data/index.html#mathematical-aspects",
    "title": "Simulate time to-event-data",
    "section": "Mathematical aspects",
    "text": "Mathematical aspects\n\nTaken from wikipedia - at this wikipedia page also further explanation can be found\nSurvival function \\(S\\) \\[ S(t) = Pr(T > t) \\]\nHazard function \\(\\lambda\\) \\[ \\lambda(t) = - S'(t) / S(t) \\]\nCumulative hazard function \\(\\Lambda\\) \\[ \\Lambda(t)  = \\int_0^t{\\lambda(u) du} \\]\nRelation between \\(\\Lambda\\) and \\(S\\) \\[ S(t) = exp(-\\Lambda(t)) \\]"
  },
  {
    "objectID": "posts/2022-10-25-simulate-time-to-event-data/index.html#ad-hoc-code-to-draw-from-survival-time-distribution",
    "href": "posts/2022-10-25-simulate-time-to-event-data/index.html#ad-hoc-code-to-draw-from-survival-time-distribution",
    "title": "Simulate time to-event-data",
    "section": "Ad hoc code to draw from survival time distribution",
    "text": "Ad hoc code to draw from survival time distribution\n\nset.seed(1)\nlibrary('survival')\n\n# define hazard function:\nlambda <- Vectorize(\n  function(t) {\n    abs(sin(t))\n  })\n\n# hazard for t = 7:\nlambda(7) \n\n[1] 0.6569866\n\nplot(lambda, from = 0, to = 10, xlab = 't', ylab = expression(lambda))\n\n\n\n# define function that computes cumulative hazard function:\nLambda <- Vectorize(\n  function(t) {\n    integrate(lambda,\n              subdivisions = 1e3L,\n              lower = 0, \n              upper = t)$value\n  })\n\n# cumulative hazard for t = 3\nLambda(3) \n\n[1] 1.989992\n\nplot(Lambda, from = 0, to = 10, xlab = 't', ylab = expression(Lambda))\n\n\n\n# define function that computes survival function \n# from cumulative hazard function:\nS <- Vectorize(\n  function(t) {\n    exp(-Lambda(t))\n  })\n\nplot(S, from = 0, to = 10, xlab = 't')\n\n\n\n# determine at which time cumulative hazard\n# reaches 2e1 (i. e. S(t) < 1e-8)\n# the value is used as upper bound for\n# optimization to find the quantile\nupper_bound <- optimize(\n  function(x) {\n    abs(Lambda(x) - 2e1)\n  }, \n  interval = c(0, 1e2))$minimum\n\n# define function to compute quantile of survival function\nquantile_function <- Vectorize(\n  function(t) {\n    optimize(function(x) {\n      abs(S(x) - t)}, \n      interval = c(0, upper_bound))$min\n  })\n\n# compute some quantiles for hazard function\n# that has been specified above:\nquantile_function(c(0.25, 0.5, 0.75))\n\n[1] 1.9674130 1.2589101 0.7779829\n\n# evaluate how long it takes to determine 10 quantiles:\nmicrobenchmark::microbenchmark(quantile_function(1:10))\n\nWarning in microbenchmark::microbenchmark(quantile_function(1:10)): less\naccurate nanosecond times to avoid potential integer overflows\n\n\nUnit: milliseconds\n                    expr      min       lq     mean   median       uq      max\n quantile_function(1:10) 41.01287 43.24196 44.44459 43.84224 44.25761 100.2128\n neval\n   100\n\n# draw n random numbers from survival distribution \n# defined by hazard function above\n(times <- quantile_function(runif(n = 20)))\n\n [1] 0.9040743 1.0566904 2.0173300 1.9328205 0.8170795 1.3620799 2.4072092\n [8] 0.7842570 3.8702329 0.5462974 1.0317729 1.1427625 1.6834271 1.3608340\n[15] 1.2579906 2.3602768 1.1977742 4.2861974 1.8556640 2.1505993\n\nplot(survfit(Surv(times) ~ 1), xlab = 't', ylab = 'S')"
  },
  {
    "objectID": "posts/2022-10-25-simulate-time-to-event-data/index.html#more-sophisticated-solution-using-the-coxed-package",
    "href": "posts/2022-10-25-simulate-time-to-event-data/index.html#more-sophisticated-solution-using-the-coxed-package",
    "title": "Simulate time to-event-data",
    "section": "More sophisticated solution using the coxed package",
    "text": "More sophisticated solution using the coxed package\n\nSolution found here:\n\n\nlibrary('coxed')\n\nmy.hazard <- function(t){ \n  abs(sin(t)) * 0.01\n}\n\nsimdata <- sim.survdata(N = 100, \n                        T = 1000, \n                        hazard.fun = my.hazard)\n\nWarning in FUN(X[[i]], ...): 0 additional observations right-censored because the user-supplied hazard function\n                                  is nonzero at the latest timepoint. To avoid these extra censored observations, increase T\n\nplot(survfit(Surv(simdata$data$y) ~ 1), xlab = 't', ylab = 'S')"
  },
  {
    "objectID": "posts/2022-10-25-simulate-time-to-event-data/index.html#conclusion",
    "href": "posts/2022-10-25-simulate-time-to-event-data/index.html#conclusion",
    "title": "Simulate time to-event-data",
    "section": "Conclusion",
    "text": "Conclusion\nIt is possible to draw survival times defined by an arbitrary hazard function with just a few lines of code. However, the code is not very time-efficient and there might be issues with numerical stability in certain constellations - hence, plausibility of the results needs to be checked manually.\nThe coxed package provides convenient, more sophisticated methods to achieve a similar goal. However, the coxed approach might be more difficult to adapt to specific situations since the code base is more rigid."
  },
  {
    "objectID": "posts/2022-12-20-flowcharts/index.html",
    "href": "posts/2022-12-20-flowcharts/index.html",
    "title": "Flowcharts",
    "section": "",
    "text": "Source: https://cran.r-project.org/web/packages/Gmisc/vignettes/Grid-based_flowcharts.html\n\nlibrary(Gmisc, quietly = TRUE)\nlibrary(glue)\nlibrary(htmlTable)\nlibrary(grid)\nlibrary(magrittr)\n\norg_cohort <- boxGrob(glue(\"Stockholm population\",\n                           \"n = {pop}\",\n                           pop = txtInt(1632798),\n                           .sep = \"\\n\"))\neligible <- boxGrob(glue(\"Eligible\",\n                          \"n = {pop}\",\n                           pop = txtInt(10032),\n                           .sep = \"\\n\"))\nincluded <- boxGrob(glue(\"Randomized\",\n                         \"n = {incl}\",\n                         incl = txtInt(122),\n                         .sep = \"\\n\"))\ngrp_a <- boxGrob(glue(\"Treatment A\",\n                      \"n = {recr}\",\n                      recr = txtInt(43),\n                      .sep = \"\\n\"))\n\ngrp_b <- boxGrob(glue(\"Treatment B\",\n                      \"n = {recr}\",\n                      recr = txtInt(122 - 43 - 30),\n                      .sep = \"\\n\"))\n\nexcluded <- boxGrob(glue(\"Excluded (n = {tot}):\",\n                         \" - not interested: {uninterested}\",\n                         \" - contra-indicated: {contra}\",\n                         tot = 30,\n                         uninterested = 12,\n                         contra = 30 - 12,\n                         .sep = \"\\n\"),\n                    just = \"left\")\n\ngrid.newpage()\nvert <- spreadVertical(org_cohort,\n                       eligible = eligible,\n                       included = included,\n                       grps = grp_a)\ngrps <- alignVertical(reference = vert$grps,\n                      grp_a, grp_b) %>%\n  spreadHorizontal()\nvert$grps <- NULL\n\nexcluded <- moveBox(excluded,\n                    x = .8,\n                    y = coords(vert$included)$top + distance(vert$eligible, vert$included, half = TRUE, center = FALSE))\n\nfor (i in 1:(length(vert) - 1)) {\n  connectGrob(vert[[i]], vert[[i + 1]], type = \"vert\") %>%\n    print\n}\nconnectGrob(vert$included, grps[[1]], type = \"N\")\nconnectGrob(vert$included, grps[[2]], type = \"N\")\n\nconnectGrob(vert$eligible, excluded, type = \"L\")\n\n# Print boxes\nvert\ngrps\nexcluded"
  },
  {
    "objectID": "posts/2022-09-08-chess-ressources/index.html",
    "href": "posts/2022-09-08-chess-ressources/index.html",
    "title": "Chess ressources",
    "section": "",
    "text": "https://search.r-project.org/?P=chess&SORT=&HITSPERPAGE=10&DB=cran-info&DEFAULTOP=and&%5B=1&TOPDOC=10&FMT=query&xP=ZBchess%09ZFchess%09ZSchess%09Zchess&xDB=cran-info&xFILTERS=.%7E%7E4294967295"
  },
  {
    "objectID": "posts/2022-09-08-chess-ressources/index.html#nice-little-chess-engine",
    "href": "posts/2022-09-08-chess-ressources/index.html#nice-little-chess-engine",
    "title": "Chess ressources",
    "section": "nice little chess engine:",
    "text": "nice little chess engine:\nhttps://www.codertime.org/minimax-chess-engine-programming-r/"
  },
  {
    "objectID": "posts/2022-09-08-chess-ressources/index.html#interesting-people",
    "href": "posts/2022-09-08-chess-ressources/index.html#interesting-people",
    "title": "Chess ressources",
    "section": "Interesting people:",
    "text": "Interesting people:\n\nhttps://www.chessprogramming.org/Guy_Haworth\nhttps://www.chessprogramming.org/Kenneth_W._Regan"
  },
  {
    "objectID": "posts/2022-09-08-chess-ressources/index.html#interesting-publications",
    "href": "posts/2022-09-08-chess-ressources/index.html#interesting-publications",
    "title": "Chess ressources",
    "section": "interesting publications:",
    "text": "interesting publications:\n\nhttps://cse.buffalo.edu/~regan/papers/pdf/BHR2015ACG.pdf"
  },
  {
    "objectID": "posts/2022-10-19-model-meadow/index.html#generalized-linear-model",
    "href": "posts/2022-10-19-model-meadow/index.html#generalized-linear-model",
    "title": "Model meadow",
    "section": "Generalized linear model",
    "text": "Generalized linear model\n\nBinary data\n\n\nCount data"
  },
  {
    "objectID": "posts/2022-10-19-model-meadow/index.html#mixed-effect-models",
    "href": "posts/2022-10-19-model-meadow/index.html#mixed-effect-models",
    "title": "Model meadow",
    "section": "Mixed effect models",
    "text": "Mixed effect models"
  },
  {
    "objectID": "posts/2022-10-19-model-meadow/index.html#models-for-survival-data",
    "href": "posts/2022-10-19-model-meadow/index.html#models-for-survival-data",
    "title": "Model meadow",
    "section": "Models for survival data",
    "text": "Models for survival data\n\nKaplan-Meier\n\n\n\n\n\nCox-PH\n\n\nCompeting risks\n\n\nMultistate models\n\nlibrary(survival)\nlibrary(mstate)\ntmat <- transMat(list(c(2,3,4), c(3,4), c(4), c()), c('tox', 'twist', 'rel', 'death'))\n\ndata <- data.frame(id = c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5),\n                   from = c(1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1), \n                   to = c(2, 3, 4, 3, 4, 2, 3, 4, 3, 4, 4, 4, 2, 3, 4, 2, 3, 4, 2, 3, 4),\n                   start_time = c(0, 0, 0, 5, 5, 0, 0, 0, 4, 4, 8, 9, 0, 0, 0, 0 , 0 , 0, 0, 0, 0),\n                   stop_time = c(5, 5, 5, 8, 8, 4, 4, 4, 9, 9, 12, 13, 2, 2, 2, 3, 3, 3, 7, 7, 7),\n                   status = c(1, 0, 0, 0, 1, 1, 0 , 0 , 0, 1, 0, 0, 0 , 0, 1, 0 , 1, 0, 0 , 0 , 0), \n                   group = c('a', 'a', 'a', 'a', 'a', 'b', 'b', 'b', 'b', 'b', 'a', 'b', 'a', 'a', 'a', 'b', 'b', 'b', 'b', 'b', 'b'))\ndata$trans <- data$to - 1\n\nfm <- coxph(Surv(time = start_time, time2 = stop_time, event = status) ~ strata(trans), data = data)\n\nfm_msfit <- msfit(object = fm, trans = tmat)\nplot(fm_msfit)\n\n\n\np_model <- probtrans(fm_msfit, predt = 0)\np_model\n\n[[1]]\n  time pstate1 pstate2 pstate3 pstate4        se1       se2       se3       se4\n1    0    1.00     0.0     0.0    0.00 0.00000000 0.0000000 0.0000000 0.0000000\n2    2    0.80     0.0     0.0    0.20 0.16000000 0.0000000 0.0000000 0.1600000\n3    3    0.60     0.0     0.2    0.20 0.19209373 0.0000000 0.1552417 0.1600000\n4    4    0.40     0.2     0.2    0.20 0.18487233 0.1479114 0.1552417 0.1600000\n5    5    0.20     0.4     0.2    0.20 0.13617799 0.1756259 0.1552417 0.1600000\n6    8    0.10     0.4     0.2    0.30 0.08447551 0.1756259 0.1552417 0.1622840\n7    9    0.05     0.4     0.2    0.35 0.04908185 0.1756259 0.1552417 0.1663768\n8   13    0.05     0.4     0.2    0.35 0.04908185 0.1756259 0.1552417 0.1663768\n\n[[2]]\n  time pstate1 pstate2 pstate3 pstate4 se1 se2 se3 se4\n1    0       0       1       0       0   0   0   0   0\n2    2       0       1       0       0   0   0   0   0\n3    3       0       1       0       0   0   0   0   0\n4    4       0       1       0       0   0   0   0   0\n5    5       0       1       0       0   0   0   0   0\n6    8       0       1       0       0   0   0   0   0\n7    9       0       1       0       0   0   0   0   0\n8   13       0       1       0       0   0   0   0   0\n\n[[3]]\n  time pstate1 pstate2 pstate3 pstate4 se1 se2 se3 se4\n1    0       0       0       1       0   0   0   0   0\n2    2       0       0       1       0   0   0   0   0\n3    3       0       0       1       0   0   0   0   0\n4    4       0       0       1       0   0   0   0   0\n5    5       0       0       1       0   0   0   0   0\n6    8       0       0       1       0   0   0   0   0\n7    9       0       0       1       0   0   0   0   0\n8   13       0       0       1       0   0   0   0   0\n\n[[4]]\n  time pstate1 pstate2 pstate3 pstate4 se1 se2 se3 se4\n1    0       0       0       0       1   0   0   0   0\n2    2       0       0       0       1   0   0   0   0\n3    3       0       0       0       1   0   0   0   0\n4    4       0       0       0       1   0   0   0   0\n5    5       0       0       0       1   0   0   0   0\n6    8       0       0       0       1   0   0   0   0\n7    9       0       0       0       1   0   0   0   0\n8   13       0       0       0       1   0   0   0   0\n\n$trans\n       to\nfrom    tox twist rel death\n  tox    NA     1   2     3\n  twist  NA    NA   4     5\n  rel    NA    NA  NA     6\n  death  NA    NA  NA    NA\n\n$method\n[1] \"aalen\"\n\n$predt\n[1] 0\n\n$direction\n[1] \"forward\"\n\nattr(,\"class\")\n[1] \"probtrans\"\n\nplot(p_model, use.ggplot = TRUE)\n\n\n\nplot(p_model, use.ggplot = TRUE, type = 'separate', conf.int = 0.95,conf.type = 'log')"
  },
  {
    "objectID": "posts/2022-10-19-model-meadow/index.html#machine-learning-models",
    "href": "posts/2022-10-19-model-meadow/index.html#machine-learning-models",
    "title": "Model meadow",
    "section": "Machine learning models",
    "text": "Machine learning models\n\nNeural nets"
  },
  {
    "objectID": "posts/2022-09-08-humidity/index.html",
    "href": "posts/2022-09-08-humidity/index.html",
    "title": "Humidity",
    "section": "",
    "text": "# devtools::install_github('sebastian-gerdes/smisc')\nlibrary('smisc')\nlibrary('knitr')\nlibrary('tibble') \nlibrary('lattice')\nConclusion: Airing once with an indoor temperature of 20 degress Celsius with a relative humidity of 50% and an outdoor temperature of 0 degrees Celsius with a relative outdoor humidity of 70% transports approx. 1.9 liters of water out of the flat, assuming a volume of 360 \\(m^3\\) of the flat."
  },
  {
    "objectID": "posts/2022-09-08-humidity/index.html#absolute-humidity-in-1-m3-at-a-relative-humiditiy-of-100",
    "href": "posts/2022-09-08-humidity/index.html#absolute-humidity-in-1-m3-at-a-relative-humiditiy-of-100",
    "title": "Humidity",
    "section": "Absolute humidity in 1 \\(m^3\\) at a relative humiditiy of 100%",
    "text": "Absolute humidity in 1 \\(m^3\\) at a relative humiditiy of 100%\n\n# scenario 1:\ntemperatures <- seq(from = -10, to = 35, by = 5)\nrelative_humidities <- seq(from = 0, to = 100, by = 10)\nresult <- matrix(nrow = length(temperatures), \n                 ncol = length(relative_humidities), \n                 dimnames = list(temperatures, relative_humidities))\nfor (i in 1:length(temperatures)) {\n  for (j in 1:length(relative_humidities)){\n    result[i, j] <- absolute_humidity(temperature = temperatures[i], \n                                      relative_humidity = relative_humidities[j])\n  }\n}\n\nkable(round(result, digits = 2)) \n\n\n\n\n\n0\n10\n20\n30\n40\n50\n60\n70\n80\n90\n100\n\n\n\n\n-10\n0\n0\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\n-5\n0\n0\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\n0\n0\n0\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\n5\n0\n0\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.01\n0.01\n0.01\n\n\n10\n0\n0\n0.00\n0.00\n0.00\n0.00\n0.01\n0.01\n0.01\n0.01\n0.01\n\n\n15\n0\n0\n0.00\n0.00\n0.01\n0.01\n0.01\n0.01\n0.01\n0.01\n0.01\n\n\n20\n0\n0\n0.00\n0.01\n0.01\n0.01\n0.01\n0.01\n0.01\n0.02\n0.02\n\n\n25\n0\n0\n0.00\n0.01\n0.01\n0.01\n0.01\n0.02\n0.02\n0.02\n0.02\n\n\n30\n0\n0\n0.01\n0.01\n0.01\n0.02\n0.02\n0.02\n0.02\n0.03\n0.03\n\n\n35\n0\n0\n0.01\n0.01\n0.02\n0.02\n0.02\n0.03\n0.03\n0.04\n0.04\n\n\n\n\n# scenario 2:\ntemperatures <- -10:30\nabs_humidity <- round(absolute_humidity(temperature = temperatures), digits = 3)\nkable(tibble(temperatures = temperatures, abs_humidity = abs_humidity))\n\n\n\n\ntemperatures\nabs_humidity\n\n\n\n\n-10\n0.002\n\n\n-9\n0.003\n\n\n-8\n0.003\n\n\n-7\n0.003\n\n\n-6\n0.003\n\n\n-5\n0.003\n\n\n-4\n0.004\n\n\n-3\n0.004\n\n\n-2\n0.004\n\n\n-1\n0.005\n\n\n0\n0.005\n\n\n1\n0.005\n\n\n2\n0.006\n\n\n3\n0.006\n\n\n4\n0.006\n\n\n5\n0.007\n\n\n6\n0.007\n\n\n7\n0.008\n\n\n8\n0.008\n\n\n9\n0.009\n\n\n10\n0.009\n\n\n11\n0.010\n\n\n12\n0.011\n\n\n13\n0.011\n\n\n14\n0.012\n\n\n15\n0.013\n\n\n16\n0.014\n\n\n17\n0.014\n\n\n18\n0.015\n\n\n19\n0.016\n\n\n20\n0.017\n\n\n21\n0.018\n\n\n22\n0.019\n\n\n23\n0.021\n\n\n24\n0.022\n\n\n25\n0.023\n\n\n26\n0.024\n\n\n27\n0.026\n\n\n28\n0.027\n\n\n29\n0.029\n\n\n30\n0.030"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Blog posts",
    "section": "",
    "text": "Strange behavior in ggplot2\n\n\n\n\n\n\n\n\n\n\n\n\nFeb 2, 2023\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nSIRS model dynamics\n\n\n\n\n\n\n\n\n\n\n\n\nJan 19, 2023\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nSustainibility data\n\n\n\n\n\n\n\n\n\n\n\n\nJan 10, 2023\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nContribution plots\n\n\n\n\n\n\n\n\n\n\n\n\nJan 5, 2023\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nFlowcharts\n\n\n\n\n\n\n\n\n\n\n\n\nDec 20, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nR interfaces to trial registries\n\n\n\n\n\n\n\n\n\n\n\n\nOct 25, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nSimulate time to-event-data\n\n\n\n\n\n\n\n\n\n\n\n\nOct 25, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nKids per person and carbon footprint\n\n\n\n\n\n\n\n\n\n\n\n\nOct 19, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nModel meadow\n\n\n\n\n\n\n\n\n\n\n\n\nOct 19, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nRetrieving and plotting COVID-19 data\n\n\n\n\n\n\n\n\n\n\n\n\nOct 16, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nLeo’s project\n\n\n\n\n\n\n\n\n\n\n\n\nOct 16, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nSIR-like model with deSolve in deterministic and stochastic version\n\n\n\n\n\n\n\n\n\n\n\n\nOct 4, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nAntipsychotics\n\n\n\n\n\n\n\n\n\n\n\n\nSep 8, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nTimeline\n\n\n\n\n\n\n\n\n\n\n\n\nSep 8, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nPsychopharmaca and time\n\n\n\n\n\n\n\n\n\n\n\n\nSep 8, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nChess ressources\n\n\n\n\n\n\n\n\n\n\n\n\nSep 8, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nHumidity\n\n\n\n\n\n\n\n\n\n\n\n\nSep 8, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\n\n\nSIR model\n\n\n\n\n\n\n\n\n\n\n\n\nJul 19, 2022\n\n\nSebastian Gerdes\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "My name is Sebastian Gerdes (email: first name dot last name at posteo dot de) and this is my personal blog. I intend to publish some posts about statistics and maybe other topics as well on this site."
  },
  {
    "objectID": "posts/2022-02-02-strange-behavior-of-geom_area/Untitled.html",
    "href": "posts/2022-02-02-strange-behavior-of-geom_area/Untitled.html",
    "title": "Strange behavior in ggplot2",
    "section": "",
    "text": "library('tidyr')\nlibrary('tibble')\nlibrary('ggplot2')\nlibrary('dplyr')\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ngrid_values <- 2^(-3:3)\n\nstrange_values <- c(-1.90819287770871e-06, -1.68820727726686e-20, 1.90820561104585e-06, \n                    -2.03934646947346e-11, -2.66724989539021e-44, 1.82186185543446e-11, \n                    -3.08642000845794e-14, -2.84079624478981e-68, 3.8017746773927e-20, \n                    -1.55431223447522e-14, -2.12106623568441e-87, -7.04031177308046e-34, \n                    1.99840144432528e-15, 6.92960775272386e-94, -2.17911262386235e-50, \n                    6.43929354282591e-15, 1.60655203590779e-101, -2.4149683145618e-74, \n                    4.2188474935756e-15, -1.63364987668272e-101, -8.43744249369279e-100, \n                    -1.9234795292089e-06, -1.40915667489693e-20, 1.92348291032148e-06, \n                    -7.86031240096463e-11, 5.94869638827445e-40, 1.70218514362265e-11, \n                    -6.21724893790088e-15, -5.32110095875999e-63, 3.9895815730536e-20, \n                    2.39808173319034e-14, -9.91626723546227e-86, -2.47375723122866e-33, \n                    -1.77635683940025e-15, 8.7576689576463e-93, -2.1712899716615e-50, \n                    9.54791801177635e-15, 2.7961387551394e-101, -2.62250706570328e-74, \n                    -6.43929354282591e-15, -5.36337882495689e-101, -1.65540646490924e-99, \n                    -1.95935441282824e-06, -4.13414429145914e-22, 1.9595249500527e-06, \n                    -1.99651406518342e-11, 4.01993294485079e-37, 1.71444629227149e-11, \n                    2.31215047108435e-12, -5.46064224913782e-66, 6.44847728373308e-20, \n                    5.40456568387526e-13, 5.30352631285166e-83, 3.81832474229875e-33, \n                    -1.80966353013901e-14, -9.72418279929888e-94, -2.08007912888974e-51, \n                    -1.33226762955019e-14, 3.23934484578975e-100, -2.61033780134937e-74, \n                    6.88338275267597e-15, -1.29762567303952e-99, -2.07383582042798e-98, \n                    -2.01803061317118e-06, 3.3691909504469e-20, 2.01799435665222e-06, \n                    -1.83731918568242e-11, 7.21526941571507e-42, 1.72812031885596e-11, \n                    1.40298883621881e-11, 2.61529894687986e-38, 2.597261897857e-20, \n                    3.95239396766556e-14, -1.83777217239233e-53, 1.74710015191643e-33, \n                    -2.1316282072803e-14, 3.26611237858842e-68, -1.19804995812909e-51, \n                    -1.58761892521397e-14, 6.58410560104933e-90, -2.50682775406401e-74, \n                    2.46469511466785e-14, -1.08556164510476e-96, -8.68448004693709e-96, \n                    -2.14979959756167e-06, 4.65632478870001e-17, 2.14994451996064e-06, \n                    -2.15127915481617e-11, -5.03897310277035e-29, 2.37451670641299e-11, \n                    -7.30294713591206e-11, -6.74709311307118e-38, 4.03149402823541e-20, \n                    8.21565038222616e-14, 4.6575341905728e-50, -1.71156811032874e-33, \n                    -1.32116539930394e-14, 9.41355218246985e-67, -5.35957793195957e-51, \n                    7.99360577730113e-15, 8.43929875779189e-89, -2.9418326640071e-74, \n                    1.48769885299771e-14, -2.81028796325013e-90, -1.12411483527064e-89, \n                    -2.42728809329851e-06, -8.05503632048299e-18, 2.42718074969143e-06, \n                    5.7643223527748e-11, -5.67417009881705e-30, 2.18227445666839e-11, \n                    4.88498130835069e-15, 5.74369923731793e-37, 5.93253926283155e-20, \n                    -5.36681810103801e-13, 7.68115012003888e-48, 2.12048592220925e-31, \n                    1.43107747874183e-12, -5.9458568180203e-64, 3.32402936140172e-48, \n                    -8.88178419700125e-16, -1.75086766216852e-75, -3.32876019974183e-73, \n                    6.43929354282591e-15, -1.00992378651113e-74, -2.01984753722959e-74, \n                    -2.90572647954068e-06, -7.77642264438329e-10, 2.90649964611508e-06, \n                    9.09130548620851e-11, -3.52178085798882e-12, -8.73905452509179e-11, \n                    -1.03369389016228e-05, 6.07960561736676e-07, 9.72897833978829e-06, \n                    -0.00081769791399311, 9.032308610189e-05, 0.000727374827890998, \n                    -0.0011992740379827, 0.000238928931343064, 0.000960345106639307, \n                    -0.00123663646030969, 0.000411530217922524, 0.000825106242386583, \n                    -0.00124466009860591, 0.000621942028670438, 0.000622718069935415\n)\nmy_tib <- expand_grid(beta = grid_values, lambda = grid_values, name = c('S', 'I', 'R'))\nmy_tib$value <- 0\nmy_tib$value[my_tib$name == 'I'] <- 1\nmy_tib$value_strange <- my_tib$value + strange_values\n\n\n# expected behavior:\nmy_tib %>%\n  ggplot(aes(x = beta, y = value, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')\n\n\n\n# strange behavior when adding these really small, strange (?) numbers:\nmy_tib %>%\n  ggplot(aes(x = beta, y = value_strange, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')\n\n\n\n# expected behavior when x axis is not on log-scale\nmy_tib %>%\n  ggplot(aes(x = beta, y = value_strange, fill = name)) + geom_area() + facet_grid(cols = vars(lambda))\n\n\n\n# expected behavior when only the 1's are plotted and the 0's are omitted\nmy_tib %>% filter(name == 'I') %>%\n  ggplot(aes(x = beta, y = value_strange, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')\n\n\n\n# can't reproduce strange behavior with random numbers - what makes the other numbers so strange that `geom_area` produces weird results?\nset.seed(1)\nmy_tib$value_strange_2 <- my_tib$value + runif(nrow(my_tib), -1e-10, 1e-10)\nmy_tib %>%\n  ggplot(aes(x = beta, y = value_strange_2, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')"
  },
  {
    "objectID": "posts/2022-02-02-strange-behavior-of-geom_area/index.html",
    "href": "posts/2022-02-02-strange-behavior-of-geom_area/index.html",
    "title": "Strange behavior in ggplot2",
    "section": "",
    "text": "library('tidyr')\nlibrary('tibble')\nlibrary('ggplot2')\nlibrary('dplyr')\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ngrid_values <- 2^(-3:3)\n\nstrange_values <- c(-1.90819287770871e-06, -1.68820727726686e-20, 1.90820561104585e-06, \n                    -2.03934646947346e-11, -2.66724989539021e-44, 1.82186185543446e-11, \n                    -3.08642000845794e-14, -2.84079624478981e-68, 3.8017746773927e-20, \n                    -1.55431223447522e-14, -2.12106623568441e-87, -7.04031177308046e-34, \n                    1.99840144432528e-15, 6.92960775272386e-94, -2.17911262386235e-50, \n                    6.43929354282591e-15, 1.60655203590779e-101, -2.4149683145618e-74, \n                    4.2188474935756e-15, -1.63364987668272e-101, -8.43744249369279e-100, \n                    -1.9234795292089e-06, -1.40915667489693e-20, 1.92348291032148e-06, \n                    -7.86031240096463e-11, 5.94869638827445e-40, 1.70218514362265e-11, \n                    -6.21724893790088e-15, -5.32110095875999e-63, 3.9895815730536e-20, \n                    2.39808173319034e-14, -9.91626723546227e-86, -2.47375723122866e-33, \n                    -1.77635683940025e-15, 8.7576689576463e-93, -2.1712899716615e-50, \n                    9.54791801177635e-15, 2.7961387551394e-101, -2.62250706570328e-74, \n                    -6.43929354282591e-15, -5.36337882495689e-101, -1.65540646490924e-99, \n                    -1.95935441282824e-06, -4.13414429145914e-22, 1.9595249500527e-06, \n                    -1.99651406518342e-11, 4.01993294485079e-37, 1.71444629227149e-11, \n                    2.31215047108435e-12, -5.46064224913782e-66, 6.44847728373308e-20, \n                    5.40456568387526e-13, 5.30352631285166e-83, 3.81832474229875e-33, \n                    -1.80966353013901e-14, -9.72418279929888e-94, -2.08007912888974e-51, \n                    -1.33226762955019e-14, 3.23934484578975e-100, -2.61033780134937e-74, \n                    6.88338275267597e-15, -1.29762567303952e-99, -2.07383582042798e-98, \n                    -2.01803061317118e-06, 3.3691909504469e-20, 2.01799435665222e-06, \n                    -1.83731918568242e-11, 7.21526941571507e-42, 1.72812031885596e-11, \n                    1.40298883621881e-11, 2.61529894687986e-38, 2.597261897857e-20, \n                    3.95239396766556e-14, -1.83777217239233e-53, 1.74710015191643e-33, \n                    -2.1316282072803e-14, 3.26611237858842e-68, -1.19804995812909e-51, \n                    -1.58761892521397e-14, 6.58410560104933e-90, -2.50682775406401e-74, \n                    2.46469511466785e-14, -1.08556164510476e-96, -8.68448004693709e-96, \n                    -2.14979959756167e-06, 4.65632478870001e-17, 2.14994451996064e-06, \n                    -2.15127915481617e-11, -5.03897310277035e-29, 2.37451670641299e-11, \n                    -7.30294713591206e-11, -6.74709311307118e-38, 4.03149402823541e-20, \n                    8.21565038222616e-14, 4.6575341905728e-50, -1.71156811032874e-33, \n                    -1.32116539930394e-14, 9.41355218246985e-67, -5.35957793195957e-51, \n                    7.99360577730113e-15, 8.43929875779189e-89, -2.9418326640071e-74, \n                    1.48769885299771e-14, -2.81028796325013e-90, -1.12411483527064e-89, \n                    -2.42728809329851e-06, -8.05503632048299e-18, 2.42718074969143e-06, \n                    5.7643223527748e-11, -5.67417009881705e-30, 2.18227445666839e-11, \n                    4.88498130835069e-15, 5.74369923731793e-37, 5.93253926283155e-20, \n                    -5.36681810103801e-13, 7.68115012003888e-48, 2.12048592220925e-31, \n                    1.43107747874183e-12, -5.9458568180203e-64, 3.32402936140172e-48, \n                    -8.88178419700125e-16, -1.75086766216852e-75, -3.32876019974183e-73, \n                    6.43929354282591e-15, -1.00992378651113e-74, -2.01984753722959e-74, \n                    -2.90572647954068e-06, -7.77642264438329e-10, 2.90649964611508e-06, \n                    9.09130548620851e-11, -3.52178085798882e-12, -8.73905452509179e-11, \n                    -1.03369389016228e-05, 6.07960561736676e-07, 9.72897833978829e-06, \n                    -0.00081769791399311, 9.032308610189e-05, 0.000727374827890998, \n                    -0.0011992740379827, 0.000238928931343064, 0.000960345106639307, \n                    -0.00123663646030969, 0.000411530217922524, 0.000825106242386583, \n                    -0.00124466009860591, 0.000621942028670438, 0.000622718069935415\n)\nmy_tib <- expand_grid(beta = grid_values, lambda = grid_values, name = c('S', 'I', 'R'))\nmy_tib$value <- 0\nmy_tib$value[my_tib$name == 'I'] <- 1\nmy_tib$value_strange <- my_tib$value + strange_values\n\n\n# expected behavior:\nmy_tib %>%\n  ggplot(aes(x = beta, y = value, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')\n\n\n\n# strange behavior when adding these really small, strange (?) numbers:\nmy_tib %>%\n  ggplot(aes(x = beta, y = value_strange, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')\n\n\n\n# expected behavior when x axis is not on log-scale\nmy_tib %>%\n  ggplot(aes(x = beta, y = value_strange, fill = name)) + geom_area() + facet_grid(cols = vars(lambda))\n\n\n\n# expected behavior when only the 1's are plotted and the 0's are omitted\nmy_tib %>% filter(name == 'I') %>%\n  ggplot(aes(x = beta, y = value_strange, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')\n\n\n\n# can't reproduce strange behavior with random numbers - what makes the other numbers so strange that `geom_area` produces weird results?\nset.seed(1)\nmy_tib$value_strange_2 <- my_tib$value + runif(nrow(my_tib), -1e-10, 1e-10)\nmy_tib %>%\n  ggplot(aes(x = beta, y = value_strange_2, fill = name)) + geom_area() + facet_grid(cols = vars(lambda)) + scale_x_continuous(trans = 'log10')\n\n\n\nsessionInfo()\n\nR version 4.2.1 (2022-06-23)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Monterey 12.6.2\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] dplyr_1.0.10  ggplot2_3.4.0 tibble_3.1.8  tidyr_1.2.1  \n\nloaded via a namespace (and not attached):\n [1] pillar_1.8.1      compiler_4.2.1    tools_4.2.1       digest_0.6.31    \n [5] jsonlite_1.8.4    evaluate_0.19     lifecycle_1.0.3   gtable_0.3.1     \n [9] pkgconfig_2.0.3   rlang_1.0.6       cli_3.6.0         DBI_1.1.3        \n[13] rstudioapi_0.14   yaml_2.3.6        xfun_0.36         fastmap_1.1.0    \n[17] withr_2.5.0       stringr_1.5.0     knitr_1.41        generics_0.1.3   \n[21] vctrs_0.5.1       htmlwidgets_1.6.1 grid_4.2.1        tidyselect_1.2.0 \n[25] glue_1.6.2        R6_2.5.1          fansi_1.0.3       rmarkdown_2.19   \n[29] farver_2.1.1      purrr_1.0.1       magrittr_2.0.3    scales_1.2.1     \n[33] htmltools_0.5.4   assertthat_0.2.1  colorspace_2.0-3  labeling_0.4.2   \n[37] utf8_1.2.2        stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "posts/2023-01-20-sirs-model-dynamics/index.html#simulate-odes",
    "href": "posts/2023-01-20-sirs-model-dynamics/index.html#simulate-odes",
    "title": "SIRS model dynamics",
    "section": "Simulate ODEs",
    "text": "Simulate ODEs\n\nsir_ode_deterministic <- function(t, state, pars) {\n  with(as.list(c(state, pars)), {\n    dS <- - beta * I * S + lambda * R\n    dI <- beta * I * S - gamma * I\n    dR <- gamma * I - lambda * R\n    return(list(c(dS = dS, dI = dI, dR = dR)))\n  }) \n}\n\n\ninfected_initial <- 0.5\ninitial_condition <- \n  c(S = 1 - infected_initial,\n    I = infected_initial,\n    R = 0)\n\nstep_length <- 1\nmax_time <- 100\ntimepoints <- seq(0, max_time, by = step_length)\ngrid_values <- 2^(-1:1)\ngrid_values <- 2^(-2:2)\ngrid_values <- 2^(-3:3)\n\nresult <- tibble()\nfor(beta in grid_values) {\n  for(gamma in grid_values) {\n    for(lambda in grid_values) {\n      parameters <- list(beta = beta, \n                         gamma = gamma,\n                         lambda = lambda)\n      solution <- ode(y = initial_condition, \n                      times = timepoints,\n                      func = sir_ode_deterministic,\n                      parms = parameters) %>% \n        unclass %>% as_tibble\n      solution$beta <- beta\n      solution$gamma <- gamma\n      solution$lambda <- lambda\n      result <- rbind(result, solution)\n    }\n  }\n}\n\nresult <- pivot_longer(result, cols = c('S', 'I', 'R'))\n\nlast <- result[result$time == max_time, ]\nlast$name <- factor(last$name, levels = c('S', 'I', 'R'))\n\nlast %>%\n  ggplot(aes(beta, value, colour = name)) + geom_point() + geom_line() +\n  facet_grid(rows = vars(gamma), cols = vars(lambda), labeller = label_both) +\n  ylab('Fraction') + xlab('beta') + labs(colour = 'Compartment') +\n  scale_x_continuous(trans='log10')\n\n\n\nlast %>%\n  ggplot(aes(x = beta, y = value, fill = name)) + geom_area() +\n  facet_grid(rows = vars(gamma), cols = vars(lambda), labeller = label_both) +\n  ylab('Fraction') + xlab('beta') + labs(fill = 'Compartment') +\n  scale_x_continuous(trans='log10')\n\n\n\nss <- last %>% group_by(beta, gamma, lambda) %>% summarise(ss = sum(value))\n\n`summarise()` has grouped output by 'beta', 'gamma'. You can override using the\n`.groups` argument."
  },
  {
    "objectID": "posts/2023-01-20-sirs-model-dynamics/index.html#analytical-approach",
    "href": "posts/2023-01-20-sirs-model-dynamics/index.html#analytical-approach",
    "title": "SIRS model dynamics",
    "section": "Analytical approach",
    "text": "Analytical approach\nSolution in terms of parameters in red.\n\nEquilibrium conditions:\n\\[S + I + R = 1 \\qquad (1)\\] \\[0 = -\\beta I S + \\lambda R \\qquad (2)\\] \\[0 = \\beta I S - \\gamma I \\qquad (3)\\] \\[0 = \\gamma I - \\lambda R \\qquad (4)\\]\n\n\nAlgebraic transformation:\n\\[ R = 1 - S - I \\qquad (1b)\\] \\[ S = \\gamma / \\beta \\qquad (3b)\\]\n\n\nPlugging in:\n\\[ (3b) \\rightarrow (2): I = \\lambda / \\gamma R  \\qquad (5)\\] \\[ (1b) \\rightarrow (5): I = \\frac{\\lambda(\\beta - \\gamma)}{\\beta(\\gamma + \\lambda)} \\qquad (6)\\] \\[ (3b) + (6) \\rightarrow (1b): R = \\frac{\\gamma(\\beta - \\gamma)}{\\beta(\\gamma + \\lambda)} \\qquad (7)\\]\n\n\nPlots\n\nlast_w <- pivot_wider(last, names_from = name, values_from = value)\nlast_w$S_calc <- pmin(1, last_w$gamma / last_w$beta)\nlast_w$I_calc <- pmax(0, pmin(1, with(last_w, (lambda * (beta - gamma))) / (beta * (gamma + lambda))))\nlast_w$R_calc <- pmax(0, pmin(1, with(last_w, (gamma * (beta - gamma)) / (beta * (gamma + lambda)))))\nggplot(last_w, aes(S, S_calc)) + geom_point()\n\n\n\nggplot(last_w, aes(I, I_calc)) + geom_point()\n\n\n\nggplot(last_w, aes(R, R_calc)) + geom_point()\n\n\n\nlast_w$I_calc <- 1 - last_w$S_calc - last_w$R_calc\n\nlast <- pivot_longer(last_w, cols = c('S_calc', 'I_calc', 'R_calc'))\nglimpse(last)\n\nRows: 1,029\nColumns: 9\n$ time   <dbl> 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100…\n$ beta   <dbl> 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, …\n$ gamma  <dbl> 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, …\n$ lambda <dbl> 0.125, 0.125, 0.125, 0.250, 0.250, 0.250, 0.500, 0.500, 0.500, …\n$ S      <dbl> 0.9273226, 0.9273226, 0.9273226, 0.9279320, 0.9279320, 0.927932…\n$ I      <dbl> 3.481509e-02, 3.481509e-02, 3.481509e-02, 4.742894e-02, 4.74289…\n$ R      <dbl> 3.786233e-02, 3.786233e-02, 3.786233e-02, 2.463904e-02, 2.46390…\n$ name   <chr> \"S_calc\", \"I_calc\", \"R_calc\", \"S_calc\", \"I_calc\", \"R_calc\", \"S_…\n$ value  <dbl> 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, …\n\nlast %>%\n  ggplot(aes(x = beta, y = value, fill = name)) + geom_area() +\n  facet_grid(rows = vars(gamma), cols = vars(lambda), labeller = label_both) +\n  ylab('Fraction') + xlab('beta') + labs(colour = 'Compartment') +\n  scale_x_continuous(trans='log10')"
  }
]