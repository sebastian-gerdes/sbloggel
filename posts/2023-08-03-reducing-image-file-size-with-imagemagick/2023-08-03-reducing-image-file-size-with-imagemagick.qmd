---
title: Reducing image file size with ImageMagick
author: Sebastian Gerdes
date: 2023-08-03
categories:
  - R
toc: true
# draft: true
# execute: 
#   echo: false
#  cache: true
---


* [stackoverflow post](https://stackoverflow.com/questions/7261855/recommendation-for-compressing-jpg-files-with-imagemagick)

```{r}
#| label: init
#| cache: false
#| include: false
set.seed(1)
library('tidyverse')
library('magick')
help(package = 'magick')
koga_original <- image_read('koga_original.jpg')
koga_edited <- koga_original %>% image_resize("400x")
koga_edited |> image_write('koga_edited.jpg')
round(file.size('koga_edited.jpg') / 1024)

system('convert koga_original.jpg -quality 50 -resize 1024 -unsharp 0.25x0.25+8+0.065 -define jpeg:fancy-upsampling=off low_quality_1.jpg')

system('convert koga_original.jpg -define jpeg:extend=200kb -resize 1024 low_quality_2.jpg')
```

![Koga Original](koga_original.jpg){width='32%' fig-align='center'}
![Koga Signal version](koga_signal.jpeg){width='32%' fig-align='center'}
![Koga ImageMagick](koga_edited.jpg){width='32%' fig-align='center'}

![Koga Original](koga_original.jpg){width='99%' fig-align='center'}
![Koga Signal version](koga_signal.jpeg){width='99%' fig-align='center'}
![Koga ImageMagick](koga_edited.jpg){width='99%' fig-align='center'}



## Currently best version
```{r}
system('convert koga_original.jpg -quality 50 -resize 2048 low_quality_3.jpg')
```

